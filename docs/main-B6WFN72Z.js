import{$ as Pn,$a as Je,A as q,Aa as O,B as $,Ba as N,C as en,Ca as R,D as _,Da as Se,E as v,Ea as so,F as vt,Fa as ao,G as Zr,Ga as Dn,H as rt,Ha as yt,I as Nt,Ia as lo,J as An,Ja as sn,K as We,Ka as Qe,L as Xr,La as co,M as A,Ma as de,N as Rt,Na as zt,O as kn,Oa as oe,P as eo,Pa as ot,Q as Vt,Qa as bt,R as tn,Ra as Di,S as to,Sa as Ke,T as d,Ta as qt,U as C,Ua as Ve,V as no,Va as te,W as nn,Wa as uo,X as K,Xa as mo,Y as ge,Ya as po,Z as ee,Za as Fn,_ as ye,_a as X,a as Lr,aa as b,ab as On,b as Br,ba as io,bb as ho,c as Sn,ca as ro,cb as fo,d as En,da as rn,db as go,e as Ot,ea as f,eb as _o,f as jr,fa as on,fb as vo,g as Ur,ga as D,gb as yo,h as Ie,ha as oo,hb as st,i as zr,ia as a,ib as bo,j as qr,ja as s,jb as ne,k as Tn,ka as T,kb as _e,l as Wr,la as Ge,lb as wo,m as Gr,ma as He,mb as Co,n as Mn,na as j,nb as G,o as Hr,oa as g,ob as xo,p as $r,pa as h,q as Qr,qa as ki,qb as Nn,r as Kr,ra as Pi,s as Jr,sa as Lt,t as Yr,ta as Bt,u as In,ua as jt,v as B,va as $e,w as Re,wa as l,x as z,xa as y,y as fe,ya as V,z as xe,za as Ut}from"./chunk-SJ5WGOND.js";import"./chunk-65CJINC2.js";import{a as W,b as Z,c as Xt}from"./chunk-VOSPIT4N.js";var L=function(i){return i[i.State=0]="State",i[i.Transition=1]="Transition",i[i.Sequence=2]="Sequence",i[i.Group=3]="Group",i[i.Animate=4]="Animate",i[i.Keyframes=5]="Keyframes",i[i.Style=6]="Style",i[i.Trigger=7]="Trigger",i[i.Reference=8]="Reference",i[i.AnimateChild=9]="AnimateChild",i[i.AnimateRef=10]="AnimateRef",i[i.Query=11]="Query",i[i.Stagger=12]="Stagger",i}(L||{}),Le="*";function So(i,t=null){return{type:L.Sequence,steps:i,options:t}}function Fi(i){return{type:L.Style,styles:i,offset:null}}var at=class{_onDoneFns=[];_onStartFns=[];_onDestroyFns=[];_originalOnDoneFns=[];_originalOnStartFns=[];_started=!1;_destroyed=!1;_finished=!1;_position=0;parentPlayer=null;totalTime;constructor(t=0,e=0){this.totalTime=t+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(t){this._position=this.totalTime?t*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(t){let e=t=="start"?this._onStartFns:this._onDoneFns;e.forEach(n=>n()),e.length=0}},an=class{_onDoneFns=[];_onStartFns=[];_finished=!1;_started=!1;_destroyed=!1;_onDestroyFns=[];parentPlayer=null;totalTime=0;players;constructor(t){this.players=t;let e=0,n=0,r=0,o=this.players.length;o==0?queueMicrotask(()=>this._onFinish()):this.players.forEach(c=>{c.onDone(()=>{++e==o&&this._onFinish()}),c.onDestroy(()=>{++n==o&&this._onDestroy()}),c.onStart(()=>{++r==o&&this._onStart()})}),this.totalTime=this.players.reduce((c,u)=>Math.max(c,u.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){let e=t*this.totalTime;this.players.forEach(n=>{let r=n.totalTime?Math.min(1,e/n.totalTime):1;n.setPosition(r)})}getPosition(){let t=this.players.reduce((e,n)=>e===null||n.totalTime>e.totalTime?n:e,null);return t!=null?t.getPosition():0}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){let e=t=="start"?this._onStartFns:this._onDoneFns;e.forEach(n=>n()),e.length=0}},Rn="!";function Eo(i){return new B(3e3,!1)}function ra(){return new B(3100,!1)}function oa(){return new B(3101,!1)}function sa(i){return new B(3001,!1)}function aa(i){return new B(3003,!1)}function la(i){return new B(3004,!1)}function ca(i,t){return new B(3005,!1)}function da(){return new B(3006,!1)}function ua(){return new B(3007,!1)}function ma(i,t){return new B(3008,!1)}function pa(i){return new B(3002,!1)}function ha(i,t,e,n,r){return new B(3010,!1)}function fa(){return new B(3011,!1)}function ga(){return new B(3012,!1)}function _a(){return new B(3200,!1)}function va(){return new B(3202,!1)}function ya(){return new B(3013,!1)}function ba(i){return new B(3014,!1)}function wa(i){return new B(3015,!1)}function Ca(i){return new B(3016,!1)}function xa(i,t){return new B(3404,!1)}function Sa(i){return new B(3502,!1)}function Ea(i){return new B(3503,!1)}function Ta(){return new B(3300,!1)}function Ma(i){return new B(3504,!1)}function Ia(i){return new B(3301,!1)}function Aa(i,t){return new B(3302,!1)}function ka(i){return new B(3303,!1)}function Pa(i,t){return new B(3400,!1)}function Da(i){return new B(3401,!1)}function Fa(i){return new B(3402,!1)}function Oa(i,t){return new B(3505,!1)}function lt(i){switch(i.length){case 0:return new at;case 1:return i[0];default:return new an(i)}}function Bo(i,t,e=new Map,n=new Map){let r=[],o=[],c=-1,u=null;if(t.forEach(p=>{let m=p.get("offset"),w=m==c,x=w&&u||new Map;p.forEach((F,I)=>{let S=I,P=F;if(I!=="offset")switch(S=i.normalizePropertyName(S,r),P){case Rn:P=e.get(I);break;case Le:P=n.get(I);break;default:P=i.normalizeStyleValue(I,S,P,r);break}x.set(S,P)}),w||o.push(x),u=x,c=m}),r.length)throw Sa(r);return o}function tr(i,t,e,n){switch(t){case"start":i.onStart(()=>n(e&&Oi(e,"start",i)));break;case"done":i.onDone(()=>n(e&&Oi(e,"done",i)));break;case"destroy":i.onDestroy(()=>n(e&&Oi(e,"destroy",i)));break}}function Oi(i,t,e){let n=e.totalTime,r=!!e.disabled,o=nr(i.element,i.triggerName,i.fromState,i.toState,t||i.phaseName,n??i.totalTime,r),c=i._data;return c!=null&&(o._data=c),o}function nr(i,t,e,n,r="",o=0,c){return{element:i,triggerName:t,fromState:e,toState:n,phaseName:r,totalTime:o,disabled:!!c}}function we(i,t,e){let n=i.get(t);return n||i.set(t,n=e),n}function To(i){let t=i.indexOf(":"),e=i.substring(1,t),n=i.slice(t+1);return[e,n]}var Na=typeof document>"u"?null:document.documentElement;function ir(i){let t=i.parentNode||i.host||null;return t===Na?null:t}function Ra(i){return i.substring(1,6)=="ebkit"}var wt=null,Mo=!1;function Va(i){wt||(wt=La()||{},Mo=wt.style?"WebkitAppearance"in wt.style:!1);let t=!0;return wt.style&&!Ra(i)&&(t=i in wt.style,!t&&Mo&&(t="Webkit"+i.charAt(0).toUpperCase()+i.slice(1)in wt.style)),t}function La(){return typeof document<"u"?document.body:null}function jo(i,t){for(;t;){if(t===i)return!0;t=ir(t)}return!1}function Uo(i,t,e){if(e)return Array.from(i.querySelectorAll(t));let n=i.querySelector(t);return n?[n]:[]}var rr=(()=>{class i{validateStyleProperty(e){return Va(e)}containsElement(e,n){return jo(e,n)}getParentElement(e){return ir(e)}query(e,n,r){return Uo(e,n,r)}computeStyle(e,n,r){return r||""}animate(e,n,r,o,c,u=[],p){return new at(r,o)}static \u0275fac=function(n){return new(n||i)};static \u0275prov=z({token:i,factory:i.\u0275fac})}return i})(),St=class{static NOOP=new rr},Et=class{};var Ba=1e3,zo="{{",ja="}}",qo="ng-enter",ji="ng-leave",Vn="ng-trigger",zn=".ng-trigger",Io="ng-animating",Ui=".ng-animating";function Ye(i){if(typeof i=="number")return i;let t=i.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:zi(parseFloat(t[1]),t[2])}function zi(i,t){switch(t){case"s":return i*Ba;default:return i}}function qn(i,t,e){return i.hasOwnProperty("duration")?i:Ua(i,t,e)}function Ua(i,t,e){let n=/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i,r,o=0,c="";if(typeof i=="string"){let u=i.match(n);if(u===null)return t.push(Eo(i)),{duration:0,delay:0,easing:""};r=zi(parseFloat(u[1]),u[2]);let p=u[3];p!=null&&(o=zi(parseFloat(p),u[4]));let m=u[5];m&&(c=m)}else r=i;if(!e){let u=!1,p=t.length;r<0&&(t.push(ra()),u=!0),o<0&&(t.push(oa()),u=!0),u&&t.splice(p,0,Eo(i))}return{duration:r,delay:o,easing:c}}function za(i){return i.length?i[0]instanceof Map?i:i.map(t=>new Map(Object.entries(t))):[]}function Be(i,t,e){t.forEach((n,r)=>{let o=or(r);e&&!e.has(r)&&e.set(r,i.style[o]),i.style[o]=n})}function xt(i,t){t.forEach((e,n)=>{let r=or(n);i.style[r]=""})}function ln(i){return Array.isArray(i)?i.length==1?i[0]:So(i):i}function qa(i,t,e){let n=t.params||{},r=Wo(i);r.length&&r.forEach(o=>{n.hasOwnProperty(o)||e.push(sa(o))})}var qi=new RegExp(`${zo}\\s*(.+?)\\s*${ja}`,"g");function Wo(i){let t=[];if(typeof i=="string"){let e;for(;e=qi.exec(i);)t.push(e[1]);qi.lastIndex=0}return t}function dn(i,t,e){let n=`${i}`,r=n.replace(qi,(o,c)=>{let u=t[c];return u==null&&(e.push(aa(c)),u=""),u.toString()});return r==n?i:r}var Wa=/-+([a-z0-9])/g;function or(i){return i.replace(Wa,(...t)=>t[1].toUpperCase())}function Ga(i,t){return i===0||t===0}function Ha(i,t,e){if(e.size&&t.length){let n=t[0],r=[];if(e.forEach((o,c)=>{n.has(c)||r.push(c),n.set(c,o)}),r.length)for(let o=1;o<t.length;o++){let c=t[o];r.forEach(u=>c.set(u,sr(i,u)))}}return t}function be(i,t,e){switch(t.type){case L.Trigger:return i.visitTrigger(t,e);case L.State:return i.visitState(t,e);case L.Transition:return i.visitTransition(t,e);case L.Sequence:return i.visitSequence(t,e);case L.Group:return i.visitGroup(t,e);case L.Animate:return i.visitAnimate(t,e);case L.Keyframes:return i.visitKeyframes(t,e);case L.Style:return i.visitStyle(t,e);case L.Reference:return i.visitReference(t,e);case L.AnimateChild:return i.visitAnimateChild(t,e);case L.AnimateRef:return i.visitAnimateRef(t,e);case L.Query:return i.visitQuery(t,e);case L.Stagger:return i.visitStagger(t,e);default:throw la(t.type)}}function sr(i,t){return window.getComputedStyle(i)[t]}var $a=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]),Wn=class extends Et{normalizePropertyName(t,e){return or(t)}normalizeStyleValue(t,e,n,r){let o="",c=n.toString().trim();if($a.has(e)&&n!==0&&n!=="0")if(typeof n=="number")o="px";else{let u=n.match(/^[+-]?[\d\.]+([a-z]*)$/);u&&u[1].length==0&&r.push(ca(t,n))}return c+o}};var Gn="*";function Qa(i,t){let e=[];return typeof i=="string"?i.split(/\s*,\s*/).forEach(n=>Ka(n,e,t)):e.push(i),e}function Ka(i,t,e){if(i[0]==":"){let p=Ja(i,e);if(typeof p=="function"){t.push(p);return}i=p}let n=i.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(n==null||n.length<4)return e.push(wa(i)),t;let r=n[1],o=n[2],c=n[3];t.push(Ao(r,c));let u=r==Gn&&c==Gn;o[0]=="<"&&!u&&t.push(Ao(c,r))}function Ja(i,t){switch(i){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,n)=>parseFloat(n)>parseFloat(e);case":decrement":return(e,n)=>parseFloat(n)<parseFloat(e);default:return t.push(Ca(i)),"* => *"}}var Ln=new Set(["true","1"]),Bn=new Set(["false","0"]);function Ao(i,t){let e=Ln.has(i)||Bn.has(i),n=Ln.has(t)||Bn.has(t);return(r,o)=>{let c=i==Gn||i==r,u=t==Gn||t==o;return!c&&e&&typeof r=="boolean"&&(c=r?Ln.has(i):Bn.has(i)),!u&&n&&typeof o=="boolean"&&(u=o?Ln.has(t):Bn.has(t)),c&&u}}var Go=":self",Ya=new RegExp(`s*${Go}s*,?`,"g");function Ho(i,t,e,n){return new Wi(i).build(t,e,n)}var ko="",Wi=class{_driver;constructor(t){this._driver=t}build(t,e,n){let r=new Gi(e);return this._resetContextStyleTimingState(r),be(this,ln(t),r)}_resetContextStyleTimingState(t){t.currentQuerySelector=ko,t.collectedStyles=new Map,t.collectedStyles.set(ko,new Map),t.currentTime=0}visitTrigger(t,e){let n=e.queryCount=0,r=e.depCount=0,o=[],c=[];return t.name.charAt(0)=="@"&&e.errors.push(da()),t.definitions.forEach(u=>{if(this._resetContextStyleTimingState(e),u.type==L.State){let p=u,m=p.name;m.toString().split(/\s*,\s*/).forEach(w=>{p.name=w,o.push(this.visitState(p,e))}),p.name=m}else if(u.type==L.Transition){let p=this.visitTransition(u,e);n+=p.queryCount,r+=p.depCount,c.push(p)}else e.errors.push(ua())}),{type:L.Trigger,name:t.name,states:o,transitions:c,queryCount:n,depCount:r,options:null}}visitState(t,e){let n=this.visitStyle(t.styles,e),r=t.options&&t.options.params||null;if(n.containsDynamicStyles){let o=new Set,c=r||{};n.styles.forEach(u=>{u instanceof Map&&u.forEach(p=>{Wo(p).forEach(m=>{c.hasOwnProperty(m)||o.add(m)})})}),o.size&&e.errors.push(ma(t.name,[...o.values()]))}return{type:L.State,name:t.name,style:n,options:r?{params:r}:null}}visitTransition(t,e){e.queryCount=0,e.depCount=0;let n=be(this,ln(t.animation),e),r=Qa(t.expr,e.errors);return{type:L.Transition,matchers:r,animation:n,queryCount:e.queryCount,depCount:e.depCount,options:Ct(t.options)}}visitSequence(t,e){return{type:L.Sequence,steps:t.steps.map(n=>be(this,n,e)),options:Ct(t.options)}}visitGroup(t,e){let n=e.currentTime,r=0,o=t.steps.map(c=>{e.currentTime=n;let u=be(this,c,e);return r=Math.max(r,e.currentTime),u});return e.currentTime=r,{type:L.Group,steps:o,options:Ct(t.options)}}visitAnimate(t,e){let n=tl(t.timings,e.errors);e.currentAnimateTimings=n;let r,o=t.styles?t.styles:Fi({});if(o.type==L.Keyframes)r=this.visitKeyframes(o,e);else{let c=t.styles,u=!1;if(!c){u=!0;let m={};n.easing&&(m.easing=n.easing),c=Fi(m)}e.currentTime+=n.duration+n.delay;let p=this.visitStyle(c,e);p.isEmptyStep=u,r=p}return e.currentAnimateTimings=null,{type:L.Animate,timings:n,style:r,options:null}}visitStyle(t,e){let n=this._makeStyleAst(t,e);return this._validateStyleAst(n,e),n}_makeStyleAst(t,e){let n=[],r=Array.isArray(t.styles)?t.styles:[t.styles];for(let u of r)typeof u=="string"?u===Le?n.push(u):e.errors.push(pa(u)):n.push(new Map(Object.entries(u)));let o=!1,c=null;return n.forEach(u=>{if(u instanceof Map&&(u.has("easing")&&(c=u.get("easing"),u.delete("easing")),!o)){for(let p of u.values())if(p.toString().indexOf(zo)>=0){o=!0;break}}}),{type:L.Style,styles:n,easing:c,offset:t.offset,containsDynamicStyles:o,options:null}}_validateStyleAst(t,e){let n=e.currentAnimateTimings,r=e.currentTime,o=e.currentTime;n&&o>0&&(o-=n.duration+n.delay),t.styles.forEach(c=>{typeof c!="string"&&c.forEach((u,p)=>{let m=e.collectedStyles.get(e.currentQuerySelector),w=m.get(p),x=!0;w&&(o!=r&&o>=w.startTime&&r<=w.endTime&&(e.errors.push(ha(p,w.startTime,w.endTime,o,r)),x=!1),o=w.startTime),x&&m.set(p,{startTime:o,endTime:r}),e.options&&qa(u,e.options,e.errors)})})}visitKeyframes(t,e){let n={type:L.Keyframes,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(fa()),n;let r=1,o=0,c=[],u=!1,p=!1,m=0,w=t.steps.map(re=>{let se=this._makeStyleAst(re,e),me=se.offset!=null?se.offset:el(se.styles),ce=0;return me!=null&&(o++,ce=se.offset=me),p=p||ce<0||ce>1,u=u||ce<m,m=ce,c.push(ce),se});p&&e.errors.push(ga()),u&&e.errors.push(_a());let x=t.steps.length,F=0;o>0&&o<x?e.errors.push(va()):o==0&&(F=r/(x-1));let I=x-1,S=e.currentTime,P=e.currentAnimateTimings,J=P.duration;return w.forEach((re,se)=>{let me=F>0?se==I?1:F*se:c[se],ce=me*J;e.currentTime=S+P.delay+ce,P.duration=ce,this._validateStyleAst(re,e),re.offset=me,n.styles.push(re)}),n}visitReference(t,e){return{type:L.Reference,animation:be(this,ln(t.animation),e),options:Ct(t.options)}}visitAnimateChild(t,e){return e.depCount++,{type:L.AnimateChild,options:Ct(t.options)}}visitAnimateRef(t,e){return{type:L.AnimateRef,animation:this.visitReference(t.animation,e),options:Ct(t.options)}}visitQuery(t,e){let n=e.currentQuerySelector,r=t.options||{};e.queryCount++,e.currentQuery=t;let[o,c]=Za(t.selector);e.currentQuerySelector=n.length?n+" "+o:o,we(e.collectedStyles,e.currentQuerySelector,new Map);let u=be(this,ln(t.animation),e);return e.currentQuery=null,e.currentQuerySelector=n,{type:L.Query,selector:o,limit:r.limit||0,optional:!!r.optional,includeSelf:c,animation:u,originalSelector:t.selector,options:Ct(t.options)}}visitStagger(t,e){e.currentQuery||e.errors.push(ya());let n=t.timings==="full"?{duration:0,delay:0,easing:"full"}:qn(t.timings,e.errors,!0);return{type:L.Stagger,animation:be(this,ln(t.animation),e),timings:n,options:null}}};function Za(i){let t=!!i.split(/\s*,\s*/).find(e=>e==Go);return t&&(i=i.replace(Ya,"")),i=i.replace(/@\*/g,zn).replace(/@\w+/g,e=>zn+"-"+e.slice(1)).replace(/:animating/g,Ui),[i,t]}function Xa(i){return i?W({},i):null}var Gi=class{errors;queryCount=0;depCount=0;currentTransition=null;currentQuery=null;currentQuerySelector=null;currentAnimateTimings=null;currentTime=0;collectedStyles=new Map;options=null;unsupportedCSSPropertiesFound=new Set;constructor(t){this.errors=t}};function el(i){if(typeof i=="string")return null;let t=null;if(Array.isArray(i))i.forEach(e=>{if(e instanceof Map&&e.has("offset")){let n=e;t=parseFloat(n.get("offset")),n.delete("offset")}});else if(i instanceof Map&&i.has("offset")){let e=i;t=parseFloat(e.get("offset")),e.delete("offset")}return t}function tl(i,t){if(i.hasOwnProperty("duration"))return i;if(typeof i=="number"){let o=qn(i,t).duration;return Ni(o,0,"")}let e=i;if(e.split(/\s+/).some(o=>o.charAt(0)=="{"&&o.charAt(1)=="{")){let o=Ni(0,0,"");return o.dynamic=!0,o.strValue=e,o}let r=qn(e,t);return Ni(r.duration,r.delay,r.easing)}function Ct(i){return i?(i=W({},i),i.params&&(i.params=Xa(i.params))):i={},i}function Ni(i,t,e){return{duration:i,delay:t,easing:e}}function ar(i,t,e,n,r,o,c=null,u=!1){return{type:1,element:i,keyframes:t,preStyleProps:e,postStyleProps:n,duration:r,delay:o,totalTime:r+o,easing:c,subTimeline:u}}var un=class{_map=new Map;get(t){return this._map.get(t)||[]}append(t,e){let n=this._map.get(t);n||this._map.set(t,n=[]),n.push(...e)}has(t){return this._map.has(t)}clear(){this._map.clear()}},nl=1,il=":enter",rl=new RegExp(il,"g"),ol=":leave",sl=new RegExp(ol,"g");function $o(i,t,e,n,r,o=new Map,c=new Map,u,p,m=[]){return new Hi().buildKeyframes(i,t,e,n,r,o,c,u,p,m)}var Hi=class{buildKeyframes(t,e,n,r,o,c,u,p,m,w=[]){m=m||new un;let x=new $i(t,e,m,r,o,w,[]);x.options=p;let F=p.delay?Ye(p.delay):0;x.currentTimeline.delayNextStep(F),x.currentTimeline.setStyles([c],null,x.errors,p),be(this,n,x);let I=x.timelines.filter(S=>S.containsAnimation());if(I.length&&u.size){let S;for(let P=I.length-1;P>=0;P--){let J=I[P];if(J.element===e){S=J;break}}S&&!S.allowOnlyTimelineStyles()&&S.setStyles([u],null,x.errors,p)}return I.length?I.map(S=>S.buildKeyframes()):[ar(e,[],[],[],0,F,"",!1)]}visitTrigger(t,e){}visitState(t,e){}visitTransition(t,e){}visitAnimateChild(t,e){let n=e.subInstructions.get(e.element);if(n){let r=e.createSubContext(t.options),o=e.currentTimeline.currentTime,c=this._visitSubInstructions(n,r,r.options);o!=c&&e.transformIntoNewTimeline(c)}e.previousNode=t}visitAnimateRef(t,e){let n=e.createSubContext(t.options);n.transformIntoNewTimeline(),this._applyAnimationRefDelays([t.options,t.animation.options],e,n),this.visitReference(t.animation,n),e.transformIntoNewTimeline(n.currentTimeline.currentTime),e.previousNode=t}_applyAnimationRefDelays(t,e,n){for(let r of t){let o=r?.delay;if(o){let c=typeof o=="number"?o:Ye(dn(o,r?.params??{},e.errors));n.delayNextStep(c)}}}_visitSubInstructions(t,e,n){let o=e.currentTimeline.currentTime,c=n.duration!=null?Ye(n.duration):null,u=n.delay!=null?Ye(n.delay):null;return c!==0&&t.forEach(p=>{let m=e.appendInstructionToTimeline(p,c,u);o=Math.max(o,m.duration+m.delay)}),o}visitReference(t,e){e.updateOptions(t.options,!0),be(this,t.animation,e),e.previousNode=t}visitSequence(t,e){let n=e.subContextCount,r=e,o=t.options;if(o&&(o.params||o.delay)&&(r=e.createSubContext(o),r.transformIntoNewTimeline(),o.delay!=null)){r.previousNode.type==L.Style&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=Hn);let c=Ye(o.delay);r.delayNextStep(c)}t.steps.length&&(t.steps.forEach(c=>be(this,c,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>n&&r.transformIntoNewTimeline()),e.previousNode=t}visitGroup(t,e){let n=[],r=e.currentTimeline.currentTime,o=t.options&&t.options.delay?Ye(t.options.delay):0;t.steps.forEach(c=>{let u=e.createSubContext(t.options);o&&u.delayNextStep(o),be(this,c,u),r=Math.max(r,u.currentTimeline.currentTime),n.push(u.currentTimeline)}),n.forEach(c=>e.currentTimeline.mergeTimelineCollectedStyles(c)),e.transformIntoNewTimeline(r),e.previousNode=t}_visitTiming(t,e){if(t.dynamic){let n=t.strValue,r=e.params?dn(n,e.params,e.errors):n;return qn(r,e.errors)}else return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,e){let n=e.currentAnimateTimings=this._visitTiming(t.timings,e),r=e.currentTimeline;n.delay&&(e.incrementTime(n.delay),r.snapshotCurrentStyles());let o=t.style;o.type==L.Keyframes?this.visitKeyframes(o,e):(e.incrementTime(n.duration),this.visitStyle(o,e),r.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=t}visitStyle(t,e){let n=e.currentTimeline,r=e.currentAnimateTimings;!r&&n.hasCurrentStyleProperties()&&n.forwardFrame();let o=r&&r.easing||t.easing;t.isEmptyStep?n.applyEmptyStep(o):n.setStyles(t.styles,o,e.errors,e.options),e.previousNode=t}visitKeyframes(t,e){let n=e.currentAnimateTimings,r=e.currentTimeline.duration,o=n.duration,u=e.createSubContext().currentTimeline;u.easing=n.easing,t.styles.forEach(p=>{let m=p.offset||0;u.forwardTime(m*o),u.setStyles(p.styles,p.easing,e.errors,e.options),u.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(u),e.transformIntoNewTimeline(r+o),e.previousNode=t}visitQuery(t,e){let n=e.currentTimeline.currentTime,r=t.options||{},o=r.delay?Ye(r.delay):0;o&&(e.previousNode.type===L.Style||n==0&&e.currentTimeline.hasCurrentStyleProperties())&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=Hn);let c=n,u=e.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!r.optional,e.errors);e.currentQueryTotal=u.length;let p=null;u.forEach((m,w)=>{e.currentQueryIndex=w;let x=e.createSubContext(t.options,m);o&&x.delayNextStep(o),m===e.element&&(p=x.currentTimeline),be(this,t.animation,x),x.currentTimeline.applyStylesToKeyframe();let F=x.currentTimeline.currentTime;c=Math.max(c,F)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(c),p&&(e.currentTimeline.mergeTimelineCollectedStyles(p),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=t}visitStagger(t,e){let n=e.parentContext,r=e.currentTimeline,o=t.timings,c=Math.abs(o.duration),u=c*(e.currentQueryTotal-1),p=c*e.currentQueryIndex;switch(o.duration<0?"reverse":o.easing){case"reverse":p=u-p;break;case"full":p=n.currentStaggerTime;break}let w=e.currentTimeline;p&&w.delayNextStep(p);let x=w.currentTime;be(this,t.animation,e),e.previousNode=t,n.currentStaggerTime=r.currentTime-x+(r.startTime-n.currentTimeline.startTime)}},Hn={},$i=class i{_driver;element;subInstructions;_enterClassName;_leaveClassName;errors;timelines;parentContext=null;currentTimeline;currentAnimateTimings=null;previousNode=Hn;subContextCount=0;options={};currentQueryIndex=0;currentQueryTotal=0;currentStaggerTime=0;constructor(t,e,n,r,o,c,u,p){this._driver=t,this.element=e,this.subInstructions=n,this._enterClassName=r,this._leaveClassName=o,this.errors=c,this.timelines=u,this.currentTimeline=p||new $n(this._driver,e,0),u.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,e){if(!t)return;let n=t,r=this.options;n.duration!=null&&(r.duration=Ye(n.duration)),n.delay!=null&&(r.delay=Ye(n.delay));let o=n.params;if(o){let c=r.params;c||(c=this.options.params={}),Object.keys(o).forEach(u=>{(!e||!c.hasOwnProperty(u))&&(c[u]=dn(o[u],c,this.errors))})}}_copyOptions(){let t={};if(this.options){let e=this.options.params;if(e){let n=t.params={};Object.keys(e).forEach(r=>{n[r]=e[r]})}}return t}createSubContext(t=null,e,n){let r=e||this.element,o=new i(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,n||0));return o.previousNode=this.previousNode,o.currentAnimateTimings=this.currentAnimateTimings,o.options=this._copyOptions(),o.updateOptions(t),o.currentQueryIndex=this.currentQueryIndex,o.currentQueryTotal=this.currentQueryTotal,o.parentContext=this,this.subContextCount++,o}transformIntoNewTimeline(t){return this.previousNode=Hn,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,e,n){let r={duration:e??t.duration,delay:this.currentTimeline.currentTime+(n??0)+t.delay,easing:""},o=new Qi(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,r,t.stretchStartingKeyframe);return this.timelines.push(o),r}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,e,n,r,o,c){let u=[];if(r&&u.push(this.element),t.length>0){t=t.replace(rl,"."+this._enterClassName),t=t.replace(sl,"."+this._leaveClassName);let p=n!=1,m=this._driver.query(this.element,t,p);n!==0&&(m=n<0?m.slice(m.length+n,m.length):m.slice(0,n)),u.push(...m)}return!o&&u.length==0&&c.push(ba(e)),u}},$n=class i{_driver;element;startTime;_elementTimelineStylesLookup;duration=0;easing=null;_previousKeyframe=new Map;_currentKeyframe=new Map;_keyframes=new Map;_styleSummary=new Map;_localTimelineStyles=new Map;_globalTimelineStyles;_pendingStyles=new Map;_backFill=new Map;_currentEmptyStepKeyframe=null;constructor(t,e,n,r){this._driver=t,this.element=e,this.startTime=n,this._elementTimelineStylesLookup=r,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(t){let e=this._keyframes.size===1&&this._pendingStyles.size;this.duration||e?(this.forwardTime(this.currentTime+t),e&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,e){return this.applyStylesToKeyframe(),new i(this._driver,t,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=nl,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,e){this._localTimelineStyles.set(t,e),this._globalTimelineStyles.set(t,e),this._styleSummary.set(t,{time:this.currentTime,value:e})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&this._previousKeyframe.set("easing",t);for(let[e,n]of this._globalTimelineStyles)this._backFill.set(e,n||Le),this._currentKeyframe.set(e,Le);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,e,n,r){e&&this._previousKeyframe.set("easing",e);let o=r&&r.params||{},c=al(t,this._globalTimelineStyles);for(let[u,p]of c){let m=dn(p,o,n);this._pendingStyles.set(u,m),this._localTimelineStyles.has(u)||this._backFill.set(u,this._globalTimelineStyles.get(u)??Le),this._updateStyle(u,m)}}applyStylesToKeyframe(){this._pendingStyles.size!=0&&(this._pendingStyles.forEach((t,e)=>{this._currentKeyframe.set(e,t)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((t,e)=>{this._currentKeyframe.has(e)||this._currentKeyframe.set(e,t)}))}snapshotCurrentStyles(){for(let[t,e]of this._localTimelineStyles)this._pendingStyles.set(t,e),this._updateStyle(t,e)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){let t=[];for(let e in this._currentKeyframe)t.push(e);return t}mergeTimelineCollectedStyles(t){t._styleSummary.forEach((e,n)=>{let r=this._styleSummary.get(n);(!r||e.time>r.time)&&this._updateStyle(n,e.value)})}buildKeyframes(){this.applyStylesToKeyframe();let t=new Set,e=new Set,n=this._keyframes.size===1&&this.duration===0,r=[];this._keyframes.forEach((u,p)=>{let m=new Map([...this._backFill,...u]);m.forEach((w,x)=>{w===Rn?t.add(x):w===Le&&e.add(x)}),n||m.set("offset",p/this.duration),r.push(m)});let o=[...t.values()],c=[...e.values()];if(n){let u=r[0],p=new Map(u);u.set("offset",0),p.set("offset",1),r=[u,p]}return ar(this.element,r,o,c,this.duration,this.startTime,this.easing,!1)}},Qi=class extends $n{keyframes;preStyleProps;postStyleProps;_stretchStartingKeyframe;timings;constructor(t,e,n,r,o,c,u=!1){super(t,e,c.delay),this.keyframes=n,this.preStyleProps=r,this.postStyleProps=o,this._stretchStartingKeyframe=u,this.timings={duration:c.duration,delay:c.delay,easing:c.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:e,duration:n,easing:r}=this.timings;if(this._stretchStartingKeyframe&&e){let o=[],c=n+e,u=e/c,p=new Map(t[0]);p.set("offset",0),o.push(p);let m=new Map(t[0]);m.set("offset",Po(u)),o.push(m);let w=t.length-1;for(let x=1;x<=w;x++){let F=new Map(t[x]),I=F.get("offset"),S=e+I*n;F.set("offset",Po(S/c)),o.push(F)}n=c,e=0,r="",t=o}return ar(this.element,t,this.preStyleProps,this.postStyleProps,n,e,r,!0)}};function Po(i,t=3){let e=Math.pow(10,t-1);return Math.round(i*e)/e}function al(i,t){let e=new Map,n;return i.forEach(r=>{if(r==="*"){n??=t.keys();for(let o of n)e.set(o,Le)}else for(let[o,c]of r)e.set(o,c)}),e}function Do(i,t,e,n,r,o,c,u,p,m,w,x,F){return{type:0,element:i,triggerName:t,isRemovalTransition:r,fromState:e,fromStyles:o,toState:n,toStyles:c,timelines:u,queriedElements:p,preStyleProps:m,postStyleProps:w,totalTime:x,errors:F}}var Ri={},Qn=class{_triggerName;ast;_stateStyles;constructor(t,e,n){this._triggerName=t,this.ast=e,this._stateStyles=n}match(t,e,n,r){return ll(this.ast.matchers,t,e,n,r)}buildStyles(t,e,n){let r=this._stateStyles.get("*");return t!==void 0&&(r=this._stateStyles.get(t?.toString())||r),r?r.buildStyles(e,n):new Map}build(t,e,n,r,o,c,u,p,m,w){let x=[],F=this.ast.options&&this.ast.options.params||Ri,I=u&&u.params||Ri,S=this.buildStyles(n,I,x),P=p&&p.params||Ri,J=this.buildStyles(r,P,x),re=new Set,se=new Map,me=new Map,ce=r==="void",Dt={params:Qo(P,F),delay:this.ast.options?.delay},Oe=w?[]:$o(t,e,this.ast.animation,o,c,S,J,Dt,m,x),pe=0;return Oe.forEach(he=>{pe=Math.max(he.duration+he.delay,pe)}),x.length?Do(e,this._triggerName,n,r,ce,S,J,[],[],se,me,pe,x):(Oe.forEach(he=>{let ft=he.element,Ft=we(se,ft,new Set);he.preStyleProps.forEach(gt=>Ft.add(gt));let Or=we(me,ft,new Set);he.postStyleProps.forEach(gt=>Or.add(gt)),ft!==e&&re.add(ft)}),Do(e,this._triggerName,n,r,ce,S,J,Oe,[...re.values()],se,me,pe))}};function ll(i,t,e,n,r){return i.some(o=>o(t,e,n,r))}function Qo(i,t){let e=W({},t);return Object.entries(i).forEach(([n,r])=>{r!=null&&(e[n]=r)}),e}var Ki=class{styles;defaultParams;normalizer;constructor(t,e,n){this.styles=t,this.defaultParams=e,this.normalizer=n}buildStyles(t,e){let n=new Map,r=Qo(t,this.defaultParams);return this.styles.styles.forEach(o=>{typeof o!="string"&&o.forEach((c,u)=>{c&&(c=dn(c,r,e));let p=this.normalizer.normalizePropertyName(u,e);c=this.normalizer.normalizeStyleValue(u,p,c,e),n.set(u,c)})}),n}};function cl(i,t,e){return new Ji(i,t,e)}var Ji=class{name;ast;_normalizer;transitionFactories=[];fallbackTransition;states=new Map;constructor(t,e,n){this.name=t,this.ast=e,this._normalizer=n,e.states.forEach(r=>{let o=r.options&&r.options.params||{};this.states.set(r.name,new Ki(r.style,o,n))}),Fo(this.states,"true","1"),Fo(this.states,"false","0"),e.transitions.forEach(r=>{this.transitionFactories.push(new Qn(t,r,this.states))}),this.fallbackTransition=dl(t,this.states,this._normalizer)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,e,n,r){return this.transitionFactories.find(c=>c.match(t,e,n,r))||null}matchStyles(t,e,n){return this.fallbackTransition.buildStyles(t,e,n)}};function dl(i,t,e){let n=[(c,u)=>!0],r={type:L.Sequence,steps:[],options:null},o={type:L.Transition,animation:r,matchers:n,options:null,queryCount:0,depCount:0};return new Qn(i,o,t)}function Fo(i,t,e){i.has(t)?i.has(e)||i.set(e,i.get(t)):i.has(e)&&i.set(t,i.get(e))}var ul=new un,Yi=class{bodyNode;_driver;_normalizer;_animations=new Map;_playersById=new Map;players=[];constructor(t,e,n){this.bodyNode=t,this._driver=e,this._normalizer=n}register(t,e){let n=[],r=[],o=Ho(this._driver,e,n,r);if(n.length)throw Ea(n);this._animations.set(t,o)}_buildPlayer(t,e,n){let r=t.element,o=Bo(this._normalizer,t.keyframes,e,n);return this._driver.animate(r,o,t.duration,t.delay,t.easing,[],!0)}create(t,e,n={}){let r=[],o=this._animations.get(t),c,u=new Map;if(o?(c=$o(this._driver,e,o,qo,ji,new Map,new Map,n,ul,r),c.forEach(w=>{let x=we(u,w.element,new Map);w.postStyleProps.forEach(F=>x.set(F,null))})):(r.push(Ta()),c=[]),r.length)throw Ma(r);u.forEach((w,x)=>{w.forEach((F,I)=>{w.set(I,this._driver.computeStyle(x,I,Le))})});let p=c.map(w=>{let x=u.get(w.element);return this._buildPlayer(w,new Map,x)}),m=lt(p);return this._playersById.set(t,m),m.onDestroy(()=>this.destroy(t)),this.players.push(m),m}destroy(t){let e=this._getPlayer(t);e.destroy(),this._playersById.delete(t);let n=this.players.indexOf(e);n>=0&&this.players.splice(n,1)}_getPlayer(t){let e=this._playersById.get(t);if(!e)throw Ia(t);return e}listen(t,e,n,r){let o=nr(e,"","","");return tr(this._getPlayer(t),n,o,r),()=>{}}command(t,e,n,r){if(n=="register"){this.register(t,r[0]);return}if(n=="create"){let c=r[0]||{};this.create(t,e,c);return}let o=this._getPlayer(t);switch(n){case"play":o.play();break;case"pause":o.pause();break;case"reset":o.reset();break;case"restart":o.restart();break;case"finish":o.finish();break;case"init":o.init();break;case"setPosition":o.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(t);break}}},Oo="ng-animate-queued",ml=".ng-animate-queued",Vi="ng-animate-disabled",pl=".ng-animate-disabled",hl="ng-star-inserted",fl=".ng-star-inserted",gl=[],Ko={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},_l={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Ae="__ng_removed",mn=class{namespaceId;value;options;get params(){return this.options.params}constructor(t,e=""){this.namespaceId=e;let n=t&&t.hasOwnProperty("value"),r=n?t.value:t;if(this.value=yl(r),n){let o=t,{value:c}=o,u=Xt(o,["value"]);this.options=u}else this.options={};this.options.params||(this.options.params={})}absorbOptions(t){let e=t.params;if(e){let n=this.options.params;Object.keys(e).forEach(r=>{n[r]==null&&(n[r]=e[r])})}}},cn="void",Li=new mn(cn),Zi=class{id;hostElement;_engine;players=[];_triggers=new Map;_queue=[];_elementListeners=new Map;_hostClassName;constructor(t,e,n){this.id=t,this.hostElement=e,this._engine=n,this._hostClassName="ng-tns-"+t,Ee(e,this._hostClassName)}listen(t,e,n,r){if(!this._triggers.has(e))throw Aa(n,e);if(n==null||n.length==0)throw ka(e);if(!bl(n))throw Pa(n,e);let o=we(this._elementListeners,t,[]),c={name:e,phase:n,callback:r};o.push(c);let u=we(this._engine.statesByElement,t,new Map);return u.has(e)||(Ee(t,Vn),Ee(t,Vn+"-"+e),u.set(e,Li)),()=>{this._engine.afterFlush(()=>{let p=o.indexOf(c);p>=0&&o.splice(p,1),this._triggers.has(e)||u.delete(e)})}}register(t,e){return this._triggers.has(t)?!1:(this._triggers.set(t,e),!0)}_getTrigger(t){let e=this._triggers.get(t);if(!e)throw Da(t);return e}trigger(t,e,n,r=!0){let o=this._getTrigger(e),c=new pn(this.id,e,t),u=this._engine.statesByElement.get(t);u||(Ee(t,Vn),Ee(t,Vn+"-"+e),this._engine.statesByElement.set(t,u=new Map));let p=u.get(e),m=new mn(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&p&&m.absorbOptions(p.options),u.set(e,m),p||(p=Li),!(m.value===cn)&&p.value===m.value){if(!xl(p.params,m.params)){let P=[],J=o.matchStyles(p.value,p.params,P),re=o.matchStyles(m.value,m.params,P);P.length?this._engine.reportError(P):this._engine.afterFlush(()=>{xt(t,J),Be(t,re)})}return}let F=we(this._engine.playersByElement,t,[]);F.forEach(P=>{P.namespaceId==this.id&&P.triggerName==e&&P.queued&&P.destroy()});let I=o.matchTransition(p.value,m.value,t,m.params),S=!1;if(!I){if(!r)return;I=o.fallbackTransition,S=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:e,transition:I,fromState:p,toState:m,player:c,isFallbackTransition:S}),S||(Ee(t,Oo),c.onStart(()=>{Wt(t,Oo)})),c.onDone(()=>{let P=this.players.indexOf(c);P>=0&&this.players.splice(P,1);let J=this._engine.playersByElement.get(t);if(J){let re=J.indexOf(c);re>=0&&J.splice(re,1)}}),this.players.push(c),F.push(c),c}deregister(t){this._triggers.delete(t),this._engine.statesByElement.forEach(e=>e.delete(t)),this._elementListeners.forEach((e,n)=>{this._elementListeners.set(n,e.filter(r=>r.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);let e=this._engine.playersByElement.get(t);e&&(e.forEach(n=>n.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,e){let n=this._engine.driver.query(t,zn,!0);n.forEach(r=>{if(r[Ae])return;let o=this._engine.fetchNamespacesByElement(r);o.size?o.forEach(c=>c.triggerLeaveAnimation(r,e,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(t,e,n,r){let o=this._engine.statesByElement.get(t),c=new Map;if(o){let u=[];if(o.forEach((p,m)=>{if(c.set(m,p.value),this._triggers.has(m)){let w=this.trigger(t,m,cn,r);w&&u.push(w)}}),u.length)return this._engine.markElementAsRemoved(this.id,t,!0,e,c),n&&lt(u).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){let e=this._elementListeners.get(t),n=this._engine.statesByElement.get(t);if(e&&n){let r=new Set;e.forEach(o=>{let c=o.name;if(r.has(c))return;r.add(c);let p=this._triggers.get(c).fallbackTransition,m=n.get(c)||Li,w=new mn(cn),x=new pn(this.id,c,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:c,transition:p,fromState:m,toState:w,player:x,isFallbackTransition:!0})})}}removeNode(t,e){let n=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,e),this.triggerLeaveAnimation(t,e,!0))return;let r=!1;if(n.totalAnimations){let o=n.players.length?n.playersByQueriedElement.get(t):[];if(o&&o.length)r=!0;else{let c=t;for(;c=c.parentNode;)if(n.statesByElement.get(c)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(t),r)n.markElementAsRemoved(this.id,t,!1,e);else{let o=t[Ae];(!o||o===Ko)&&(n.afterFlush(()=>this.clearElementCache(t)),n.destroyInnerAnimations(t),n._onRemovalComplete(t,e))}}insertNode(t,e){Ee(t,this._hostClassName)}drainQueuedTransitions(t){let e=[];return this._queue.forEach(n=>{let r=n.player;if(r.destroyed)return;let o=n.element,c=this._elementListeners.get(o);c&&c.forEach(u=>{if(u.name==n.triggerName){let p=nr(o,n.triggerName,n.fromState.value,n.toState.value);p._data=t,tr(n.player,u.phase,p,u.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):e.push(n)}),this._queue=[],e.sort((n,r)=>{let o=n.transition.ast.depCount,c=r.transition.ast.depCount;return o==0||c==0?o-c:this._engine.driver.containsElement(n.element,r.element)?1:-1})}destroy(t){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}},Xi=class{bodyNode;driver;_normalizer;players=[];newHostElements=new Map;playersByElement=new Map;playersByQueriedElement=new Map;statesByElement=new Map;disabledNodes=new Set;totalAnimations=0;totalQueuedPlayers=0;_namespaceLookup={};_namespaceList=[];_flushFns=[];_whenQuietFns=[];namespacesByHostElement=new Map;collectedEnterElements=[];collectedLeaveElements=[];onRemovalComplete=(t,e)=>{};_onRemovalComplete(t,e){this.onRemovalComplete(t,e)}constructor(t,e,n){this.bodyNode=t,this.driver=e,this._normalizer=n}get queuedPlayers(){let t=[];return this._namespaceList.forEach(e=>{e.players.forEach(n=>{n.queued&&t.push(n)})}),t}createNamespace(t,e){let n=new Zi(t,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(n,e):(this.newHostElements.set(e,n),this.collectEnterElement(e)),this._namespaceLookup[t]=n}_balanceNamespaceList(t,e){let n=this._namespaceList,r=this.namespacesByHostElement;if(n.length-1>=0){let c=!1,u=this.driver.getParentElement(e);for(;u;){let p=r.get(u);if(p){let m=n.indexOf(p);n.splice(m+1,0,t),c=!0;break}u=this.driver.getParentElement(u)}c||n.unshift(t)}else n.push(t);return r.set(e,t),t}register(t,e){let n=this._namespaceLookup[t];return n||(n=this.createNamespace(t,e)),n}registerTrigger(t,e,n){let r=this._namespaceLookup[t];r&&r.register(e,n)&&this.totalAnimations++}destroy(t,e){t&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{let n=this._fetchNamespace(t);this.namespacesByHostElement.delete(n.hostElement);let r=this._namespaceList.indexOf(n);r>=0&&this._namespaceList.splice(r,1),n.destroy(e),delete this._namespaceLookup[t]}))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){let e=new Set,n=this.statesByElement.get(t);if(n){for(let r of n.values())if(r.namespaceId){let o=this._fetchNamespace(r.namespaceId);o&&e.add(o)}}return e}trigger(t,e,n,r){if(jn(e)){let o=this._fetchNamespace(t);if(o)return o.trigger(e,n,r),!0}return!1}insertNode(t,e,n,r){if(!jn(e))return;let o=e[Ae];if(o&&o.setForRemoval){o.setForRemoval=!1,o.setForMove=!0;let c=this.collectedLeaveElements.indexOf(e);c>=0&&this.collectedLeaveElements.splice(c,1)}if(t){let c=this._fetchNamespace(t);c&&c.insertNode(e,n)}r&&this.collectEnterElement(e)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,e){e?this.disabledNodes.has(t)||(this.disabledNodes.add(t),Ee(t,Vi)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),Wt(t,Vi))}removeNode(t,e,n){if(jn(e)){let r=t?this._fetchNamespace(t):null;r?r.removeNode(e,n):this.markElementAsRemoved(t,e,!1,n);let o=this.namespacesByHostElement.get(e);o&&o.id!==t&&o.removeNode(e,n)}else this._onRemovalComplete(e,n)}markElementAsRemoved(t,e,n,r,o){this.collectedLeaveElements.push(e),e[Ae]={namespaceId:t,setForRemoval:r,hasAnimation:n,removedBeforeQueried:!1,previousTriggersValues:o}}listen(t,e,n,r,o){return jn(e)?this._fetchNamespace(t).listen(e,n,r,o):()=>{}}_buildInstruction(t,e,n,r,o){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,n,r,t.fromState.options,t.toState.options,e,o)}destroyInnerAnimations(t){let e=this.driver.query(t,zn,!0);e.forEach(n=>this.destroyActiveAnimationsForElement(n)),this.playersByQueriedElement.size!=0&&(e=this.driver.query(t,Ui,!0),e.forEach(n=>this.finishActiveQueriedAnimationOnElement(n)))}destroyActiveAnimationsForElement(t){let e=this.playersByElement.get(t);e&&e.forEach(n=>{n.queued?n.markedForDestroy=!0:n.destroy()})}finishActiveQueriedAnimationOnElement(t){let e=this.playersByQueriedElement.get(t);e&&e.forEach(n=>n.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return lt(this.players).onDone(()=>t());t()})}processLeaveNode(t){let e=t[Ae];if(e&&e.setForRemoval){if(t[Ae]=Ko,e.namespaceId){this.destroyInnerAnimations(t);let n=this._fetchNamespace(e.namespaceId);n&&n.clearElementCache(t)}this._onRemovalComplete(t,e.setForRemoval)}t.classList?.contains(Vi)&&this.markElementAsDisabled(t,!1),this.driver.query(t,pl,!0).forEach(n=>{this.markElementAsDisabled(n,!1)})}flush(t=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((n,r)=>this._balanceNamespaceList(n,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++){let r=this.collectedEnterElements[n];Ee(r,hl)}if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){let n=[];try{e=this._flushAnimations(n,t)}finally{for(let r=0;r<n.length;r++)n[r]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++){let r=this.collectedLeaveElements[n];this.processLeaveNode(r)}if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(n=>n()),this._flushFns=[],this._whenQuietFns.length){let n=this._whenQuietFns;this._whenQuietFns=[],e.length?lt(e).onDone(()=>{n.forEach(r=>r())}):n.forEach(r=>r())}}reportError(t){throw Fa(t)}_flushAnimations(t,e){let n=new un,r=[],o=new Map,c=[],u=new Map,p=new Map,m=new Map,w=new Set;this.disabledNodes.forEach(E=>{w.add(E);let M=this.driver.query(E,ml,!0);for(let k=0;k<M.length;k++)w.add(M[k])});let x=this.bodyNode,F=Array.from(this.statesByElement.keys()),I=Vo(F,this.collectedEnterElements),S=new Map,P=0;I.forEach((E,M)=>{let k=qo+P++;S.set(M,k),E.forEach(U=>Ee(U,k))});let J=[],re=new Set,se=new Set;for(let E=0;E<this.collectedLeaveElements.length;E++){let M=this.collectedLeaveElements[E],k=M[Ae];k&&k.setForRemoval&&(J.push(M),re.add(M),k.hasAnimation?this.driver.query(M,fl,!0).forEach(U=>re.add(U)):se.add(M))}let me=new Map,ce=Vo(F,Array.from(re));ce.forEach((E,M)=>{let k=ji+P++;me.set(M,k),E.forEach(U=>Ee(U,k))}),t.push(()=>{I.forEach((E,M)=>{let k=S.get(M);E.forEach(U=>Wt(U,k))}),ce.forEach((E,M)=>{let k=me.get(M);E.forEach(U=>Wt(U,k))}),J.forEach(E=>{this.processLeaveNode(E)})});let Dt=[],Oe=[];for(let E=this._namespaceList.length-1;E>=0;E--)this._namespaceList[E].drainQueuedTransitions(e).forEach(k=>{let U=k.player,ae=k.element;if(Dt.push(U),this.collectedEnterElements.length){let ue=ae[Ae];if(ue&&ue.setForMove){if(ue.previousTriggersValues&&ue.previousTriggersValues.has(k.triggerName)){let _t=ue.previousTriggersValues.get(k.triggerName),Ce=this.statesByElement.get(k.element);if(Ce&&Ce.has(k.triggerName)){let xn=Ce.get(k.triggerName);xn.value=_t,Ce.set(k.triggerName,xn)}}U.destroy();return}}let Ne=!x||!this.driver.containsElement(x,ae),ve=me.get(ae),it=S.get(ae),Y=this._buildInstruction(k,n,it,ve,Ne);if(Y.errors&&Y.errors.length){Oe.push(Y);return}if(Ne){U.onStart(()=>xt(ae,Y.fromStyles)),U.onDestroy(()=>Be(ae,Y.toStyles)),r.push(U);return}if(k.isFallbackTransition){U.onStart(()=>xt(ae,Y.fromStyles)),U.onDestroy(()=>Be(ae,Y.toStyles)),r.push(U);return}let Vr=[];Y.timelines.forEach(ue=>{ue.stretchStartingKeyframe=!0,this.disabledNodes.has(ue.element)||Vr.push(ue)}),Y.timelines=Vr,n.append(ae,Y.timelines);let ia={instruction:Y,player:U,element:ae};c.push(ia),Y.queriedElements.forEach(ue=>we(u,ue,[]).push(U)),Y.preStyleProps.forEach((ue,_t)=>{if(ue.size){let Ce=p.get(_t);Ce||p.set(_t,Ce=new Set),ue.forEach((xn,Ai)=>Ce.add(Ai))}}),Y.postStyleProps.forEach((ue,_t)=>{let Ce=m.get(_t);Ce||m.set(_t,Ce=new Set),ue.forEach((xn,Ai)=>Ce.add(Ai))})});if(Oe.length){let E=[];Oe.forEach(M=>{E.push(Oa(M.triggerName,M.errors))}),Dt.forEach(M=>M.destroy()),this.reportError(E)}let pe=new Map,he=new Map;c.forEach(E=>{let M=E.element;n.has(M)&&(he.set(M,M),this._beforeAnimationBuild(E.player.namespaceId,E.instruction,pe))}),r.forEach(E=>{let M=E.element;this._getPreviousPlayers(M,!1,E.namespaceId,E.triggerName,null).forEach(U=>{we(pe,M,[]).push(U),U.destroy()})});let ft=J.filter(E=>Lo(E,p,m)),Ft=new Map;Ro(Ft,this.driver,se,m,Le).forEach(E=>{Lo(E,p,m)&&ft.push(E)});let gt=new Map;I.forEach((E,M)=>{Ro(gt,this.driver,new Set(E),p,Rn)}),ft.forEach(E=>{let M=Ft.get(E),k=gt.get(E);Ft.set(E,new Map([...M?.entries()??[],...k?.entries()??[]]))});let Ii=[],Nr=[],Rr={};c.forEach(E=>{let{element:M,player:k,instruction:U}=E;if(n.has(M)){if(w.has(M)){k.onDestroy(()=>Be(M,U.toStyles)),k.disabled=!0,k.overrideTotalTime(U.totalTime),r.push(k);return}let ae=Rr;if(he.size>1){let ve=M,it=[];for(;ve=ve.parentNode;){let Y=he.get(ve);if(Y){ae=Y;break}it.push(ve)}it.forEach(Y=>he.set(Y,ae))}let Ne=this._buildAnimation(k.namespaceId,U,pe,o,gt,Ft);if(k.setRealPlayer(Ne),ae===Rr)Ii.push(k);else{let ve=this.playersByElement.get(ae);ve&&ve.length&&(k.parentPlayer=lt(ve)),r.push(k)}}else xt(M,U.fromStyles),k.onDestroy(()=>Be(M,U.toStyles)),Nr.push(k),w.has(M)&&r.push(k)}),Nr.forEach(E=>{let M=o.get(E.element);if(M&&M.length){let k=lt(M);E.setRealPlayer(k)}}),r.forEach(E=>{E.parentPlayer?E.syncPlayerEvents(E.parentPlayer):E.destroy()});for(let E=0;E<J.length;E++){let M=J[E],k=M[Ae];if(Wt(M,ji),k&&k.hasAnimation)continue;let U=[];if(u.size){let Ne=u.get(M);Ne&&Ne.length&&U.push(...Ne);let ve=this.driver.query(M,Ui,!0);for(let it=0;it<ve.length;it++){let Y=u.get(ve[it]);Y&&Y.length&&U.push(...Y)}}let ae=U.filter(Ne=>!Ne.destroyed);ae.length?wl(this,M,ae):this.processLeaveNode(M)}return J.length=0,Ii.forEach(E=>{this.players.push(E),E.onDone(()=>{E.destroy();let M=this.players.indexOf(E);this.players.splice(M,1)}),E.play()}),Ii}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,e,n,r,o){let c=[];if(e){let u=this.playersByQueriedElement.get(t);u&&(c=u)}else{let u=this.playersByElement.get(t);if(u){let p=!o||o==cn;u.forEach(m=>{m.queued||!p&&m.triggerName!=r||c.push(m)})}}return(n||r)&&(c=c.filter(u=>!(n&&n!=u.namespaceId||r&&r!=u.triggerName))),c}_beforeAnimationBuild(t,e,n){let r=e.triggerName,o=e.element,c=e.isRemovalTransition?void 0:t,u=e.isRemovalTransition?void 0:r;for(let p of e.timelines){let m=p.element,w=m!==o,x=we(n,m,[]);this._getPreviousPlayers(m,w,c,u,e.toState).forEach(I=>{let S=I.getRealPlayer();S.beforeDestroy&&S.beforeDestroy(),I.destroy(),x.push(I)})}xt(o,e.fromStyles)}_buildAnimation(t,e,n,r,o,c){let u=e.triggerName,p=e.element,m=[],w=new Set,x=new Set,F=e.timelines.map(S=>{let P=S.element;w.add(P);let J=P[Ae];if(J&&J.removedBeforeQueried)return new at(S.duration,S.delay);let re=P!==p,se=Cl((n.get(P)||gl).map(pe=>pe.getRealPlayer())).filter(pe=>{let he=pe;return he.element?he.element===P:!1}),me=o.get(P),ce=c.get(P),Dt=Bo(this._normalizer,S.keyframes,me,ce),Oe=this._buildPlayer(S,Dt,se);if(S.subTimeline&&r&&x.add(P),re){let pe=new pn(t,u,P);pe.setRealPlayer(Oe),m.push(pe)}return Oe});m.forEach(S=>{we(this.playersByQueriedElement,S.element,[]).push(S),S.onDone(()=>vl(this.playersByQueriedElement,S.element,S))}),w.forEach(S=>Ee(S,Io));let I=lt(F);return I.onDestroy(()=>{w.forEach(S=>Wt(S,Io)),Be(p,e.toStyles)}),x.forEach(S=>{we(r,S,[]).push(I)}),I}_buildPlayer(t,e,n){return e.length>0?this.driver.animate(t.element,e,t.duration,t.delay,t.easing,n):new at(t.duration,t.delay)}},pn=class{namespaceId;triggerName;element;_player=new at;_containsRealPlayer=!1;_queuedCallbacks=new Map;destroyed=!1;parentPlayer=null;markedForDestroy=!1;disabled=!1;queued=!0;totalTime=0;constructor(t,e,n){this.namespaceId=t,this.triggerName=e,this.element=n}setRealPlayer(t){this._containsRealPlayer||(this._player=t,this._queuedCallbacks.forEach((e,n)=>{e.forEach(r=>tr(t,n,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){let e=this._player;e.triggerCallback&&t.onStart(()=>e.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,e){we(this._queuedCallbacks,t,[]).push(e)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return this.queued?!1:this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){let e=this._player;e.triggerCallback&&e.triggerCallback(t)}};function vl(i,t,e){let n=i.get(t);if(n){if(n.length){let r=n.indexOf(e);n.splice(r,1)}n.length==0&&i.delete(t)}return n}function yl(i){return i??null}function jn(i){return i&&i.nodeType===1}function bl(i){return i=="start"||i=="done"}function No(i,t){let e=i.style.display;return i.style.display=t??"none",e}function Ro(i,t,e,n,r){let o=[];e.forEach(p=>o.push(No(p)));let c=[];n.forEach((p,m)=>{let w=new Map;p.forEach(x=>{let F=t.computeStyle(m,x,r);w.set(x,F),(!F||F.length==0)&&(m[Ae]=_l,c.push(m))}),i.set(m,w)});let u=0;return e.forEach(p=>No(p,o[u++])),c}function Vo(i,t){let e=new Map;if(i.forEach(u=>e.set(u,[])),t.length==0)return e;let n=1,r=new Set(t),o=new Map;function c(u){if(!u)return n;let p=o.get(u);if(p)return p;let m=u.parentNode;return e.has(m)?p=m:r.has(m)?p=n:p=c(m),o.set(u,p),p}return t.forEach(u=>{let p=c(u);p!==n&&e.get(p).push(u)}),e}function Ee(i,t){i.classList?.add(t)}function Wt(i,t){i.classList?.remove(t)}function wl(i,t,e){lt(e).onDone(()=>i.processLeaveNode(t))}function Cl(i){let t=[];return Jo(i,t),t}function Jo(i,t){for(let e=0;e<i.length;e++){let n=i[e];n instanceof an?Jo(n.players,t):t.push(n)}}function xl(i,t){let e=Object.keys(i),n=Object.keys(t);if(e.length!=n.length)return!1;for(let r=0;r<e.length;r++){let o=e[r];if(!t.hasOwnProperty(o)||i[o]!==t[o])return!1}return!0}function Lo(i,t,e){let n=e.get(i);if(!n)return!1;let r=t.get(i);return r?n.forEach(o=>r.add(o)):t.set(i,n),e.delete(i),!0}var Gt=class{_driver;_normalizer;_transitionEngine;_timelineEngine;_triggerCache={};onRemovalComplete=(t,e)=>{};constructor(t,e,n){this._driver=e,this._normalizer=n,this._transitionEngine=new Xi(t.body,e,n),this._timelineEngine=new Yi(t.body,e,n),this._transitionEngine.onRemovalComplete=(r,o)=>this.onRemovalComplete(r,o)}registerTrigger(t,e,n,r,o){let c=t+"-"+r,u=this._triggerCache[c];if(!u){let p=[],m=[],w=Ho(this._driver,o,p,m);if(p.length)throw xa(r,p);u=cl(r,w,this._normalizer),this._triggerCache[c]=u}this._transitionEngine.registerTrigger(e,r,u)}register(t,e){this._transitionEngine.register(t,e)}destroy(t,e){this._transitionEngine.destroy(t,e)}onInsert(t,e,n,r){this._transitionEngine.insertNode(t,e,n,r)}onRemove(t,e,n){this._transitionEngine.removeNode(t,e,n)}disableAnimations(t,e){this._transitionEngine.markElementAsDisabled(t,e)}process(t,e,n,r){if(n.charAt(0)=="@"){let[o,c]=To(n),u=r;this._timelineEngine.command(o,e,c,u)}else this._transitionEngine.trigger(t,e,n,r)}listen(t,e,n,r,o){if(n.charAt(0)=="@"){let[c,u]=To(n);return this._timelineEngine.listen(c,e,u,o)}return this._transitionEngine.listen(t,e,n,r,o)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(t){this._transitionEngine.afterFlushAnimationsDone(t)}};function Sl(i,t){let e=null,n=null;return Array.isArray(t)&&t.length?(e=Bi(t[0]),t.length>1&&(n=Bi(t[t.length-1]))):t instanceof Map&&(e=Bi(t)),e||n?new El(i,e,n):null}var El=(()=>{class i{_element;_startStyles;_endStyles;static initialStylesByElement=new WeakMap;_state=0;_initialStyles;constructor(e,n,r){this._element=e,this._startStyles=n,this._endStyles=r;let o=i.initialStylesByElement.get(e);o||i.initialStylesByElement.set(e,o=new Map),this._initialStyles=o}start(){this._state<1&&(this._startStyles&&Be(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Be(this._element,this._initialStyles),this._endStyles&&(Be(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(i.initialStylesByElement.delete(this._element),this._startStyles&&(xt(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(xt(this._element,this._endStyles),this._endStyles=null),Be(this._element,this._initialStyles),this._state=3)}}return i})();function Bi(i){let t=null;return i.forEach((e,n)=>{Tl(n)&&(t=t||new Map,t.set(n,e))}),t}function Tl(i){return i==="display"||i==="position"}var Kn=class{element;keyframes;options;_specialStyles;_onDoneFns=[];_onStartFns=[];_onDestroyFns=[];_duration;_delay;_initialized=!1;_finished=!1;_started=!1;_destroyed=!1;_finalKeyframe;_originalOnDoneFns=[];_originalOnStartFns=[];domPlayer;time=0;parentPlayer=null;currentSnapshot=new Map;constructor(t,e,n,r){this.element=t,this.keyframes=e,this.options=n,this._specialStyles=r,this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;let t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:new Map;let e=()=>this._onFinish();this.domPlayer.addEventListener("finish",e),this.onDestroy(()=>{this.domPlayer.removeEventListener("finish",e)})}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(t){let e=[];return t.forEach(n=>{e.push(Object.fromEntries(n))}),e}_triggerWebAnimation(t,e,n){return t.animate(this._convertKeyframesToObject(e),n)}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){this.domPlayer===void 0&&this.init(),this.domPlayer.currentTime=t*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){let t=new Map;this.hasStarted()&&this._finalKeyframe.forEach((n,r)=>{r!=="offset"&&t.set(r,this._finished?n:sr(this.element,r))}),this.currentSnapshot=t}triggerCallback(t){let e=t==="start"?this._onStartFns:this._onDoneFns;e.forEach(n=>n()),e.length=0}},Jn=class{validateStyleProperty(t){return!0}validateAnimatableStyleProperty(t){return!0}containsElement(t,e){return jo(t,e)}getParentElement(t){return ir(t)}query(t,e,n){return Uo(t,e,n)}computeStyle(t,e,n){return sr(t,e)}animate(t,e,n,r,o,c=[]){let u=r==0?"both":"forwards",p={duration:n,delay:r,fill:u};o&&(p.easing=o);let m=new Map,w=c.filter(I=>I instanceof Kn);Ga(n,r)&&w.forEach(I=>{I.currentSnapshot.forEach((S,P)=>m.set(P,S))});let x=za(e).map(I=>new Map(I));x=Ha(t,x,m);let F=Sl(t,x);return new Kn(t,x,p,F)}};var Un="@",Yo="@.disabled",Yn=class{namespaceId;delegate;engine;_onDestroy;\u0275type=0;constructor(t,e,n,r){this.namespaceId=t,this.delegate=e,this.engine=n,this._onDestroy=r}get data(){return this.delegate.data}destroyNode(t){this.delegate.destroyNode?.(t)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,e){this.delegate.appendChild(t,e),this.engine.onInsert(this.namespaceId,e,t,!1)}insertBefore(t,e,n,r=!0){this.delegate.insertBefore(t,e,n),this.engine.onInsert(this.namespaceId,e,t,r)}removeChild(t,e,n){this.parentNode(e)&&this.engine.onRemove(this.namespaceId,e,this.delegate)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,n,r){this.delegate.setAttribute(t,e,n,r)}removeAttribute(t,e,n){this.delegate.removeAttribute(t,e,n)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,n,r){this.delegate.setStyle(t,e,n,r)}removeStyle(t,e,n){this.delegate.removeStyle(t,e,n)}setProperty(t,e,n){e.charAt(0)==Un&&e==Yo?this.disableAnimations(t,!!n):this.delegate.setProperty(t,e,n)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,n,r){return this.delegate.listen(t,e,n,r)}disableAnimations(t,e){this.engine.disableAnimations(t,e)}},er=class extends Yn{factory;constructor(t,e,n,r,o){super(e,n,r,o),this.factory=t,this.namespaceId=e}setProperty(t,e,n){e.charAt(0)==Un?e.charAt(1)=="."&&e==Yo?(n=n===void 0?!0:!!n,this.disableAnimations(t,n)):this.engine.process(this.namespaceId,t,e.slice(1),n):this.delegate.setProperty(t,e,n)}listen(t,e,n,r){if(e.charAt(0)==Un){let o=Ml(t),c=e.slice(1),u="";return c.charAt(0)!=Un&&([c,u]=Il(c)),this.engine.listen(this.namespaceId,o,c,u,p=>{let m=p._data||-1;this.factory.scheduleListenerCallback(m,n,p)})}return this.delegate.listen(t,e,n,r)}};function Ml(i){switch(i){case"body":return document.body;case"document":return document;case"window":return window;default:return i}}function Il(i){let t=i.indexOf("."),e=i.substring(0,t),n=i.slice(t+1);return[e,n]}var Zn=class{delegate;engine;_zone;_currentId=0;_microtaskId=1;_animationCallbacksBuffer=[];_rendererCache=new Map;_cdRecurDepth=0;constructor(t,e,n){this.delegate=t,this.engine=e,this._zone=n,e.onRemovalComplete=(r,o)=>{o?.removeChild(null,r)}}createRenderer(t,e){let n="",r=this.delegate.createRenderer(t,e);if(!t||!e?.data?.animation){let m=this._rendererCache,w=m.get(r);if(!w){let x=()=>m.delete(r);w=new Yn(n,r,this.engine,x),m.set(r,w)}return w}let o=e.id,c=e.id+"-"+this._currentId;this._currentId++,this.engine.register(c,t);let u=m=>{Array.isArray(m)?m.forEach(u):this.engine.registerTrigger(o,c,t,m.name,m)};return e.data.animation.forEach(u),new er(this,c,r,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(t,e,n){if(t>=0&&t<this._microtaskId){this._zone.run(()=>e(n));return}let r=this._animationCallbacksBuffer;r.length==0&&queueMicrotask(()=>{this._zone.run(()=>{r.forEach(o=>{let[c,u]=o;c(u)}),this._animationCallbacksBuffer=[]})}),r.push([e,n])}end(){this._cdRecurDepth--,this._cdRecurDepth==0&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}componentReplaced(t){this.engine.flush(),this.delegate.componentReplaced?.(t)}};var kl=(()=>{class i extends Gt{constructor(e,n,r){super(e,n,r)}ngOnDestroy(){this.flush()}static \u0275fac=function(n){return new(n||i)(q(Ke),q(St),q(Et))};static \u0275prov=z({token:i,factory:i.\u0275fac})}return i})();function Pl(){return new Wn}function Dl(i,t,e){return new Zn(i,t,e)}var Zo=[{provide:Et,useFactory:Pl},{provide:Gt,useClass:kl},{provide:no,useFactory:Dl,deps:[_o,Gt,Nt]}],Fl=[{provide:St,useFactory:()=>new Jn},{provide:kn,useValue:"BrowserAnimations"},...Zo],hm=[{provide:St,useClass:rr},{provide:kn,useValue:"NoopAnimations"},...Zo];function Xo(){return Xr("NgEagerAnimations"),[...Fl]}var lr;try{lr=typeof Intl<"u"&&Intl.v8BreakIterator}catch{lr=!1}var Xn=(()=>{class i{_platformId=$(Rt);isBrowser=this._platformId?Je(this._platformId):typeof document=="object"&&!!document;EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent);TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent);BLINK=this.isBrowser&&!!(window.chrome||lr)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT;WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT;IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window);FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent);ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT;SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT;constructor(){}static \u0275fac=function(n){return new(n||i)};static \u0275prov=z({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function cr(i){return Array.isArray(i)?i:[i]}var es=new Set,Tt,Ol=(()=>{class i{_platform=$(Xn);_nonce=$(eo,{optional:!0});_matchMedia;constructor(){this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):Rl}matchMedia(e){return(this._platform.WEBKIT||this._platform.BLINK)&&Nl(e,this._nonce),this._matchMedia(e)}static \u0275fac=function(n){return new(n||i)};static \u0275prov=z({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function Nl(i,t){if(!es.has(i))try{Tt||(Tt=document.createElement("style"),t&&Tt.setAttribute("nonce",t),Tt.setAttribute("type","text/css"),document.head.appendChild(Tt)),Tt.sheet&&(Tt.sheet.insertRule(`@media ${i} {body{ }}`,0),es.add(i))}catch(e){console.error(e)}}function Rl(i){return{matches:i==="all"||i==="",media:i,addListener:()=>{},removeListener:()=>{}}}var ns=(()=>{class i{_mediaMatcher=$(Ol);_zone=$(Nt);_queries=new Map;_destroySubject=new Sn;constructor(){}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(e){return ts(cr(e)).some(r=>this._registerQuery(r).mql.matches)}observe(e){let r=ts(cr(e)).map(c=>this._registerQuery(c).observable),o=zr(r);return o=qr(o.pipe(Mn(1)),o.pipe(Qr(1),Gr(0))),o.pipe(Ie(c=>{let u={matches:!1,breakpoints:{}};return c.forEach(({matches:p,query:m})=>{u.matches=u.matches||p,u.breakpoints[m]=p}),u}))}_registerQuery(e){if(this._queries.has(e))return this._queries.get(e);let n=this._mediaMatcher.matchMedia(e),o={observable:new Br(c=>{let u=p=>this._zone.run(()=>c.next(p));return n.addListener(u),()=>{n.removeListener(u)}}).pipe(Kr(n),Ie(({matches:c})=>({query:e,matches:c})),Yr(this._destroySubject)),mql:n};return this._queries.set(e,o),o}static \u0275fac=function(n){return new(n||i)};static \u0275prov=z({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function ts(i){return i.map(t=>t.split(",")).reduce((t,e)=>t.concat(e)).map(t=>t.trim())}var Mt=function(i){return i[i.NONE=0]="NONE",i[i.BLACK_ON_WHITE=1]="BLACK_ON_WHITE",i[i.WHITE_ON_BLACK=2]="WHITE_ON_BLACK",i}(Mt||{}),is="cdk-high-contrast-black-on-white",rs="cdk-high-contrast-white-on-black",dr="cdk-high-contrast-active",ss=(()=>{class i{_platform=$(Xn);_hasCheckedHighContrastMode;_document=$(Ke);_breakpointSubscription;constructor(){this._breakpointSubscription=$(ns).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return Mt.NONE;let e=this._document.createElement("div");e.style.backgroundColor="rgb(1,2,3)",e.style.position="absolute",this._document.body.appendChild(e);let n=this._document.defaultView||window,r=n&&n.getComputedStyle?n.getComputedStyle(e):null,o=(r&&r.backgroundColor||"").replace(/ /g,"");switch(e.remove(),o){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return Mt.WHITE_ON_BLACK;case"rgb(255,255,255)":case"rgb(255,250,239)":return Mt.BLACK_ON_WHITE}return Mt.NONE}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){let e=this._document.body.classList;e.remove(dr,is,rs),this._hasCheckedHighContrastMode=!0;let n=this.getHighContrastMode();n===Mt.BLACK_ON_WHITE?e.add(dr,is):n===Mt.WHITE_ON_BLACK&&e.add(dr,rs)}}static \u0275fac=function(n){return new(n||i)};static \u0275prov=z({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var ur=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=ge({type:i});static \u0275inj=fe({})}return i})();var mr=(()=>{class i{constructor(){$(ss)._applyBodyHighContrastModeCssClasses()}static \u0275fac=function(n){return new(n||i)};static \u0275mod=ge({type:i});static \u0275inj=fe({imports:[ur,ur]})}return i})();var jl=["*"],ei;function Ul(){if(ei===void 0&&(ei=null,typeof window<"u")){let i=window;i.trustedTypes!==void 0&&(ei=i.trustedTypes.createPolicy("angular#components",{createHTML:t=>t}))}return ei}function hn(i){return Ul()?.createHTML(i)||i}function as(i){return Error(`Unable to find icon with the name "${i}"`)}function zl(){return Error("Could not find HttpClient for use with Angular Material icons. Please add provideHttpClient() to your providers.")}function ls(i){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${i}".`)}function cs(i){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${i}".`)}var Ze=class{url;svgText;options;svgElement;constructor(t,e,n){this.url=t,this.svgText=e,this.options=n}},ql=(()=>{class i{_httpClient;_sanitizer;_errorHandler;_document;_svgIconConfigs=new Map;_iconSetConfigs=new Map;_cachedIconsByUrl=new Map;_inProgressUrlFetches=new Map;_fontCssClassesByAlias=new Map;_resolvers=[];_defaultFontSetClass=["material-icons","mat-ligature-font"];constructor(e,n,r,o){this._httpClient=e,this._sanitizer=n,this._errorHandler=o,this._document=r}addSvgIcon(e,n,r){return this.addSvgIconInNamespace("",e,n,r)}addSvgIconLiteral(e,n,r){return this.addSvgIconLiteralInNamespace("",e,n,r)}addSvgIconInNamespace(e,n,r,o){return this._addSvgIconConfig(e,n,new Ze(r,null,o))}addSvgIconResolver(e){return this._resolvers.push(e),this}addSvgIconLiteralInNamespace(e,n,r,o){let c=this._sanitizer.sanitize(Vt.HTML,r);if(!c)throw cs(r);let u=hn(c);return this._addSvgIconConfig(e,n,new Ze("",u,o))}addSvgIconSet(e,n){return this.addSvgIconSetInNamespace("",e,n)}addSvgIconSetLiteral(e,n){return this.addSvgIconSetLiteralInNamespace("",e,n)}addSvgIconSetInNamespace(e,n,r){return this._addSvgIconSetConfig(e,new Ze(n,null,r))}addSvgIconSetLiteralInNamespace(e,n,r){let o=this._sanitizer.sanitize(Vt.HTML,n);if(!o)throw cs(n);let c=hn(o);return this._addSvgIconSetConfig(e,new Ze("",c,r))}registerFontClassAlias(e,n=e){return this._fontCssClassesByAlias.set(e,n),this}classNameForFontAlias(e){return this._fontCssClassesByAlias.get(e)||e}setDefaultFontSetClass(...e){return this._defaultFontSetClass=e,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(e){let n=this._sanitizer.sanitize(Vt.RESOURCE_URL,e);if(!n)throw ls(e);let r=this._cachedIconsByUrl.get(n);return r?Ot(ti(r)):this._loadSvgIconFromConfig(new Ze(e,null)).pipe(In(o=>this._cachedIconsByUrl.set(n,o)),Ie(o=>ti(o)))}getNamedSvgIcon(e,n=""){let r=ds(n,e),o=this._svgIconConfigs.get(r);if(o)return this._getSvgFromConfig(o);if(o=this._getIconConfigFromResolvers(n,e),o)return this._svgIconConfigs.set(r,o),this._getSvgFromConfig(o);let c=this._iconSetConfigs.get(n);return c?this._getSvgFromIconSetConfigs(e,c):jr(as(r))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(e){return e.svgText?Ot(ti(this._svgElementFromConfig(e))):this._loadSvgIconFromConfig(e).pipe(Ie(n=>ti(n)))}_getSvgFromIconSetConfigs(e,n){let r=this._extractIconWithNameFromAnySet(e,n);if(r)return Ot(r);let o=n.filter(c=>!c.svgText).map(c=>this._loadSvgIconSetFromConfig(c).pipe(Wr(u=>{let m=`Loading icon set URL: ${this._sanitizer.sanitize(Vt.RESOURCE_URL,c.url)} failed: ${u.message}`;return this._errorHandler.handleError(new Error(m)),Ot(null)})));return Tn(o).pipe(Ie(()=>{let c=this._extractIconWithNameFromAnySet(e,n);if(!c)throw as(e);return c}))}_extractIconWithNameFromAnySet(e,n){for(let r=n.length-1;r>=0;r--){let o=n[r];if(o.svgText&&o.svgText.toString().indexOf(e)>-1){let c=this._svgElementFromConfig(o),u=this._extractSvgIconFromSet(c,e,o.options);if(u)return u}}return null}_loadSvgIconFromConfig(e){return this._fetchIcon(e).pipe(In(n=>e.svgText=n),Ie(()=>this._svgElementFromConfig(e)))}_loadSvgIconSetFromConfig(e){return e.svgText?Ot(null):this._fetchIcon(e).pipe(In(n=>e.svgText=n))}_extractSvgIconFromSet(e,n,r){let o=e.querySelector(`[id="${n}"]`);if(!o)return null;let c=o.cloneNode(!0);if(c.removeAttribute("id"),c.nodeName.toLowerCase()==="svg")return this._setSvgAttributes(c,r);if(c.nodeName.toLowerCase()==="symbol")return this._setSvgAttributes(this._toSvgElement(c),r);let u=this._svgElementFromString(hn("<svg></svg>"));return u.appendChild(c),this._setSvgAttributes(u,r)}_svgElementFromString(e){let n=this._document.createElement("DIV");n.innerHTML=e;let r=n.querySelector("svg");if(!r)throw Error("<svg> tag not found");return r}_toSvgElement(e){let n=this._svgElementFromString(hn("<svg></svg>")),r=e.attributes;for(let o=0;o<r.length;o++){let{name:c,value:u}=r[o];c!=="id"&&n.setAttribute(c,u)}for(let o=0;o<e.childNodes.length;o++)e.childNodes[o].nodeType===this._document.ELEMENT_NODE&&n.appendChild(e.childNodes[o].cloneNode(!0));return n}_setSvgAttributes(e,n){return e.setAttribute("fit",""),e.setAttribute("height","100%"),e.setAttribute("width","100%"),e.setAttribute("preserveAspectRatio","xMidYMid meet"),e.setAttribute("focusable","false"),n&&n.viewBox&&e.setAttribute("viewBox",n.viewBox),e}_fetchIcon(e){let{url:n,options:r}=e,o=r?.withCredentials??!1;if(!this._httpClient)throw zl();if(n==null)throw Error(`Cannot fetch icon from URL "${n}".`);let c=this._sanitizer.sanitize(Vt.RESOURCE_URL,n);if(!c)throw ls(n);let u=this._inProgressUrlFetches.get(c);if(u)return u;let p=this._httpClient.get(c,{responseType:"text",withCredentials:o}).pipe(Ie(m=>hn(m)),Hr(()=>this._inProgressUrlFetches.delete(c)),$r());return this._inProgressUrlFetches.set(c,p),p}_addSvgIconConfig(e,n,r){return this._svgIconConfigs.set(ds(e,n),r),this}_addSvgIconSetConfig(e,n){let r=this._iconSetConfigs.get(e);return r?r.push(n):this._iconSetConfigs.set(e,[n]),this}_svgElementFromConfig(e){if(!e.svgElement){let n=this._svgElementFromString(e.svgText);this._setSvgAttributes(n,e.options),e.svgElement=n}return e.svgElement}_getIconConfigFromResolvers(e,n){for(let r=0;r<this._resolvers.length;r++){let o=this._resolvers[r](n,e);if(o)return Wl(o)?new Ze(o.url,null,o.options):new Ze(o,null)}}static \u0275fac=function(n){return new(n||i)(q(On,8),q(yo),q(Ke,8),q(An))};static \u0275prov=z({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function ti(i){return i.cloneNode(!0)}function ds(i,t){return i+":"+t}function Wl(i){return!!(i.url&&i.options)}var Gl=new xe("MAT_ICON_DEFAULT_OPTIONS"),Hl=new xe("mat-icon-location",{providedIn:"root",factory:$l});function $l(){let i=$(Ke),t=i?i.location:null;return{getPathname:()=>t?t.pathname+t.search:""}}var us=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],Ql=us.map(i=>`[${i}]`).join(", "),Kl=/^url\(['"]?#(.*?)['"]?\)$/,ni=(()=>{class i{_elementRef=$(We);_iconRegistry=$(ql);_location=$(Hl);_errorHandler=$(An);_defaultColor;get color(){return this._color||this._defaultColor}set color(e){this._color=e}_color;inline=!1;get svgIcon(){return this._svgIcon}set svgIcon(e){e!==this._svgIcon&&(e?this._updateSvgIcon(e):this._svgIcon&&this._clearSvgElement(),this._svgIcon=e)}_svgIcon;get fontSet(){return this._fontSet}set fontSet(e){let n=this._cleanupFontValue(e);n!==this._fontSet&&(this._fontSet=n,this._updateFontIconClasses())}_fontSet;get fontIcon(){return this._fontIcon}set fontIcon(e){let n=this._cleanupFontValue(e);n!==this._fontIcon&&(this._fontIcon=n,this._updateFontIconClasses())}_fontIcon;_previousFontSetClass=[];_previousFontIconClass;_svgName;_svgNamespace;_previousPath;_elementsWithExternalReferences;_currentIconFetch=Lr.EMPTY;constructor(){let e=$(new Zr("aria-hidden"),{optional:!0}),n=$(Gl,{optional:!0});n&&(n.color&&(this.color=this._defaultColor=n.color),n.fontSet&&(this.fontSet=n.fontSet)),e||this._elementRef.nativeElement.setAttribute("aria-hidden","true")}_splitIconName(e){if(!e)return["",""];let n=e.split(":");switch(n.length){case 1:return["",n[0]];case 2:return n;default:throw Error(`Invalid icon name: "${e}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){let e=this._elementsWithExternalReferences;if(e&&e.size){let n=this._location.getPathname();n!==this._previousPath&&(this._previousPath=n,this._prependPathToReferences(n))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(e){this._clearSvgElement();let n=this._location.getPathname();this._previousPath=n,this._cacheChildrenWithExternalReferences(e),this._prependPathToReferences(n),this._elementRef.nativeElement.appendChild(e)}_clearSvgElement(){let e=this._elementRef.nativeElement,n=e.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();n--;){let r=e.childNodes[n];(r.nodeType!==1||r.nodeName.toLowerCase()==="svg")&&r.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;let e=this._elementRef.nativeElement,n=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(r=>r.length>0);this._previousFontSetClass.forEach(r=>e.classList.remove(r)),n.forEach(r=>e.classList.add(r)),this._previousFontSetClass=n,this.fontIcon!==this._previousFontIconClass&&!n.includes("mat-ligature-font")&&(this._previousFontIconClass&&e.classList.remove(this._previousFontIconClass),this.fontIcon&&e.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(e){return typeof e=="string"?e.trim().split(" ")[0]:e}_prependPathToReferences(e){let n=this._elementsWithExternalReferences;n&&n.forEach((r,o)=>{r.forEach(c=>{o.setAttribute(c.name,`url('${e}#${c.value}')`)})})}_cacheChildrenWithExternalReferences(e){let n=e.querySelectorAll(Ql),r=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let o=0;o<n.length;o++)us.forEach(c=>{let u=n[o],p=u.getAttribute(c),m=p?p.match(Kl):null;if(m){let w=r.get(u);w||(w=[],r.set(u,w)),w.push({name:c,value:m[1]})}})}_updateSvgIcon(e){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),e){let[n,r]=this._splitIconName(e);n&&(this._svgNamespace=n),r&&(this._svgName=r),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(r,n).pipe(Mn(1)).subscribe(o=>this._setSvgElement(o),o=>{let c=`Error retrieving icon ${n}:${r}! ${o.message}`;this._errorHandler.handleError(new Error(c))})}}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=K({type:i,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:10,hostBindings:function(n,r){n&2&&(rn("data-mat-icon-type",r._usingFontIcon()?"font":"svg")("data-mat-icon-name",r._svgName||r.fontIcon)("data-mat-icon-namespace",r._svgNamespace||r.fontSet)("fontIcon",r._usingFontIcon()?r.fontIcon:null),oo(r.color?"mat-"+r.color:""),D("mat-icon-inline",r.inline)("mat-icon-no-color",r.color!=="primary"&&r.color!=="accent"&&r.color!=="warn"))},inputs:{color:"color",inline:[2,"inline","inline",zt],svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[Pn],ngContentSelectors:jl,decls:1,vars:0,template:function(n,r){n&1&&(ki(),Pi(0))},styles:["mat-icon,mat-icon.mat-primary,mat-icon.mat-accent,mat-icon.mat-warn{color:var(--mat-icon-color, inherit)}.mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0})}return i})(),ms=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=ge({type:i});static \u0275inj=fe({imports:[mr,mr]})}return i})();var ii=class i{constructor(t){this.supabaseService=t;this.userFirstName=this.supabaseService.currentUsername()}userFirstName;static \u0275fac=function(e){return new(e||i)(C(G))};static \u0275cmp=K({type:i,selectors:[["app-landing-page"]],decls:66,vars:4,consts:[[1,"container","mt-4"],[1,"mb-4","text-center"],[1,"row","g-4","mb-5"],[1,"col-md-6"],[1,"card","h-100","shadow-sm"],[1,"card-body","d-flex","align-items-center"],[1,"ms-4","me-4","step-icon",2,"--step-color","#2563eb"],[1,"flex-grow-1"],[1,"text-uppercase","fw-bold","text-secondary",2,"letter-spacing","2px"],[1,"fw-semibold","mb-1"],[1,"mb-3","text-secondary"],[1,"btn","btn-lg","fw-bold","w-100",2,"background","#2563eb","color","#fff",3,"routerLink"],[1,"ms-4","me-4","step-icon",2,"--step-color","#15803d"],[1,"btn","btn-lg","fw-bold","w-100",2,"background","#15803d","color","#fff",3,"routerLink"],[1,"ms-4","me-4","step-icon",2,"--step-color","#b45309"],[1,"btn","btn-lg","fw-bold","w-100",2,"background","#b45309","color","#fff",3,"routerLink"],[1,"ms-4","me-4","step-icon",2,"--step-color","#6d28d9"],[1,"btn","btn-lg","fw-bold","w-100",2,"background","#6d28d9","color","#fff",3,"routerLink"]],template:function(e,n){e&1&&(a(0,"div",0)(1,"h2",1),l(2,"Begin Your Trading Transformation"),s(),a(3,"h2",1),l(4,"Your Professional Workflow"),s(),a(5,"div",2)(6,"div",3)(7,"div",4)(8,"div",5)(9,"div",6)(10,"mat-icon"),l(11,"check_circle"),s()(),a(12,"div",7)(13,"div",8),l(14,"Step 1 "),s(),a(15,"h4",9),l(16,"Daily Emotional Check-in"),s(),a(17,"p",10),l(18,"Understand your emotional state before making trading decisions."),s(),a(19,"a",11),l(20,"Begin Assessment"),s()()()()(),a(21,"div",3)(22,"div",4)(23,"div",5)(24,"div",12)(25,"mat-icon"),l(26,"trending_up"),s()(),a(27,"div",7)(28,"div",8),l(29,"Step 2 "),s(),a(30,"h4",9),l(31,"Plan Your Trades"),s(),a(32,"p",10),l(33,"Document your trading plan before executing any trades."),s(),a(34,"a",13),l(35,"Create Trading Plan"),s()()()()(),a(36,"div",3)(37,"div",4)(38,"div",5)(39,"div",14)(40,"mat-icon"),l(41,"candlestick_chart"),s()(),a(42,"div",7)(43,"div",8),l(44,"Step 3 "),s(),a(45,"h4",9),l(46,"Update your Trades"),s(),a(47,"p",10),l(48,"Record results and analyze your trading performance."),s(),a(49,"a",15),l(50,"Manage Positions"),s()()()()(),a(51,"div",3)(52,"div",4)(53,"div",5)(54,"div",16)(55,"mat-icon"),l(56,"psychology"),s()(),a(57,"div",7)(58,"div",8),l(59,"Step 4 "),s(),a(60,"h4",9),l(61,"Reflection & Meditation"),s(),a(62,"p",10),l(63,"Clear your mind with mindfulness practices."),s(),a(64,"a",17),l(65,"Begin Session"),s()()()()()()()),e&2&&(d(19),f("routerLink","/emotions"),d(15),f("routerLink","/tradejournal"),d(15),f("routerLink","/tradejournal"),d(15),f("routerLink","/meditationhub"))},dependencies:[_e,X,ms,ni],styles:[".card[_ngcontent-%COMP%]{border:none;border-radius:8px}.card-body[_ngcontent-%COMP%]{padding-left:0}.card-body[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{font-weight:600;margin-bottom:.75rem}.card-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:1rem}.btn-custom[_ngcontent-%COMP%]{border-radius:20px;font-weight:600}.step-icon[_ngcontent-%COMP%]{width:64px;height:64px;background:var(--step-color, --primary-btn-color);border-radius:16px;display:flex;align-items:center;justify-content:center;flex-shrink:0;box-shadow:0 2px 8px #0000000a}.step-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#fff;font-size:36px;width:36px;height:36px;line-height:36px;display:flex;align-items:center;justify-content:center}.card-body.d-flex.align-items-center[_ngcontent-%COMP%]{gap:1.5rem}@media (max-width: 576px){.card-body[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{font-size:1.1rem}.card-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.9rem}.btn-custom[_ngcontent-%COMP%]{padding:.5rem 1rem}}"]})};var Pe=class i{constructor(t,e){this.supabaseService=t;this.router=e}canActivate(t,e){return this.supabaseService.loginStatus()?!0:this.router.createUrlTree([""],{queryParams:{returnUrl:e.url}})}static \u0275fac=function(e){return new(e||i)(q(G),q(ne))};static \u0275prov=z({token:i,factory:i.\u0275fac,providedIn:"root"})};var fn=class i{constructor(t,e){this.supabaseService=t;this.router=e}canActivate(t,e){return this.supabaseService.loginStatus()?this.router.createUrlTree(["/home"]):!0}static \u0275fac=function(e){return new(e||i)(q(G),q(ne))};static \u0275prov=z({token:i,factory:i.\u0275fac,providedIn:"root"})};var Cs=(()=>{class i{_renderer;_elementRef;onChange=e=>{};onTouched=()=>{};constructor(e,n){this._renderer=e,this._elementRef=n}setProperty(e,n){this._renderer.setProperty(this._elementRef.nativeElement,e,n)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}static \u0275fac=function(n){return new(n||i)(C(nn),C(We))};static \u0275dir=ee({type:i})}return i})(),Kt=(()=>{class i extends Cs{static \u0275fac=(()=>{let e;return function(r){return(e||(e=vt(i)))(r||i)}})();static \u0275dir=ee({type:i,features:[ye]})}return i})(),ut=new xe(""),Yl={provide:ut,useExisting:Re(()=>yr),multi:!0},yr=(()=>{class i extends Kt{writeValue(e){this.setProperty("checked",e)}static \u0275fac=(()=>{let e;return function(r){return(e||(e=vt(i)))(r||i)}})();static \u0275dir=ee({type:i,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(n,r){n&1&&g("change",function(c){return r.onChange(c.target.checked)})("blur",function(){return r.onTouched()})},standalone:!1,features:[Se([Yl]),ye]})}return i})(),Zl={provide:ut,useExisting:Re(()=>ie),multi:!0};function Xl(){let i=Di()?Di().getUserAgent():"";return/android (\d+)/.test(i.toLowerCase())}var ec=new xe(""),ie=(()=>{class i extends Cs{_compositionMode;_composing=!1;constructor(e,n,r){super(e,n),this._compositionMode=r,this._compositionMode==null&&(this._compositionMode=!Xl())}writeValue(e){let n=e??"";this.setProperty("value",n)}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}static \u0275fac=function(n){return new(n||i)(C(nn),C(We),C(ec,8))};static \u0275dir=ee({type:i,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(n,r){n&1&&g("input",function(c){return r._handleInput(c.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(c){return r._compositionEnd(c.target.value)})},standalone:!1,features:[Se([Zl]),ye]})}return i})();function ct(i){return i==null||(typeof i=="string"||Array.isArray(i))&&i.length===0}function xs(i){return i!=null&&typeof i.length=="number"}var br=new xe(""),wr=new xe(""),tc=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,H=class{static min(t){return nc(t)}static max(t){return ic(t)}static required(t){return rc(t)}static requiredTrue(t){return oc(t)}static email(t){return sc(t)}static minLength(t){return ac(t)}static maxLength(t){return lc(t)}static pattern(t){return cc(t)}static nullValidator(t){return Ss(t)}static compose(t){return ks(t)}static composeAsync(t){return Ds(t)}};function nc(i){return t=>{if(ct(t.value)||ct(i))return null;let e=parseFloat(t.value);return!isNaN(e)&&e<i?{min:{min:i,actual:t.value}}:null}}function ic(i){return t=>{if(ct(t.value)||ct(i))return null;let e=parseFloat(t.value);return!isNaN(e)&&e>i?{max:{max:i,actual:t.value}}:null}}function rc(i){return ct(i.value)?{required:!0}:null}function oc(i){return i.value===!0?null:{required:!0}}function sc(i){return ct(i.value)||tc.test(i.value)?null:{email:!0}}function ac(i){return t=>ct(t.value)||!xs(t.value)?null:t.value.length<i?{minlength:{requiredLength:i,actualLength:t.value.length}}:null}function lc(i){return t=>xs(t.value)&&t.value.length>i?{maxlength:{requiredLength:i,actualLength:t.value.length}}:null}function cc(i){if(!i)return Ss;let t,e;return typeof i=="string"?(e="",i.charAt(0)!=="^"&&(e+="^"),e+=i,i.charAt(i.length-1)!=="$"&&(e+="$"),t=new RegExp(e)):(e=i.toString(),t=i),n=>{if(ct(n.value))return null;let r=n.value;return t.test(r)?null:{pattern:{requiredPattern:e,actualValue:r}}}}function Ss(i){return null}function Es(i){return i!=null}function Ts(i){return io(i)?En(i):i}function Ms(i){let t={};return i.forEach(e=>{t=e!=null?W(W({},t),e):t}),Object.keys(t).length===0?null:t}function Is(i,t){return t.map(e=>e(i))}function dc(i){return!i.validate}function As(i){return i.map(t=>dc(t)?t:e=>t.validate(e))}function ks(i){if(!i)return null;let t=i.filter(Es);return t.length==0?null:function(e){return Ms(Is(e,t))}}function Ps(i){return i!=null?ks(As(i)):null}function Ds(i){if(!i)return null;let t=i.filter(Es);return t.length==0?null:function(e){let n=Is(e,t).map(Ts);return Tn(n).pipe(Ie(Ms))}}function Fs(i){return i!=null?Ds(As(i)):null}function ps(i,t){return i===null?[t]:Array.isArray(i)?[...i,t]:[i,t]}function Os(i){return i._rawValidators}function Ns(i){return i._rawAsyncValidators}function pr(i){return i?Array.isArray(i)?i:[i]:[]}function oi(i,t){return Array.isArray(i)?i.includes(t):i===t}function hs(i,t){let e=pr(t);return pr(i).forEach(r=>{oi(e,r)||e.push(r)}),e}function fs(i,t){return pr(t).filter(e=>!oi(i,e))}var si=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=Ps(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=Fs(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t=void 0){this.control&&this.control.reset(t)}hasError(t,e){return this.control?this.control.hasError(t,e):!1}getError(t,e){return this.control?this.control.getError(t,e):null}},It=class extends si{name;get formDirective(){return null}get path(){return null}},At=class extends si{_parent=null;name=null;valueAccessor=null},ai=class{_cd;constructor(t){this._cd=t}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},uc={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},Zp=Z(W({},uc),{"[class.ng-submitted]":"isSubmitted"}),le=(()=>{class i extends ai{constructor(e){super(e)}static \u0275fac=function(n){return new(n||i)(C(At,2))};static \u0275dir=ee({type:i,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(n,r){n&2&&D("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},standalone:!1,features:[ye]})}return i})(),Ue=(()=>{class i extends ai{constructor(e){super(e)}static \u0275fac=function(n){return new(n||i)(C(It,10))};static \u0275dir=ee({type:i,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(n,r){n&2&&D("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},standalone:!1,features:[ye]})}return i})();var gn="VALID",ri="INVALID",Ht="PENDING",_n="DISABLED",dt=class{},li=class extends dt{value;source;constructor(t,e){super(),this.value=t,this.source=e}},vn=class extends dt{pristine;source;constructor(t,e){super(),this.pristine=t,this.source=e}},yn=class extends dt{touched;source;constructor(t,e){super(),this.touched=t,this.source=e}},$t=class extends dt{status;source;constructor(t,e){super(),this.status=t,this.source=e}},hr=class extends dt{source;constructor(t){super(),this.source=t}},fr=class extends dt{source;constructor(t){super(),this.source=t}};function Cr(i){return(mi(i)?i.validators:i)||null}function mc(i){return Array.isArray(i)?Ps(i):i||null}function xr(i,t){return(mi(t)?t.asyncValidators:i)||null}function pc(i){return Array.isArray(i)?Fs(i):i||null}function mi(i){return i!=null&&!Array.isArray(i)&&typeof i=="object"}function Rs(i,t,e){let n=i.controls;if(!(t?Object.keys(n):n).length)throw new B(1e3,"");if(!n[e])throw new B(1001,"")}function Vs(i,t,e){i._forEachChild((n,r)=>{if(e[r]===void 0)throw new B(1002,"")})}var Qt=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(t,e){this._assignValidators(t),this._assignAsyncValidators(e)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get status(){return ot(this.statusReactive)}set status(t){ot(()=>this.statusReactive.set(t))}_status=oe(()=>this.statusReactive());statusReactive=A(void 0);get valid(){return this.status===gn}get invalid(){return this.status===ri}get pending(){return this.status==Ht}get disabled(){return this.status===_n}get enabled(){return this.status!==_n}errors;get pristine(){return ot(this.pristineReactive)}set pristine(t){ot(()=>this.pristineReactive.set(t))}_pristine=oe(()=>this.pristineReactive());pristineReactive=A(!0);get dirty(){return!this.pristine}get touched(){return ot(this.touchedReactive)}set touched(t){ot(()=>this.touchedReactive.set(t))}_touched=oe(()=>this.touchedReactive());touchedReactive=A(!1);get untouched(){return!this.touched}_events=new Sn;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._assignValidators(t)}setAsyncValidators(t){this._assignAsyncValidators(t)}addValidators(t){this.setValidators(hs(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(hs(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(fs(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(fs(t,this._rawAsyncValidators))}hasValidator(t){return oi(this._rawValidators,t)}hasAsyncValidator(t){return oi(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){let e=this.touched===!1;this.touched=!0;let n=t.sourceControl??this;this._parent&&!t.onlySelf&&this._parent.markAsTouched(Z(W({},t),{sourceControl:n})),e&&t.emitEvent!==!1&&this._events.next(new yn(!0,n))}markAllAsTouched(t={}){this.markAsTouched({onlySelf:!0,emitEvent:t.emitEvent,sourceControl:this}),this._forEachChild(e=>e.markAllAsTouched(t))}markAsUntouched(t={}){let e=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let n=t.sourceControl??this;this._forEachChild(r=>{r.markAsUntouched({onlySelf:!0,emitEvent:t.emitEvent,sourceControl:n})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t,n),e&&t.emitEvent!==!1&&this._events.next(new yn(!1,n))}markAsDirty(t={}){let e=this.pristine===!0;this.pristine=!1;let n=t.sourceControl??this;this._parent&&!t.onlySelf&&this._parent.markAsDirty(Z(W({},t),{sourceControl:n})),e&&t.emitEvent!==!1&&this._events.next(new vn(!1,n))}markAsPristine(t={}){let e=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let n=t.sourceControl??this;this._forEachChild(r=>{r.markAsPristine({onlySelf:!0,emitEvent:t.emitEvent})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t,n),e&&t.emitEvent!==!1&&this._events.next(new vn(!0,n))}markAsPending(t={}){this.status=Ht;let e=t.sourceControl??this;t.emitEvent!==!1&&(this._events.next(new $t(this.status,e)),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.markAsPending(Z(W({},t),{sourceControl:e}))}disable(t={}){let e=this._parentMarkedDirty(t.onlySelf);this.status=_n,this.errors=null,this._forEachChild(r=>{r.disable(Z(W({},t),{onlySelf:!0}))}),this._updateValue();let n=t.sourceControl??this;t.emitEvent!==!1&&(this._events.next(new li(this.value,n)),this._events.next(new $t(this.status,n)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Z(W({},t),{skipPristineCheck:e}),this),this._onDisabledChange.forEach(r=>r(!0))}enable(t={}){let e=this._parentMarkedDirty(t.onlySelf);this.status=gn,this._forEachChild(n=>{n.enable(Z(W({},t),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(Z(W({},t),{skipPristineCheck:e}),this),this._onDisabledChange.forEach(n=>n(!1))}_updateAncestors(t,e){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine({},e),this._parent._updateTouched({},e))}setParent(t){this._parent=t}getRawValue(){return this.value}updateValueAndValidity(t={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let n=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===gn||this.status===Ht)&&this._runAsyncValidator(n,t.emitEvent)}let e=t.sourceControl??this;t.emitEvent!==!1&&(this._events.next(new li(this.value,e)),this._events.next(new $t(this.status,e)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(Z(W({},t),{sourceControl:e}))}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?_n:gn}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t,e){if(this.asyncValidator){this.status=Ht,this._hasOwnPendingAsyncValidator={emitEvent:e!==!1};let n=Ts(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(r=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(r,{emitEvent:e,shouldHaveEmitted:t})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let t=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,t}return!1}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(e.emitEvent!==!1,this,e.shouldHaveEmitted)}get(t){let e=t;return e==null||(Array.isArray(e)||(e=e.split(".")),e.length===0)?null:e.reduce((n,r)=>n&&n._find(r),this)}getError(t,e){let n=e?this.get(e):this;return n&&n.errors?n.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t,e,n){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),(t||n)&&this._events.next(new $t(this.status,e)),this._parent&&this._parent._updateControlsErrors(t,e,n)}_initObservables(){this.valueChanges=new rt,this.statusChanges=new rt}_calculateStatus(){return this._allControlsDisabled()?_n:this.errors?ri:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Ht)?Ht:this._anyControlsHaveStatus(ri)?ri:gn}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t,e){let n=!this._anyControlsDirty(),r=this.pristine!==n;this.pristine=n,this._parent&&!t.onlySelf&&this._parent._updatePristine(t,e),r&&this._events.next(new vn(this.pristine,e))}_updateTouched(t={},e){this.touched=this._anyControlsTouched(),this._events.next(new yn(this.touched,e)),this._parent&&!t.onlySelf&&this._parent._updateTouched(t,e)}_onDisabledChange=[];_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){mi(t)&&t.updateOn!=null&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){let e=this._parent&&this._parent.dirty;return!t&&!!e&&!this._parent._anyControlsDirty()}_find(t){return null}_assignValidators(t){this._rawValidators=Array.isArray(t)?t.slice():t,this._composedValidatorFn=mc(this._rawValidators)}_assignAsyncValidators(t){this._rawAsyncValidators=Array.isArray(t)?t.slice():t,this._composedAsyncValidatorFn=pc(this._rawAsyncValidators)}},ci=class extends Qt{constructor(t,e,n){super(Cr(e),xr(n,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e,n={}){this.registerControl(t,e),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}removeControl(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(t,e,n={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){Vs(this,!0,t),Object.keys(t).forEach(n=>{Rs(this,!0,n),this.controls[n].setValue(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){t!=null&&(Object.keys(t).forEach(n=>{let r=this.controls[n];r&&r.patchValue(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t={},e={}){this._forEachChild((n,r)=>{n.reset(t?t[r]:null,{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e,this),this._updateTouched(e,this),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,n)=>(t[n]=e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(e,n)=>n._syncPendingControls()?!0:e);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(e=>{let n=this.controls[e];n&&t(n,e)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(let[e,n]of Object.entries(this.controls))if(this.contains(e)&&t(n))return!0;return!1}_reduceValue(){let t={};return this._reduceChildren(t,(e,n,r)=>((n.enabled||this.disabled)&&(e[r]=n.value),e))}_reduceChildren(t,e){let n=t;return this._forEachChild((r,o)=>{n=e(n,r,o)}),n}_allControlsDisabled(){for(let t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(t){return this.controls.hasOwnProperty(t)?this.controls[t]:null}};var gr=class extends ci{};var pi=new xe("",{providedIn:"root",factory:()=>hi}),hi="always";function Ls(i,t){return[...t.path,i]}function _r(i,t,e=hi){Sr(i,t),t.valueAccessor.writeValue(i.value),(i.disabled||e==="always")&&t.valueAccessor.setDisabledState?.(i.disabled),fc(i,t),_c(i,t),gc(i,t),hc(i,t)}function gs(i,t,e=!0){let n=()=>{};t.valueAccessor&&(t.valueAccessor.registerOnChange(n),t.valueAccessor.registerOnTouched(n)),ui(i,t),i&&(t._invokeOnDestroyCallbacks(),i._registerOnCollectionChange(()=>{}))}function di(i,t){i.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function hc(i,t){if(t.valueAccessor.setDisabledState){let e=n=>{t.valueAccessor.setDisabledState(n)};i.registerOnDisabledChange(e),t._registerOnDestroy(()=>{i._unregisterOnDisabledChange(e)})}}function Sr(i,t){let e=Os(i);t.validator!==null?i.setValidators(ps(e,t.validator)):typeof e=="function"&&i.setValidators([e]);let n=Ns(i);t.asyncValidator!==null?i.setAsyncValidators(ps(n,t.asyncValidator)):typeof n=="function"&&i.setAsyncValidators([n]);let r=()=>i.updateValueAndValidity();di(t._rawValidators,r),di(t._rawAsyncValidators,r)}function ui(i,t){let e=!1;if(i!==null){if(t.validator!==null){let r=Os(i);if(Array.isArray(r)&&r.length>0){let o=r.filter(c=>c!==t.validator);o.length!==r.length&&(e=!0,i.setValidators(o))}}if(t.asyncValidator!==null){let r=Ns(i);if(Array.isArray(r)&&r.length>0){let o=r.filter(c=>c!==t.asyncValidator);o.length!==r.length&&(e=!0,i.setAsyncValidators(o))}}}let n=()=>{};return di(t._rawValidators,n),di(t._rawAsyncValidators,n),e}function fc(i,t){t.valueAccessor.registerOnChange(e=>{i._pendingValue=e,i._pendingChange=!0,i._pendingDirty=!0,i.updateOn==="change"&&Bs(i,t)})}function gc(i,t){t.valueAccessor.registerOnTouched(()=>{i._pendingTouched=!0,i.updateOn==="blur"&&i._pendingChange&&Bs(i,t),i.updateOn!=="submit"&&i.markAsTouched()})}function Bs(i,t){i._pendingDirty&&i.markAsDirty(),i.setValue(i._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(i._pendingValue),i._pendingChange=!1}function _c(i,t){let e=(n,r)=>{t.valueAccessor.writeValue(n),r&&t.viewToModelUpdate(n)};i.registerOnChange(e),t._registerOnDestroy(()=>{i._unregisterOnChange(e)})}function vc(i,t){i==null,Sr(i,t)}function yc(i,t){return ui(i,t)}function js(i,t){if(!i.hasOwnProperty("model"))return!1;let e=i.model;return e.isFirstChange()?!0:!Object.is(t,e.currentValue)}function bc(i){return Object.getPrototypeOf(i.constructor)===Kt}function wc(i,t){i._syncPendingControls(),t.forEach(e=>{let n=e.control;n.updateOn==="submit"&&n._pendingChange&&(e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1)})}function Us(i,t){if(!t)return null;Array.isArray(t);let e,n,r;return t.forEach(o=>{o.constructor===ie?e=o:bc(o)?n=o:r=o}),r||n||e||null}function Cc(i,t){let e=i.indexOf(t);e>-1&&i.splice(e,1)}function _s(i,t){let e=i.indexOf(t);e>-1&&i.splice(e,1)}function vs(i){return typeof i=="object"&&i!==null&&Object.keys(i).length===2&&"value"in i&&"disabled"in i}var bn=class extends Qt{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(t=null,e,n){super(Cr(e),xr(n,e)),this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),mi(e)&&(e.nonNullable||e.initialValueIsDefault)&&(vs(t)?this.defaultValue=t.value:this.defaultValue=t)}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&e.emitModelToViewChange!==!1&&this._onChange.forEach(n=>n(this.value,e.emitViewToModelChange!==!1)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=this.defaultValue,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){_s(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){_s(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(t){vs(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}};var xc=i=>i instanceof bn;var Sc={provide:At,useExisting:Re(()=>et)},ys=Promise.resolve(),et=(()=>{class i extends At{_changeDetectorRef;callSetDisabledState;control=new bn;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new rt;constructor(e,n,r,o,c,u){super(),this._changeDetectorRef=c,this.callSetDisabledState=u,this._parent=e,this._setValidators(n),this._setAsyncValidators(r),this.valueAccessor=Us(this,o)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){let n=e.name.previousValue;this.formDirective.removeControl({name:n,path:this._getPath(n)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),js(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){_r(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(e){ys.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){let n=e.isDisabled.currentValue,r=n!==0&&zt(n);ys.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?Ls(e,this._parent):[e]}static \u0275fac=function(n){return new(n||i)(C(It,9),C(br,10),C(wr,10),C(ut,10),C(de,8),C(pi,8))};static \u0275dir=ee({type:i,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[Se([Sc]),ye,en]})}return i})(),ze=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275dir=ee({type:i,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return i})(),Ec={provide:ut,useExisting:Re(()=>kt),multi:!0},kt=(()=>{class i extends Kt{writeValue(e){let n=e??"";this.setProperty("value",n)}registerOnChange(e){this.onChange=n=>{e(n==""?null:parseFloat(n))}}static \u0275fac=(()=>{let e;return function(r){return(e||(e=vt(i)))(r||i)}})();static \u0275dir=ee({type:i,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(n,r){n&1&&g("input",function(c){return r.onChange(c.target.value)})("blur",function(){return r.onTouched()})},standalone:!1,features:[Se([Ec]),ye]})}return i})();var Tc={provide:ut,useExisting:Re(()=>Er),multi:!0},Er=(()=>{class i extends Kt{writeValue(e){this.setProperty("value",parseFloat(e))}registerOnChange(e){this.onChange=n=>{e(n==""?null:parseFloat(n))}}static \u0275fac=(()=>{let e;return function(r){return(e||(e=vt(i)))(r||i)}})();static \u0275dir=ee({type:i,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(n,r){n&1&&g("change",function(c){return r.onChange(c.target.value)})("input",function(c){return r.onChange(c.target.value)})("blur",function(){return r.onTouched()})},standalone:!1,features:[Se([Tc]),ye]})}return i})(),zs=new xe("");var Mc={provide:It,useExisting:Re(()=>De)},De=(()=>{class i extends It{callSetDisabledState;get submitted(){return ot(this._submittedReactive)}set submitted(e){this._submittedReactive.set(e)}_submitted=oe(()=>this._submittedReactive());_submittedReactive=A(!1);_oldForm;_onCollectionChange=()=>this._updateDomValue();directives=[];form=null;ngSubmit=new rt;constructor(e,n,r){super(),this.callSetDisabledState=r,this._setValidators(e),this._setAsyncValidators(n)}ngOnChanges(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(ui(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(e){let n=this.form.get(e.path);return _r(n,e,this.callSetDisabledState),n.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),n}getControl(e){return this.form.get(e.path)}removeControl(e){gs(e.control||null,e,!1),Cc(this.directives,e)}addFormGroup(e){this._setUpFormContainer(e)}removeFormGroup(e){this._cleanUpFormContainer(e)}getFormGroup(e){return this.form.get(e.path)}addFormArray(e){this._setUpFormContainer(e)}removeFormArray(e){this._cleanUpFormContainer(e)}getFormArray(e){return this.form.get(e.path)}updateModel(e,n){this.form.get(e.path).setValue(n)}onSubmit(e){return this._submittedReactive.set(!0),wc(this.form,this.directives),this.ngSubmit.emit(e),this.form._events.next(new hr(this.control)),e?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(e=void 0){this.form.reset(e),this._submittedReactive.set(!1),this.form._events.next(new fr(this.form))}_updateDomValue(){this.directives.forEach(e=>{let n=e.control,r=this.form.get(e.path);n!==r&&(gs(n||null,e),xc(r)&&(_r(r,e,this.callSetDisabledState),e.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(e){let n=this.form.get(e.path);vc(n,e),n.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(e){if(this.form){let n=this.form.get(e.path);n&&yc(n,e)&&n.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){Sr(this.form,this),this._oldForm&&ui(this._oldForm,this)}_checkFormPresent(){this.form}static \u0275fac=function(n){return new(n||i)(C(br,10),C(wr,10),C(pi,8))};static \u0275dir=ee({type:i,selectors:[["","formGroup",""]],hostBindings:function(n,r){n&1&&g("submit",function(c){return r.onSubmit(c)})("reset",function(){return r.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Se([Mc]),ye,en]})}return i})();var Ic={provide:At,useExisting:Re(()=>Fe)},Fe=(()=>{class i extends At{_ngModelWarningConfig;_added=!1;viewModel;control;name=null;set isDisabled(e){}model;update=new rt;static _ngModelWarningSentOnce=!1;_ngModelWarningSent=!1;constructor(e,n,r,o,c){super(),this._ngModelWarningConfig=c,this._parent=e,this._setValidators(n),this._setAsyncValidators(r),this.valueAccessor=Us(this,o)}ngOnChanges(e){this._added||this._setUpControl(),js(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}get path(){return Ls(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this.control=this.formDirective.addControl(this),this._added=!0}static \u0275fac=function(n){return new(n||i)(C(It,13),C(br,10),C(wr,10),C(ut,10),C(zs,8))};static \u0275dir=ee({type:i,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},standalone:!1,features:[Se([Ic]),ye,en]})}return i})(),Ac={provide:ut,useExisting:Re(()=>mt),multi:!0};function qs(i,t){return i==null?`${t}`:(t&&typeof t=="object"&&(t="Object"),`${i}: ${t}`.slice(0,50))}function kc(i){return i.split(":")[0]}var mt=(()=>{class i extends Kt{value;_optionMap=new Map;_idCounter=0;set compareWith(e){this._compareWith=e}_compareWith=Object.is;writeValue(e){this.value=e;let n=this._getOptionId(e),r=qs(n,e);this.setProperty("value",r)}registerOnChange(e){this.onChange=n=>{this.value=this._getOptionValue(n),e(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(let n of this._optionMap.keys())if(this._compareWith(this._optionMap.get(n),e))return n;return null}_getOptionValue(e){let n=kc(e);return this._optionMap.has(n)?this._optionMap.get(n):e}static \u0275fac=(()=>{let e;return function(r){return(e||(e=vt(i)))(r||i)}})();static \u0275dir=ee({type:i,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(n,r){n&1&&g("change",function(c){return r.onChange(c.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Se([Ac]),ye]})}return i})(),Jt=(()=>{class i{_element;_renderer;_select;id;constructor(e,n,r){this._element=e,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(e){this._select!=null&&(this._select._optionMap.set(this.id,e),this._setElementValue(qs(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(n){return new(n||i)(C(We),C(nn),C(mt,9))};static \u0275dir=ee({type:i,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return i})(),Pc={provide:ut,useExisting:Re(()=>Ws),multi:!0};function bs(i,t){return i==null?`${t}`:(typeof t=="string"&&(t=`'${t}'`),t&&typeof t=="object"&&(t="Object"),`${i}: ${t}`.slice(0,50))}function Dc(i){return i.split(":")[0]}var Ws=(()=>{class i extends Kt{value;_optionMap=new Map;_idCounter=0;set compareWith(e){this._compareWith=e}_compareWith=Object.is;writeValue(e){this.value=e;let n;if(Array.isArray(e)){let r=e.map(o=>this._getOptionId(o));n=(o,c)=>{o._setSelected(r.indexOf(c.toString())>-1)}}else n=(r,o)=>{r._setSelected(!1)};this._optionMap.forEach(n)}registerOnChange(e){this.onChange=n=>{let r=[],o=n.selectedOptions;if(o!==void 0){let c=o;for(let u=0;u<c.length;u++){let p=c[u],m=this._getOptionValue(p.value);r.push(m)}}else{let c=n.options;for(let u=0;u<c.length;u++){let p=c[u];if(p.selected){let m=this._getOptionValue(p.value);r.push(m)}}}this.value=r,e(r)}}_registerOption(e){let n=(this._idCounter++).toString();return this._optionMap.set(n,e),n}_getOptionId(e){for(let n of this._optionMap.keys())if(this._compareWith(this._optionMap.get(n)._value,e))return n;return null}_getOptionValue(e){let n=Dc(e);return this._optionMap.has(n)?this._optionMap.get(n)._value:e}static \u0275fac=(()=>{let e;return function(r){return(e||(e=vt(i)))(r||i)}})();static \u0275dir=ee({type:i,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(n,r){n&1&&g("change",function(c){return r.onChange(c.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Se([Pc]),ye]})}return i})(),Yt=(()=>{class i{_element;_renderer;_select;id;_value;constructor(e,n,r){this._element=e,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){this._select!=null&&(this._value=e,this._setElementValue(bs(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(bs(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(n){return new(n||i)(C(We),C(nn),C(Ws,9))};static \u0275dir=ee({type:i,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return i})();var Gs=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=ge({type:i});static \u0275inj=fe({})}return i})(),vr=class extends Qt{constructor(t,e,n){super(Cr(e),xr(n,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;at(t){return this.controls[this._adjustIndex(t)]}push(t,e={}){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(t,e,n={}){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:n.emitEvent})}removeAt(t,e={}){let n=this._adjustIndex(t);n<0&&(n=0),this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),this.controls.splice(n,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(t,e,n={}){let r=this._adjustIndex(t);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),e&&(this.controls.splice(r,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,e={}){Vs(this,!1,t),t.forEach((n,r)=>{Rs(this,!1,r),this.at(r).setValue(n,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){t!=null&&(t.forEach((n,r)=>{this.at(r)&&this.at(r).patchValue(n,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t=[],e={}){this._forEachChild((n,r)=>{n.reset(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e,this),this._updateTouched(e,this),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(t=>t.getRawValue())}clear(t={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:t.emitEvent}))}_adjustIndex(t){return t<0?t+this.length:t}_syncPendingControls(){let t=this.controls.reduce((e,n)=>n._syncPendingControls()?!0:e,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){this.controls.forEach((e,n)=>{t(e,n)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(e=>e.enabled&&t(e))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_allControlsDisabled(){for(let t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}_find(t){return this.at(t)??null}};function ws(i){return!!i&&(i.asyncValidators!==void 0||i.validators!==void 0||i.updateOn!==void 0)}var qe=(()=>{class i{useNonNullable=!1;get nonNullable(){let e=new i;return e.useNonNullable=!0,e}group(e,n=null){let r=this._reduceControls(e),o={};return ws(n)?o=n:n!==null&&(o.validators=n.validator,o.asyncValidators=n.asyncValidator),new ci(r,o)}record(e,n=null){let r=this._reduceControls(e);return new gr(r,n)}control(e,n,r){let o={};return this.useNonNullable?(ws(n)?o=n:(o.validators=n,o.asyncValidators=r),new bn(e,Z(W({},o),{nonNullable:!0}))):new bn(e,n,r)}array(e,n,r){let o=e.map(c=>this._createControl(c));return new vr(o,n,r)}_reduceControls(e){let n={};return Object.keys(e).forEach(r=>{n[r]=this._createControl(e[r])}),n}_createControl(e){if(e instanceof bn)return e;if(e instanceof Qt)return e;if(Array.isArray(e)){let n=e[0],r=e.length>1?e[1]:null,o=e.length>2?e[2]:null;return this.control(n,r,o)}else return this.control(e)}static \u0275fac=function(n){return new(n||i)};static \u0275prov=z({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var pt=(()=>{class i{static withConfig(e){return{ngModule:i,providers:[{provide:pi,useValue:e.callSetDisabledState??hi}]}}static \u0275fac=function(n){return new(n||i)};static \u0275mod=ge({type:i});static \u0275inj=fe({imports:[Gs]})}return i})(),Te=(()=>{class i{static withConfig(e){return{ngModule:i,providers:[{provide:zs,useValue:e.warnOnNgModelWithFormControl??"always"},{provide:pi,useValue:e.callSetDisabledState??hi}]}}static \u0275fac=function(n){return new(n||i)};static \u0275mod=ge({type:i});static \u0275inj=fe({imports:[Gs]})}return i})();var Zt=class i{constructor(t){this.supabaseService=t;this.supabase=this.supabaseService.GetClient()}supabase;async loadQuestions(){let{data:t,error:e}=await this.supabase.rpc("get_random_activequestions");if(e)throw console.error("Error loading questions: ",e),e;return t}async canLoadCheckInQuestions(){let t=this.supabaseService.user()?.id;if(!t)return console.error("User not authenticated, cannot check check-in status."),!1;let{data:e,error:n}=await this.supabase.rpc("can_checkin",{user_id:t});return n?(console.error("Error in RPC can_checkin:",n),!1):e===!0}async getEmotionCheckInResultForDate(t){let e=this.supabaseService.user()?.id;if(!e)return console.error("User not authenticated"),null;let n=new Date(t.setHours(0,0,0,0)).toISOString(),r=new Date(t.setHours(23,59,59,999)).toISOString(),{data:o,error:c}=await this.supabase.from("answers").select("analysis").eq("user_id",e).gte("created_at",n).lte("created_at",r).order("created_at",{ascending:!1}).limit(1).single();return c?c.code==="PGRST116"?(console.log(`No check-in found for date: ${t.toDateString()}`),null):(console.error("Error fetching check-in result for date:",c),null):o?o.analysis:null}async submitUserCheckIn(t){let e=this.supabaseService.user()?.id;if(!e)return{error:new Error("User not authenticated")};let{error:n}=await this.supabase.rpc("perform_checkin",{in_user_id:e,in_answers:t.answers,in_analysis:t.analysis});return{error:n}}async adminLoadQuestions(){let{data:t,error:e}=await this.supabase.from("adminquestions").select("*");if(e)throw console.error("Error loading questions: ",e),e;return t}async adminSaveQuestions(t){let e=null;for(let n of t.filter(r=>r.isModified))if(n.question_id){let{data:r,error:o}=await this.supabase.from("adminquestions").update({question_data:n.question_data,active:n.active}).eq("question_id",n.question_id).select().single();if(o){console.error("Error updating question:",o),e=o;break}else n.updated_at=r.updated_at,n.isModified=!1}else{let{data:r,error:o}=await this.supabase.from("adminquestions").insert([{question_data:n.question_data,active:n.active}]).select().single();if(o){console.error("Error inserting question:",o),e=o;break}else n.question_id=r.question_id,n.created_at=r.created_at,n.updated_at=r.updated_at,n.isModified=!1}return{error:e}}async deleteQuestion(t){let{error:e}=await this.supabase.from("adminquestions").delete().eq("question_id",t.question_id);return{error:e}}static \u0275fac=function(e){return new(e||i)(q(G))};static \u0275prov=z({token:i,factory:i.\u0275fac,providedIn:"root"})};var Fc=(i,t)=>({"alert-success":i,"alert-danger":t});function Oc(i,t){if(i&1&&(a(0,"div",18),l(1),s()),i&2){let e=h();f("ngClass",Dn(2,Fc,e.messageType==="success",e.messageType==="error")),d(),V(" ",e.message," ")}}function Nc(i,t){if(i&1){let e=j();Ge(0),a(1,"input",27),R("ngModelChange",function(r){_(e);let o=h().$implicit;return N(o.choicesInput,r)||(o.choicesInput=r),v(r)}),g("change",function(){_(e);let r=h().$implicit,o=h();return v(o.updateChoices(r))}),s(),a(2,"div",28),l(3,'e.g., "Option A, Option B, Option C"'),s(),He()}if(i&2){let e=h().$implicit;d(),O("ngModel",e.choicesInput)}}function Rc(i,t){if(i&1){let e=j();a(0,"tr")(1,"td")(2,"select",19),R("ngModelChange",function(r){let o=_(e).$implicit;return N(o.question_data.question_type,r)||(o.question_data.question_type=r),v(r)}),g("change",function(){let r=_(e).$implicit,o=h();return v(o.onQuestionChange(r))}),a(3,"option",9),l(4,"Fill"),s(),a(5,"option",10),l(6,"Multiple"),s(),a(7,"option",11),l(8,"Select One"),s()()(),a(9,"td")(10,"input",20),R("ngModelChange",function(r){let o=_(e).$implicit;return N(o.question_data.question_icon,r)||(o.question_data.question_icon=r),v(r)}),g("change",function(){let r=_(e).$implicit,o=h();return v(o.onQuestionChange(r))}),s()(),a(11,"td")(12,"input",21),R("ngModelChange",function(r){let o=_(e).$implicit;return N(o.question_data.question_title,r)||(o.question_data.question_title=r),v(r)}),g("change",function(){let r=_(e).$implicit,o=h();return v(o.onQuestionChange(r))}),s()(),a(13,"td")(14,"textarea",22),R("ngModelChange",function(r){let o=_(e).$implicit;return N(o.question_data.question,r)||(o.question_data.question=r),v(r)}),g("change",function(){let r=_(e).$implicit,o=h();return v(o.onQuestionChange(r))}),s()(),a(15,"td"),b(16,Nc,4,1,"ng-container",23),s(),a(17,"td")(18,"input",24),R("ngModelChange",function(r){let o=_(e).$implicit;return N(o.question_data.placeholder,r)||(o.question_data.placeholder=r),v(r)}),g("change",function(){let r=_(e).$implicit,o=h();return v(o.onQuestionChange(r))}),s()(),a(19,"td")(20,"div",25)(21,"input",26),R("ngModelChange",function(r){let o=_(e).$implicit;return N(o.active,r)||(o.active=r),v(r)}),g("change",function(){let r=_(e).$implicit,o=h();return v(o.onQuestionChange(r))}),s()()(),a(22,"td"),l(23),yt(24,"date"),s()()}if(i&2){let e=t.$implicit;d(2),O("ngModel",e.question_data.question_type),d(8),O("ngModel",e.question_data.question_icon),d(2),O("ngModel",e.question_data.question_title),d(2),O("ngModel",e.question_data.question),d(2),f("ngIf",e.question_data.question_type!=="fill"),d(2),O("ngModel",e.question_data.placeholder),d(3),O("ngModel",e.active),d(2),y(sn(24,8,e.updated_at,"short"))}}function Vc(i,t){if(i&1){let e=j();a(0,"div",29)(1,"input",30),R("ngModelChange",function(r){_(e);let o=h();return N(o.newQuestionChoices,r)||(o.newQuestionChoices=r),v(r)}),s()()}if(i&2){let e=h();d(),O("ngModel",e.newQuestionChoices)}}var fi=class i{constructor(t,e){this.cdr=t;this.supabaseService=e}questions=[];newQuestionText="";newQuestionType="fill";newQuestionChoices="";message="";messageType="success";async ngOnInit(){let t=await this.supabaseService.adminLoadQuestions();this.questions=t.map(e=>Z(W({},e),{choicesInput:e.question_data.choices?.join(", ")||""})),this.cdr.markForCheck()}onQuestionChange(t){t.isModified=!0}updateChoices(t){let e=t.choicesInput??"";t.question_data.choices=e.split(",").map(n=>n.trim()).filter(n=>n),t.isModified=!0}addQuestion(){if(!this.newQuestionText.trim())return;let t={question_type:this.newQuestionType,question:this.newQuestionText.trim(),placeholder:this.newQuestionText.trim()};if(this.newQuestionType!=="fill"){let e=this.newQuestionChoices.split(",").map(n=>n.trim()).filter(n=>n);t.choices=e}this.questions.push({question_data:t,choicesInput:this.newQuestionChoices,active:!0,isModified:!0}),this.newQuestionText="",this.newQuestionChoices="",this.newQuestionType="fill",this.cdr.detectChanges()}async saveChanges(){let{error:t}=await this.supabaseService.adminSaveQuestions(this.questions);t?this.showMessage("Error saving questions","error"):this.showMessage("Questions saved successfully","success"),this.cdr.detectChanges()}async deleteQuestion(t){if(!t.question_id){this.questions=this.questions.filter(n=>n!==t),this.showMessage("Question removed locally","success"),this.cdr.markForCheck();return}let{error:e}=await this.supabaseService.deleteQuestion(t);e?this.showMessage("Error deleting question","error"):(this.questions=this.questions.filter(n=>n.question_id!==t.question_id),this.showMessage("Question deleted successfully","success")),this.cdr.markForCheck()}showMessage(t,e){this.message=t,this.messageType=e,this.cdr.markForCheck(),setTimeout(()=>{this.message="",this.cdr.markForCheck()},4e3)}hasChanges(){return this.questions.some(t=>t.isModified)}static \u0275fac=function(e){return new(e||i)(C(de),C(Zt))};static \u0275cmp=K({type:i,selectors:[["app-admin-emotion-dashboard"]],decls:53,vars:6,consts:[[1,"container-fluid","mt-4","p-5"],["class","alert",3,"ngClass",4,"ngIf"],[1,"table","mt-5"],[4,"ngFor","ngForOf"],["href","https://fonts.google.com/icons","target","_blank"],[1,"mt-4"],[1,"row","g-3","align-items-center","mb-3"],[1,"col-md-3"],[1,"form-select",3,"ngModelChange","ngModel"],["value","fill"],["value","multiple"],["value","select-one"],[1,"col-md-5"],["type","text","placeholder","Enter question text",1,"form-control",3,"ngModelChange","ngModel"],["class","col-md-4",4,"ngIf"],[1,"d-flex","justify-content-between"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-success",3,"click","disabled"],[1,"alert",3,"ngClass"],[1,"form-select",3,"ngModelChange","change","ngModel"],["type","text","placeholder","Enter icon URL or name",1,"form-control",3,"ngModelChange","change","ngModel"],["type","text","placeholder","Enter question title",1,"form-control",3,"ngModelChange","change","ngModel"],["type","text",1,"form-control",3,"ngModelChange","change","ngModel"],[4,"ngIf"],["type","text","placeholder","Enter placeholder text",1,"form-control",3,"ngModelChange","change","ngModel"],[1,"form-check","form-switch"],["type","checkbox",1,"form-check-input",3,"ngModelChange","change","ngModel"],["type","text","placeholder","Comma-separated choices",1,"form-control","mb-1",3,"ngModelChange","change","ngModel"],[1,"text-muted","small"],[1,"col-md-4"],["type","text","placeholder","Comma-separated choices",1,"form-control",3,"ngModelChange","ngModel"]],template:function(e,n){e&1&&(a(0,"div",0),b(1,Oc,2,5,"div",1),a(2,"h1"),l(3,"Admin Emotion Question Dashboard"),s(),a(4,"table",2)(5,"thead")(6,"tr")(7,"th"),l(8,"Type"),s(),a(9,"th"),l(10,"Question Icon"),s(),a(11,"th"),l(12,"Question Title"),s(),a(13,"th"),l(14,"Question Text"),s(),a(15,"th"),l(16,"Choices"),s(),a(17,"th"),l(18,"Placeholder"),s(),a(19,"th"),l(20,"Active"),s(),a(21,"th"),l(22,"Last Updated"),s()()(),a(23,"tbody"),b(24,Rc,25,11,"tr",3),s()(),a(25,"label"),l(26,"For icons, go to this website: "),a(27,"a",4),l(28,"https://fonts.google.com/icons"),s(),l(29,". "),T(30,"br"),l(31,"Search for favourite icon. When you click your icon, you will look for the name of the icon and "),T(32,"br"),l(33," put it into the space"),s(),a(34,"h4",5),l(35,"Add New Question"),s(),a(36,"div",6)(37,"div",7)(38,"select",8),R("ngModelChange",function(o){return N(n.newQuestionType,o)||(n.newQuestionType=o),o}),a(39,"option",9),l(40,"Fill"),s(),a(41,"option",10),l(42,"Multiple"),s(),a(43,"option",11),l(44,"Select One"),s()()(),a(45,"div",12)(46,"input",13),R("ngModelChange",function(o){return N(n.newQuestionText,o)||(n.newQuestionText=o),o}),s()(),b(47,Vc,2,1,"div",14),s(),a(48,"div",15)(49,"button",16),g("click",function(){return n.addQuestion()}),l(50,"Add Question"),s(),a(51,"button",17),g("click",function(){return n.saveChanges()}),l(52,"Save Changes"),s()()()),e&2&&(d(),f("ngIf",n.message),d(23),f("ngForOf",n.questions),d(14),O("ngModel",n.newQuestionType),d(8),O("ngModel",n.newQuestionText),d(),f("ngIf",n.newQuestionType!=="fill"),d(4),f("disabled",!n.hasChanges()))},dependencies:[pt,Jt,Yt,ie,yr,mt,le,et,X,qt,Ve,te,po],styles:[".container[_ngcontent-%COMP%]{max-width:800px;margin:auto}.question-row[_ngcontent-%COMP%]{position:relative}.delete-button[_ngcontent-%COMP%]{display:none;position:absolute;right:10px;top:50%;transform:translateY(-50%)}.question-row[_ngcontent-%COMP%]:hover   .delete-button[_ngcontent-%COMP%]{display:block}.alert[_ngcontent-%COMP%]{padding:10px 20px;margin-bottom:15px;border-radius:4px;text-align:center}.table[_ngcontent-%COMP%]{--bs-table-bg: transparent}"]})};var Ir=(i,t)=>t.some(e=>i instanceof e),$s,Qs;function Lc(){return $s||($s=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Bc(){return Qs||(Qs=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var Ar=new WeakMap,Tr=new WeakMap,gi=new WeakMap;function jc(i){let t=new Promise((e,n)=>{let r=()=>{i.removeEventListener("success",o),i.removeEventListener("error",c)},o=()=>{e(Pt(i.result)),r()},c=()=>{n(i.error),r()};i.addEventListener("success",o),i.addEventListener("error",c)});return gi.set(t,i),t}function Uc(i){if(Ar.has(i))return;let t=new Promise((e,n)=>{let r=()=>{i.removeEventListener("complete",o),i.removeEventListener("error",c),i.removeEventListener("abort",c)},o=()=>{e(),r()},c=()=>{n(i.error||new DOMException("AbortError","AbortError")),r()};i.addEventListener("complete",o),i.addEventListener("error",c),i.addEventListener("abort",c)});Ar.set(i,t)}var kr={get(i,t,e){if(i instanceof IDBTransaction){if(t==="done")return Ar.get(i);if(t==="store")return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return Pt(i[t])},set(i,t,e){return i[t]=e,!0},has(i,t){return i instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in i}};function Zs(i){kr=i(kr)}function zc(i){return Bc().includes(i)?function(...t){return i.apply(Pr(this),t),Pt(this.request)}:function(...t){return Pt(i.apply(Pr(this),t))}}function qc(i){return typeof i=="function"?zc(i):(i instanceof IDBTransaction&&Uc(i),Ir(i,Lc())?new Proxy(i,kr):i)}function Pt(i){if(i instanceof IDBRequest)return jc(i);if(Tr.has(i))return Tr.get(i);let t=qc(i);return t!==i&&(Tr.set(i,t),gi.set(t,i)),t}var Pr=i=>gi.get(i);function wn(i,t,{blocked:e,upgrade:n,blocking:r,terminated:o}={}){let c=indexedDB.open(i,t),u=Pt(c);return n&&c.addEventListener("upgradeneeded",p=>{n(Pt(c.result),p.oldVersion,p.newVersion,Pt(c.transaction),p)}),e&&c.addEventListener("blocked",p=>e(p.oldVersion,p.newVersion,p)),u.then(p=>{o&&p.addEventListener("close",()=>o()),r&&p.addEventListener("versionchange",m=>r(m.oldVersion,m.newVersion,m))}).catch(()=>{}),u}var Wc=["get","getKey","getAll","getAllKeys","count"],Gc=["put","add","delete","clear"],Mr=new Map;function Ks(i,t){if(!(i instanceof IDBDatabase&&!(t in i)&&typeof t=="string"))return;if(Mr.get(t))return Mr.get(t);let e=t.replace(/FromIndex$/,""),n=t!==e,r=Gc.includes(e);if(!(e in(n?IDBIndex:IDBObjectStore).prototype)||!(r||Wc.includes(e)))return;let o=async function(c,...u){let p=this.transaction(c,r?"readwrite":"readonly"),m=p.store;return n&&(m=m.index(u.shift())),(await Promise.all([m[e](...u),r&&p.done]))[0]};return Mr.set(t,o),o}Zs(i=>Z(W({},i),{get:(t,e,n)=>Ks(t,e)||i.get(t,e,n),has:(t,e)=>!!Ks(t,e)||i.has(t,e)}));var Hc=["continue","continuePrimaryKey","advance"],Js={},Dr=new WeakMap,Xs=new WeakMap,$c={get(i,t){if(!Hc.includes(t))return i[t];let e=Js[t];return e||(e=Js[t]=function(...n){Dr.set(this,Xs.get(this)[t](...n))}),e}};async function*Qc(...i){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...i)),!t)return;t=t;let e=new Proxy(t,$c);for(Xs.set(e,t),gi.set(e,Pr(t));t;)yield e,t=await(Dr.get(e)||t.continue()),Dr.delete(e)}function Ys(i,t){return t===Symbol.asyncIterator&&Ir(i,[IDBIndex,IDBObjectStore,IDBCursor])||t==="iterate"&&Ir(i,[IDBIndex,IDBObjectStore])}Zs(i=>Z(W({},i),{get(t,e,n){return Ys(t,e)?Qc:i.get(t,e,n)},has(t,e){return Ys(t,e)||i.has(t,e)}}));var Me=class i{constructor(t,e){this.supabaseService=t;this.platformId=e;this.supabase=this.supabaseService.GetClient()}supabase;ngOnInit(){}async getUserTradeAccounts(){let t=this.supabaseService.user();if(!t)throw new Error("User not authenticated");let e="tradeaccount",n=!1,r=null;if(typeof window<"u"){n=sessionStorage.getItem(`${e}_refresh`)==="yes";let u=sessionStorage.getItem(e);if(u)try{r=JSON.parse(u)}catch(p){console.error("Error parsing cached trade accounts:",p),r=null}}if(!n&&r)return r;let{data:o,error:c}=await this.supabase.from(e).select("*").eq("user_id",t.id);if(c)throw console.error("Error fetching trade accounts:",c),c;return typeof window<"u"&&(sessionStorage.setItem(e,JSON.stringify(o)),sessionStorage.removeItem(`${e}_refresh`)),o||[]}async addTradeAccount(t){let e=this.supabaseService.user();if(!e)throw new Error("User not authenticated");let m=t,{track_pl:n,include_in_analytics:r,trading_instruments:o}=m,c=Xt(m,["track_pl","include_in_analytics","trading_instruments"]),u={track_pl:n,include_in_analytics:r,trading_instruments:o},{error:p}=await this.supabase.from("tradeaccount").insert([Z(W({},c),{user_id:e.id,metadata:u})]);return p?(console.error("Failed to add trade account:",p),!1):(sessionStorage.setItem("tradeaccount_refresh","yes"),!0)}async editTradeAccount(t,e){let n=this.supabaseService.user();if(!n)throw new Error("User not authenticated");let w=e,{track_pl:r,include_in_analytics:o,trading_instruments:c}=w,u=Xt(w,["track_pl","include_in_analytics","trading_instruments"]),p={track_pl:r,include_in_analytics:o,trading_instruments:c},{error:m}=await this.supabase.from("tradeaccount").update(Z(W({},u),{metadata:p})).eq("account_id",t).eq("user_id",n.id);return m?(console.error("Failed to update trade account:",m),!1):(sessionStorage.setItem("tradeaccount_refresh","yes"),!0)}async removeTradeAccount(t){let e=this.supabaseService.user();if(!e)throw new Error("User not authenticated");let{error:n}=await this.supabase.from("tradejournal").delete().eq("trade_account_id",t).eq("userid",e.id);if(n)return console.error("Failed to delete associated trade logs:",n),!1;let{error:r}=await this.supabase.from("tradeaccount").delete().eq("account_id",t).eq("user_id",e.id);return r?(console.error("Failed to remove trade account:",r),!1):(typeof window<"u"&&(sessionStorage.setItem("tradeaccount_refresh","yes"),sessionStorage.setItem(`tradejournal_${t}_refresh`,"yes")),!0)}async getProfile(){console.log("getting profile picture");let t=this.supabaseService.user();if(!t)throw new Error("User not authenticated");return this.supabase.from("usersaccount").select("*").eq("user_id",t.id).single()}async createProfile(t){if(!this.supabaseService.user())throw new Error("User not authenticated");return this.supabase.from("usersaccount").insert(t)}async updateProfile(t){let e=this.supabaseService.user();if(!e)throw new Error("User not authenticated");return this.supabase.from("usersaccount").update(t).eq("user_id",e.id)}async uploadProfilePicture(t){let e=this.supabaseService.user();if(!e)throw new Error("User not authenticated");let n=t.name.split(".").pop(),r=`${e.id}/profile.${n}`;await(await wn("profile-cache",1,{upgrade(u){u.createObjectStore("pictures")}})).delete("pictures",r);let{error:c}=await this.supabase.storage.from("user-profile-pictures").upload(r,t,{upsert:!0});return c?null:r}async cacheProfilePictureBlob(t,e){await(await wn("profile-cache",1,{upgrade(r){r.createObjectStore("pictures")}})).put("pictures",e,t)}async getCachedProfilePictureBlobUrl(t){if(!t)return null;let e=await wn("profile-cache",1,{upgrade(u){u.createObjectStore("pictures")}}),n=await e.get("pictures",t);if(n)return URL.createObjectURL(n);let r=await this.getPublicUrl(t);if(!r)return null;let o=await fetch(r);if(!o.ok)return null;let c=await o.blob();return await e.put("pictures",c,t),URL.createObjectURL(c)}clearCachedProfilePictureBlobUrl(){if(Je(this.platformId)){let t=sessionStorage.getItem("profile_picture_blob_url");t&&(URL.revokeObjectURL(t),sessionStorage.removeItem("profile_picture_blob_url"))}}async deleteProfilePicture(){let{data:{user:t}}=await this.supabase.auth.getUser();if(!t)return;let e=`${t.id}/profile.png`,n=`${t.id}/profile.jpg`,r=`${t.id}/profile.jpeg`,o=`${t.id}/profile.webp`;await this.supabase.storage.from("user-profile-pictures").remove([e,n,r,o]);let c=await wn("profile-cache",1,{upgrade(u){u.createObjectStore("pictures")}});await c.delete("pictures",e),await c.delete("pictures",n),await c.delete("pictures",r),await c.delete("pictures",o)}async getPublicUrl(t){let{data:e}=await this.supabase.storage.from("user-profile-pictures").createSignedUrl(t,60);return e?.signedUrl??null}static \u0275fac=function(e){return new(e||i)(q(G),q(Rt))};static \u0275prov=z({token:i,factory:i.\u0275fac,providedIn:"root"})};var ht=class i{constructor(t,e,n,r){this.supabaseService=t;this.supabaseAccountService=e;this.router=n;this.document=r;this.supabase=this.supabaseService.GetClient(),this.rootDomainName="https://app.tradingrehab.io/auth/update-password"}supabase;rootDomainName;async signIn(t,e){try{let{error:n}=await this.supabase.auth.signInWithPassword({email:t,password:e});if(n)throw n;return{success:!0}}catch(n){return console.error("Sign in error:",n),{success:!1,error:n}}}async logout(t=!0){try{await this.supabase.auth.signOut()}catch(e){console.error("Sign out error:",e)}this.supabaseService.updateSignalsFromSession(null),this.supabaseAccountService.clearCachedProfilePictureBlobUrl(),Je(this.supabaseService.platformId)&&(sessionStorage.clear(),localStorage.clear()),t&&this.router.navigate(["/"])}async signUp(t,e,n,r){let{error:o}=await this.supabase.auth.signUp({email:t,password:e,options:{data:{firstname:n,lastname:r}}});return o?{success:!1,error:o}:{success:!0}}async requestPasswordReset(t){let{error:e}=await this.supabase.auth.resetPasswordForEmail(t,{redirectTo:"https://app.tradingrehab.io/auth/update-password"});return e?{success:!1,error:e}:{success:!0}}async updatePassword(t){let{error:e}=await this.supabase.auth.updateUser({password:t});return e?{success:!1,error:e}:{success:!0}}static \u0275fac=function(e){return new(e||i)(q(G),q(Me),q(ne),q(Ke))};static \u0275prov=z({token:i,factory:i.\u0275fac,providedIn:"root"})};function Kc(i,t){if(i&1&&(a(0,"div",13),l(1),s()),i&2){let e=h();d(),V(" ",e.errorMessage," ")}}function Jc(i,t){i&1&&(a(0,"div",28),l(1," A valid email is required. "),s())}function Yc(i,t){i&1&&(a(0,"div",28),l(1," Password must be at least 6 characters. "),s())}function Zc(i,t){if(i&1){let e=j();a(0,"form",14),g("ngSubmit",function(){_(e);let r=h();return v(r.onSubmit())}),a(1,"div",15)(2,"label",16),l(3,"Email"),s(),T(4,"input",17),b(5,Jc,2,0,"div",18),s(),a(6,"div",15)(7,"label",19),l(8,"Password"),s(),T(9,"input",20),b(10,Yc,2,0,"div",18),a(11,"div",21)(12,"a",22),l(13,"Forgot password?"),s()()(),a(14,"div",23)(15,"button",24),l(16,"Continue"),s()(),a(17,"div",25)(18,"p",26),l(19,"Don't have an account? "),a(20,"a",27),g("click",function(){_(e);let r=h();return v(r.setActiveTab("signup"))}),l(21,"Sign up"),s()()()()}if(i&2){let e,n,r=h();f("formGroup",r.signinForm),d(5),f("ngIf",((e=r.signinForm.get("email"))==null?null:e.invalid)&&((e=r.signinForm.get("email"))==null?null:e.touched)),d(5),f("ngIf",((n=r.signinForm.get("password"))==null?null:n.invalid)&&((n=r.signinForm.get("password"))==null?null:n.touched)),d(5),f("disabled",r.signinForm.invalid)}}function Xc(i,t){i&1&&(a(0,"small",43),l(1," First name is required "),s())}function ed(i,t){i&1&&(a(0,"small",43),l(1," Last name is required "),s())}function td(i,t){i&1&&(a(0,"small",43),l(1," Valid email is required "),s())}function nd(i,t){i&1&&(a(0,"small",43),l(1," Password must be at least 6 characters "),s())}function id(i,t){i&1&&(a(0,"small",43),l(1," Passwords do not match "),s())}function rd(i,t){if(i&1){let e=j();a(0,"form",14),g("ngSubmit",function(){_(e);let r=h();return v(r.onSignupSubmit())}),a(1,"div",29)(2,"div",30)(3,"label",31),l(4,"First Name"),s(),T(5,"input",32),b(6,Xc,2,0,"small",33),s(),a(7,"div",30)(8,"label",34),l(9,"Last Name"),s(),T(10,"input",35),b(11,ed,2,0,"small",33),s()(),a(12,"div",15)(13,"label",36),l(14,"Email"),s(),T(15,"input",37),b(16,td,2,0,"small",33),s(),a(17,"div",15)(18,"label",38),l(19,"Password"),s(),T(20,"input",39),b(21,nd,2,0,"small",33),s(),a(22,"div",15)(23,"label",40),l(24,"Confirm Password"),s(),T(25,"input",41),b(26,id,2,0,"small",33),s(),a(27,"div",21)(28,"a",22),l(29,"Forgot password?"),s()(),a(30,"div",23)(31,"button",24),l(32,"Create Account"),s()(),a(33,"div",25)(34,"p",26),l(35,"Already have an account? "),a(36,"a",42),g("click",function(){_(e);let r=h();return v(r.setActiveTab("login"))}),l(37,"Login"),s()()()()}if(i&2){let e,n,r,o,c,u=h();f("formGroup",u.signupForm),d(6),f("ngIf",((e=u.signupForm.get("firstname"))==null?null:e.invalid)&&((e=u.signupForm.get("firstname"))==null?null:e.touched)),d(5),f("ngIf",((n=u.signupForm.get("lastname"))==null?null:n.invalid)&&((n=u.signupForm.get("lastname"))==null?null:n.touched)),d(5),f("ngIf",((r=u.signupForm.get("email"))==null?null:r.invalid)&&((r=u.signupForm.get("email"))==null?null:r.touched)),d(5),f("ngIf",((o=u.signupForm.get("password"))==null?null:o.invalid)&&((o=u.signupForm.get("password"))==null?null:o.touched)),d(5),f("ngIf",u.signupForm.hasError("mismatch")&&((c=u.signupForm.get("confirmPassword"))==null?null:c.touched)),d(5),f("disabled",u.signupForm.invalid)}}var _i=class i{constructor(t,e,n,r,o,c,u){this.fb=t;this.router=e;this.route=n;this.cdr=r;this.supabaseService=o;this.supabaseAuthService=c;this.supabaseAccountService=u;this.signinForm=this.fb.group({email:["",[H.required,H.email]],password:["",[H.required,H.minLength(6)]]}),this.signupForm=this.fb.group({firstname:["",H.required],lastname:["",H.required],email:["",[H.required,H.email]],password:["",[H.required,H.minLength(6)]],confirmPassword:["",H.required]},{validators:this.passwordMatchValidator})}activeTab="login";signinForm;signupForm;errorMessage=null;ngOnInit(){this.route.queryParams.subscribe(t=>{t.mode==="signup"&&(this.activeTab="signup")})}passwordMatchValidator(t){let e=t.get("password")?.value,n=t.get("confirmPassword")?.value;return e===n?null:{mismatch:!0}}setActiveTab(t){this.activeTab=t,this.errorMessage=null}async onSubmit(){if(this.signinForm.invalid){this.signinForm.markAllAsTouched();return}let{email:t,password:e}=this.signinForm.getRawValue();try{if(await this.supabaseAuthService.signIn(t,e),!this.supabaseService.currentUsername()){this.errorMessage="Login failed. Please try again.",this.cdr.markForCheck();return}this.signinForm.reset();let n=this.route.snapshot.queryParams.returnUrl||"/home";this.router.navigateByUrl(n),this.cdr.markForCheck()}catch(n){this.errorMessage=n.message||"An unexpected error occurred.",this.cdr.markForCheck()}}async onSignupSubmit(){if(this.signupForm.invalid){this.errorMessage="Please fill them correctly.",this.signupForm.markAllAsTouched(),this.cdr.markForCheck();return}let{email:t,password:e,firstname:n,lastname:r}=this.signupForm.getRawValue();try{let{success:o,error:c}=await this.supabaseAuthService.signUp(t,e,n,r);if(!o){this.errorMessage=c?.message||"Signup failed.",this.cdr.markForCheck();return}let u=this.supabaseService.user();if(!u){this.errorMessage="User not found after signup.",this.cdr.markForCheck();return}await this.supabaseAccountService.createProfile({user_id:u.id,firstname:n,lastname:r,email:t,phone:null,profile_picture_url:null,updated_at:new Date().toISOString(),preferences:{},metadata:{}}),this.signupForm.reset(),this.router.navigateByUrl("/home"),this.cdr.markForCheck()}catch(o){this.errorMessage=o.message||"An unexpected error occurred.",this.cdr.markForCheck()}}static \u0275fac=function(e){return new(e||i)(C(qe),C(ne),C(st),C(de),C(G),C(ht),C(Me))};static \u0275cmp=K({type:i,selectors:[["app-login-signup"]],decls:20,vars:7,consts:[[1,"auth-container"],[1,"auth-card"],[1,"text-center","mb-4"],[1,"logo-circle","mx-auto"],["src","/tr_logo.svg","alt","Logo",1,"img-fluid"],[1,"brand-name","mt-3"],[1,"brand-tagline"],[1,"auth-tabs","d-flex","justify-content-center","mb-4"],[1,"tabs-container"],[1,"tab",3,"click"],[1,"mx-2","tab-separator"],["class","alert alert-danger mb-3",4,"ngIf"],["class","auth-form",3,"formGroup","ngSubmit",4,"ngIf"],[1,"alert","alert-danger","mb-3"],[1,"auth-form",3,"ngSubmit","formGroup"],[1,"mb-3"],["for","email",1,"form-label"],["type","email","id","email","formControlName","email","placeholder","Enter your email",1,"form-control"],["class","text-danger small mt-1",4,"ngIf"],["for","password",1,"form-label"],["type","password","id","password","formControlName","password","placeholder","Enter your password",1,"form-control"],[1,"d-flex","justify-content-end","mt-2"],["routerLink","/auth/forgot-password",1,"forgot-link"],[1,"d-grid","gap-2","mt-4"],["type","submit",1,"btn","btn-tr","btn-primary","btn-md",3,"disabled"],[1,"text-center","mt-4"],[1,"mb-0"],["href","javascript:void(0)",1,"signup-link",3,"click"],[1,"text-danger","small","mt-1"],[1,"row"],[1,"col-md-6","mb-3"],["for","firstname",1,"form-label"],["type","text","id","firstname","formControlName","firstname","placeholder","First name",1,"form-control"],["class","text-danger",4,"ngIf"],["for","lastname",1,"form-label"],["type","text","id","lastname","formControlName","lastname","placeholder","Last name",1,"form-control"],["for","signup-email",1,"form-label"],["type","email","id","signup-email","formControlName","email","placeholder","Enter your email",1,"form-control"],["for","signup-password",1,"form-label"],["type","password","id","signup-password","formControlName","password","placeholder","Create a password",1,"form-control"],["for","confirmPassword",1,"form-label"],["type","password","id","confirmPassword","formControlName","confirmPassword","placeholder","Confirm your password",1,"form-control"],["href","javascript:void(0)",1,"login-link",3,"click"],[1,"text-danger"]],template:function(e,n){e&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),T(4,"img",4),s(),a(5,"h2",5),l(6,"TRADING REHAB"),s(),a(7,"p",6),l(8,"Where Disciplined Trading Begins"),s()(),a(9,"div",7)(10,"div",8)(11,"span",9),g("click",function(){return n.setActiveTab("login")}),l(12,"Login"),s(),a(13,"span",10),l(14,"\u2022"),s(),a(15,"span",9),g("click",function(){return n.setActiveTab("signup")}),l(16,"Sign Up"),s()()(),b(17,Kc,2,1,"div",11)(18,Zc,22,4,"form",12)(19,rd,38,7,"form",12),s()()),e&2&&(d(11),D("active",n.activeTab==="login"),d(4),D("active",n.activeTab==="signup"),d(2),f("ngIf",n.errorMessage),d(),f("ngIf",n.activeTab==="login"),d(),f("ngIf",n.activeTab==="signup"))},dependencies:[X,te,Te,ze,ie,le,Ue,De,Fe,_e],styles:['.auth-container[_ngcontent-%COMP%]{min-height:100dvh;display:flex;align-items:center;justify-content:center}.auth-card[_ngcontent-%COMP%]{background-color:transparent;border-radius:12px;width:100%;max-width:450px;padding:30px}.logo-circle[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:50%;background-color:transparent;position:relative;display:flex;align-items:center;justify-content:center;margin:0 auto}.dots-circle[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:50%;position:relative;background-image:radial-gradient(circle,#5046e5 3px,transparent 3px);background-size:15px 15px;transform:rotate(45deg)}.brand-name[_ngcontent-%COMP%]{font-weight:700;font-size:24px;margin-bottom:5px;letter-spacing:.5px}.brand-tagline[_ngcontent-%COMP%]{color:#666;font-size:14px;margin:0}.tabs-container[_ngcontent-%COMP%]{display:inline-flex;align-items:center;border-bottom:1px solid #eee;padding-bottom:5px}.tab[_ngcontent-%COMP%]{padding:8px 15px;cursor:pointer;color:#888;font-weight:500;font-size:16px;transition:color .2s}.tab.active[_ngcontent-%COMP%]{color:#5046e5;border-bottom:2px solid #5046e5}.tab-separator[_ngcontent-%COMP%]{color:#ccc}.auth-form[_ngcontent-%COMP%]{margin-top:10px}.form-control[_ngcontent-%COMP%]{height:auto;padding:12px 15px;border-radius:8px;border:1px solid #ddd;transition:border-color .2s,box-shadow .2s}.form-control[_ngcontent-%COMP%]:focus{border-color:#5046e5;box-shadow:0 0 0 .2rem #5046e526}.form-label[_ngcontent-%COMP%]{font-weight:500;color:#555;margin-bottom:8px}.forgot-link[_ngcontent-%COMP%]{font-size:14px;color:#5046e5;text-decoration:none}.forgot-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.signup-link[_ngcontent-%COMP%], .login-link[_ngcontent-%COMP%]{color:#5046e5;font-weight:500;text-decoration:none}.signup-link[_ngcontent-%COMP%]:hover, .login-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.btn-primary[_ngcontent-%COMP%]{background-color:#5046e5;border-color:#5046e5;padding:12px;font-weight:500}.btn-primary[_ngcontent-%COMP%]:hover, .btn-primary[_ngcontent-%COMP%]:focus{background-color:#4238d0;border-color:#4238d0}.btn-primary[_ngcontent-%COMP%]:disabled{background-color:#a8a4e0;border-color:#a8a4e0}.separator[_ngcontent-%COMP%]{display:flex;align-items:center;text-align:center;color:#888;font-size:14px}.separator[_ngcontent-%COMP%]:before, .separator[_ngcontent-%COMP%]:after{content:"";flex:1;border-bottom:1px solid #ddd}.separator[_ngcontent-%COMP%]:before{margin-right:1em}.separator[_ngcontent-%COMP%]:after{margin-left:1em}.google-btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;background-color:#fff;border:1px solid #ddd;color:#333;padding:12px;font-weight:500}.google-btn[_ngcontent-%COMP%]:hover{background-color:#f8f8f8;color:#333}@media (max-width: 576px){.auth-card[_ngcontent-%COMP%]{padding:20px 15px}.brand-name[_ngcontent-%COMP%]{font-size:20px}.form-control[_ngcontent-%COMP%], .btn[_ngcontent-%COMP%]{padding:10px}}']})};var vi=class i{constructor(t){this.supabaseService=t;this.supabase=this.supabaseService.GetClient()}supabase;ngOnInit(){}async addTradeLog(t,e){let n=this.supabaseService.user();if(!n)throw new Error("User not authenticated");t.userid=n.id;let{data:r,error:o}=await this.supabase.from(e).insert([t]);if(o)throw console.error("Error inserting trade log: ",o),o;return typeof window<"u"&&sessionStorage.setItem(`${e}_refresh`,"yes"),r}async getTradeLogs(t){let e=this.supabaseService.user();if(!e)throw new Error("User not authenticated");let n=!1,r=null;if(typeof window<"u"){n=sessionStorage.getItem(`${t}_refresh`)==="yes";let u=sessionStorage.getItem(t);if(u)try{r=JSON.parse(u)}catch(p){console.error("Error parsing cached trade logs:",p),r=null}}if(!n&&r)return r;let{data:o,error:c}=await this.supabase.from(t).select("*").eq("userid",e.id);if(c)throw console.error("Error fetching trade logs:",c),c;return typeof window<"u"&&(sessionStorage.setItem(t,JSON.stringify(o)),sessionStorage.removeItem(`${t}_refresh`)),o}async getTradeLogsOfSelectedAccount(t,e){let n=this.supabaseService.user();if(!n)throw new Error("User not authenticated");let r=`${t}_${e}`,o=`${r}_refresh`,c=!1,u=null;if(typeof window<"u"){c=sessionStorage.getItem(o)==="yes";let w=sessionStorage.getItem(r);if(w)try{u=JSON.parse(w)}catch(x){console.error("Error parsing cached trade logs:",x),u=null}}if(!c&&u)return u;let{data:p,error:m}=await this.supabase.from(t).select("*").eq("userid",n.id).eq("trade_account_id",e);if(m)throw console.error("Error fetching trade logs:",m),m;return typeof window<"u"&&(sessionStorage.setItem(r,JSON.stringify(p)),sessionStorage.removeItem(o)),p}async addTradeLogOfSelectedAccount(t,e,n){let r=this.supabaseService.user();if(!r)throw new Error("User not authenticated");t.userid=r.id;let{data:o,error:c}=await this.supabase.from(e).insert([t]);if(c)throw console.error("Error inserting trade log: ",c),c;return typeof window<"u"&&sessionStorage.setItem(`${e}_${n}_refresh`,"yes"),o}async updateTradeLogOfSelectedAccount(t,e,n){if(!this.supabaseService.user())throw new Error("User not authenticated");let{data:o,error:c}=await this.supabase.from(e).update(t).eq("tradeid",t.tradeid);if(c)throw console.error("Error updating trade log: ",c),c;return typeof window<"u"&&sessionStorage.setItem(`${e}_${n}_refresh`,"yes"),o}async deleteTradeLogOfSelectedAccount(t,e,n){if(!this.supabaseService.user())throw new Error("User not authenticated");let{data:o,error:c}=await this.supabase.from(e).delete().eq("tradeid",t);if(c)throw console.error("Error deleting trade log: ",c),c;return typeof window<"u"&&sessionStorage.setItem(`${e}_${n}_refresh`,"yes"),o}async updateTradeLog(t,e){if(!this.supabaseService.user())throw new Error("User not authenticated");let{data:r,error:o}=await this.supabase.from(e).update(t).eq("tradeid",t.tradeid);if(o)throw console.error("Error updating trade log: ",o),o;return typeof window<"u"&&sessionStorage.setItem(`${e}_refresh`,"yes"),r}async deleteTradeLog(t,e){if(!this.supabaseService.user())throw new Error("User not authenticated");let{data:r,error:o}=await this.supabase.from(e).delete().eq("tradeid",t);if(o)throw console.error("Error deleting trade log: ",o),o;return typeof window<"u"&&sessionStorage.setItem(`${e}_refresh`,"yes"),r}async canLogTrade(){if(this.supabaseService.user()?.id===null)throw new Error("User not authenticated");let{data:e,error:n}=await this.supabase.rpc("can_log_trade");return!n&&e===!0}static \u0275fac=function(e){return new(e||i)(q(G))};static \u0275prov=z({token:i,factory:i.\u0275fac,providedIn:"root"})};var sd=i=>({"active-border":i});function ad(i,t){if(i&1&&(a(0,"div",11),l(1),s()),i&2){let e=h();d(),y(e.actionSuccess)}}function ld(i,t){if(i&1&&(a(0,"div",12),l(1),s()),i&2){let e=h();d(),y(e.actionError)}}function cd(i,t){i&1&&(a(0,"span",25),l(1,"Active"),s())}function dd(i,t){if(i&1){let e=j();a(0,"div",13)(1,"div",14)(2,"div",15)(3,"div")(4,"h5",16),l(5),b(6,cd,2,0,"span",17),s(),a(7,"p",18),l(8),s(),a(9,"p",19),l(10),yt(11,"number"),s()(),a(12,"div",20)(13,"button",21),g("click",function(){let r=_(e).$implicit,o=h();return v(o.onRowClick(r))}),T(14,"i",22),s(),a(15,"button",23),g("click",function(){let r=_(e).$implicit,o=h();return v(o.deleteAccount(r.account_id))}),T(16,"i",24),s()()()()()}if(i&2){let e=t.$implicit,n=h();d(),f("ngClass",ao(8,sd,e.account_id===n.selectedAccountId)),d(4),V(" ",e.account_name," "),d(),f("ngIf",e.account_id===n.selectedAccountId),d(2),Ut("",e.broker_name||"Unknown Broker"," \u2022 ",e.account_type||"\u2014",""),d(2),V("USD ",lo(11,6,e.balance),"")}}function ud(i,t){if(i&1&&(a(0,"div",44),l(1),s()),i&2){let e=h(2);d(),y(e.formError)}}function md(i,t){if(i&1){let e=j();a(0,"div",26),g("click",function(r){_(e);let o=h();return v(o.closeFormOnOutside(r))}),a(1,"div",27),g("click",function(r){return _(e),v(r.stopPropagation())}),a(2,"h5",16),l(3),s(),a(4,"p",28),l(5,"Add a new trading account to track your performance and journal entries."),s(),a(6,"form",29),g("ngSubmit",function(){_(e);let r=h();return v(r.submitForm())}),a(7,"div",30)(8,"label",31),l(9,"Account Name *"),s(),T(10,"input",32),s(),a(11,"div",30)(12,"label",31),l(13,"Broker *"),s(),a(14,"select",33)(15,"option",34),l(16,"Select broker"),s(),a(17,"option"),l(18,"Interactive Brokers"),s(),a(19,"option"),l(20,"MetaTrader 5"),s(),a(21,"option"),l(22,"NinjaTrader"),s(),a(23,"option"),l(24,"ThinkOrSwim"),s()()(),a(25,"div",30)(26,"label",31),l(27,"Account Type *"),s(),a(28,"select",35)(29,"option",34),l(30,"Select account type"),s(),a(31,"option"),l(32,"Live"),s(),a(33,"option"),l(34,"Demo"),s(),a(35,"option"),l(36,"Margin"),s(),a(37,"option"),l(38,"Cash"),s()()(),a(39,"div",36)(40,"div",37)(41,"label",31),l(42,"Starting Balance *"),s(),T(43,"input",38),s(),a(44,"div",37)(45,"label",31),l(46,"Currency"),s(),a(47,"select",39)(48,"option"),l(49,"USD"),s(),a(50,"option"),l(51,"EUR"),s(),a(52,"option"),l(53,"GBP"),s(),a(54,"option"),l(55,"SGD"),s()()()(),b(56,ud,2,1,"div",40),a(57,"div",41)(58,"button",42),g("click",function(){_(e);let r=h();return v(r.toggleForm())}),l(59,"Cancel"),s(),a(60,"button",43),l(61),s()()()()()}if(i&2){let e=h();d(3),y(e.selectedAccountId?"Edit Trading Account":"Add New Trading Account"),d(3),f("formGroup",e.tradeAccountForm),d(50),f("ngIf",e.formError),d(5),y(e.selectedAccountId?"Save Changes":"Add Account")}}var yi=class i{constructor(t,e,n,r){this.fb=t;this.supabaseService=e;this.supabaseAccountService=n;this.cdr=r;this.tradeAccountForm=this.fb.group({account_name:["",H.required],broker_name:[""],account_type:[""],currency:["USD"],balance:[0,H.min(0)],track_pl:[!1],include_in_analytics:[!1]})}tradeAccounts=[];showForm=!1;tradeAccountForm;formError=null;actionError=null;actionSuccess=null;selectedAccountId=null;showDeleteConfirm=!1;pendingDeleteAccountId=null;funMaterialIcons=["movie","music_note","videogame_asset","theater_comedy","sports_esports","fastfood","local_cafe","restaurant_menu","icecream","emoji_food_beverage","flight_takeoff","directions_car","hiking","beach_access","camping","smartphone","computer","memory","developer_mode","settings","mood","sentiment_satisfied","sentiment_very_dissatisfied","celebration","favorite","auto_awesome","nightlight","stars","magic_wand","castle"];ngOnInit(){this.loadAccounts()}async loadAccounts(){try{this.tradeAccounts=await this.supabaseAccountService.getUserTradeAccounts()}catch{this.actionError="Failed to load accounts. Please try again."}finally{this.cdr.markForCheck()}}async onRowClick(t){this.selectedAccountId=t.account_id,this.tradeAccountForm.patchValue({account_name:t.account_name,broker_name:t.broker_name,account_type:t.account_type,currency:t.currency,balance:t.balance,track_pl:t.metadata?.track_pl||!1,include_in_analytics:t.metadata?.include_in_analytics||!1}),this.showForm=!0}setActive(t){this.selectedAccountId=t,this.actionSuccess="Account set as active.",this.cdr.markForCheck()}toggleForm(){this.showForm=!this.showForm,this.formError=null,this.actionSuccess=null,this.actionError=null,this.selectedAccountId=null,this.showForm||this.tradeAccountForm.reset({currency:"USD",balance:0})}async submitForm(){if(this.formError="",this.tradeAccountForm.valid){let t=this.tradeAccountForm.value;this.selectedAccountId?await this.supabaseAccountService.editTradeAccount(this.selectedAccountId,t)?(this.actionSuccess="Account updated successfully",this.loadAccounts(),this.toggleForm()):this.formError="Failed to update account":await this.supabaseAccountService.addTradeAccount(t)?(this.actionSuccess="Account added successfully",this.loadAccounts(),this.toggleForm()):this.formError="Failed to add account"}this.cdr.markForCheck()}async deleteAccount(t){this.showDeleteConfirm=!0,this.pendingDeleteAccountId=t}confirmDelete(){this.pendingDeleteAccountId&&this.performAccountDeletion(this.pendingDeleteAccountId),this.showDeleteConfirm=!1,this.pendingDeleteAccountId=null}cancelDelete(){this.showDeleteConfirm=!1,this.pendingDeleteAccountId=null}async performAccountDeletion(t){this.actionError=null,this.actionSuccess=null;try{await this.supabaseAccountService.removeTradeAccount(t)?(this.loadAccounts(),this.actionSuccess="Account deleted successfully."):this.actionError="Failed to delete account."}catch{this.actionError="An unexpected error occurred while deleting."}finally{this.cdr.markForCheck(),setTimeout(()=>{this.actionSuccess="",this.cdr.markForCheck()},5e3)}}handleEscape(t){this.showForm&&this.toggleForm()}closeFormOnOutside(t){t.target===t.currentTarget&&this.toggleForm()}static \u0275fac=function(e){return new(e||i)(C(qe),C(vi),C(Me),C(de))};static \u0275cmp=K({type:i,selectors:[["app-tradeaccountmanage"]],hostBindings:function(e,n){e&1&&g("keydown.escape",function(o){return n.handleEscape(o)},!1,to)},decls:15,vars:4,consts:[[1,"container","py-4"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"fw-semibold"],[1,"text-muted","mb-0"],[1,"btn","btn-primary","d-flex","align-items-center","gap-2",3,"click"],[1,"bi","bi-plus-lg"],["class","alert alert-success",4,"ngIf"],["class","alert alert-danger",4,"ngIf"],[1,"row","gy-3"],["class","col-12",4,"ngFor","ngForOf"],["class","overlay",3,"click",4,"ngIf"],[1,"alert","alert-success"],[1,"alert","alert-danger"],[1,"col-12"],[1,"account-card",3,"ngClass"],[1,"d-flex","justify-content-between","align-items-start"],[1,"fw-semibold","mb-1"],["class","badge bg-primary ms-2",4,"ngIf"],[1,"text-muted","small","mb-1"],[1,"fw-bold","fs-5","mb-0"],[1,"d-flex","gap-2"],[1,"btn","btn-light","btn-sm",3,"click"],[1,"bi","bi-gear"],[1,"btn","btn-light","btn-sm","text-danger",3,"click"],[1,"bi","bi-trash"],[1,"badge","bg-primary","ms-2"],[1,"overlay",3,"click"],[1,"modal-card",3,"click"],[1,"text-muted","small","mb-3"],[3,"ngSubmit","formGroup"],[1,"mb-3"],[1,"form-label"],["type","text","placeholder","e.g., Main Trading Account","formControlName","account_name",1,"form-control"],["formControlName","broker_name",1,"form-select"],["value","","disabled",""],["formControlName","account_type",1,"form-select"],[1,"row","g-2"],[1,"col-6"],["type","number","formControlName","balance",1,"form-control"],["formControlName","currency",1,"form-select"],["class","alert alert-danger mt-3",4,"ngIf"],[1,"d-flex","justify-content-end","gap-2","mt-4"],["type","button",1,"btn","btn-outline-secondary",3,"click"],["type","submit",1,"btn","btn-primary"],[1,"alert","alert-danger","mt-3"]],template:function(e,n){e&1&&(a(0,"div",0)(1,"div",1)(2,"div")(3,"h2",2),l(4,"Trading Accounts"),s(),a(5,"p",3),l(6,"Manage your trading accounts and select which account to use for journaling and analytics."),s()(),a(7,"button",4),g("click",function(){return n.toggleForm()}),T(8,"i",5),l(9," Add Trading Account "),s()(),b(10,ad,2,1,"div",6)(11,ld,2,1,"div",7),a(12,"div",8),b(13,dd,17,10,"div",9),s(),b(14,md,62,4,"div",10),s()),e&2&&(d(10),f("ngIf",n.actionSuccess),d(),f("ngIf",n.actionError),d(2),f("ngForOf",n.tradeAccounts),d(),f("ngIf",n.showForm))},dependencies:[Te,ze,Jt,Yt,ie,kt,mt,le,Ue,De,Fe,X,qt,Ve,te,Fn],styles:[".modal-backdrop[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#00000080;z-index:1050}.overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background-color:#00000080;display:flex;align-items:center;justify-content:center;z-index:1050}.modal-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:2rem;width:100%;max-width:600px;max-height:90dvh;overflow-y:auto;box-shadow:0 10px 25px #00000026}.list-group-item[_ngcontent-%COMP%]{cursor:pointer}.delete-button[_ngcontent-%COMP%]{color:red;display:none;margin-left:auto}.list-group-item[_ngcontent-%COMP%]:hover   .delete-button[_ngcontent-%COMP%]{color:red;display:block}.account-card[_ngcontent-%COMP%]{border:1px solid #e0e0e0;border-radius:12px;padding:1.25rem;background:#fff;transition:all .2s ease-in-out}.account-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #0000000d}.active-border[_ngcontent-%COMP%]{border:2px solid #4a6cf7}.overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#0000008c;display:flex;align-items:center;justify-content:center;z-index:1050}.modal-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:2rem;width:100%;max-width:500px;max-height:90vh;overflow-y:auto;box-shadow:0 10px 25px #00000026}"]})};function pd(i,t){if(i&1&&T(0,"img",35),i&2){let e=h();f("src",e.currentImageUrl,tn)}}function hd(i,t){if(i&1&&T(0,"img",36),i&2){let e=h();f("src",e.previewUrl,tn)}}function fd(i,t){i&1&&(a(0,"div",14),l(1,"No new image selected"),s())}function gd(i,t){if(i&1&&(a(0,"div",23)(1,"div",37),l(2),s()()),i&2){let e=h();d(2),y(e.errorMessage)}}function _d(i,t){if(i&1&&(a(0,"button",38),l(1," Save Changes "),s()),i&2){let e=h();f("disabled",e.profileForm.invalid)}}var bi=class i{constructor(t,e,n){this.fb=t;this.supabaseService=e;this.cdr=n;this.profileForm=this.fb.group({firstname:["",H.required],lastname:[""],email:["",[H.required,H.email]],phone:[""]})}profileForm;currentImageUrl=null;previewUrl=null;selectedFile=null;userId="";originalFormValue;formChanged=!1;errorMessage="";async ngOnInit(){await this.loadProfile(),this.trackFormChanges()}async loadProfile(){try{let{data:t,error:e}=await this.supabaseService.getProfile();if(e){this.errorMessage="Failed to load profile: "+e.message,console.error("Supabase profile load error:",e);return}t?(this.profileForm.patchValue({firstname:t.firstname,lastname:t.lastname,email:t.email,phone:t.phone}),this.originalFormValue=this.profileForm.getRawValue(),t.profile_picture_url?(this.currentImageUrl=await this.supabaseService.getCachedProfilePictureBlobUrl(t.profile_picture_url),this.previewUrl=this.currentImageUrl):(this.currentImageUrl=null,this.previewUrl=null)):(this.errorMessage="No profile data found. Please complete your profile.",console.warn("No profile data received from Supabase."))}catch(t){this.errorMessage="An unexpected error occurred while loading profile.",console.error("Error in loadProfile:",t)}finally{this.cdr.markForCheck()}}async removeProfilePicture(){try{this.errorMessage="",await this.supabaseService.deleteProfilePicture(),this.supabaseService.clearCachedProfilePictureBlobUrl(),await this.supabaseService.updateProfile({profile_picture_url:null}),this.currentImageUrl=null,this.previewUrl=null,this.selectedFile=null,this.formChanged=!0}catch(t){this.errorMessage="Failed to remove profile picture: "+(t.message||t.toString()),console.error("Error removing profile picture:",t)}finally{this.cdr.markForCheck()}}trackFormChanges(){this.profileForm.valueChanges.subscribe(()=>{this.formChanged=this.profileForm.dirty||!!this.selectedFile,this.cdr.markForCheck()})}onFileChange(t){this.errorMessage="";let e=t.target,n=e?.files?.[0];if(!n){this.selectedFile=null;return}if(!["image/jpeg","image/png","image/webp"].includes(n.type)){this.errorMessage="Only JPG, PNG, or WEBP images are allowed.",this.selectedFile=null,e.value="";return}if(n.size>1024*1024){this.errorMessage="File size must be less than 1MB.",this.selectedFile=null,e.value="";return}this.selectedFile=n,this.previewUrl&&URL.revokeObjectURL(this.previewUrl),this.previewUrl=URL.createObjectURL(n),this.formChanged=!0,this.cdr.markForCheck()}async saveChanges(){if(this.errorMessage="",!this.formChanged){this.errorMessage="No changes detected.";return}if(this.profileForm.invalid){this.errorMessage="Please correct the highlighted form errors.",this.profileForm.markAllAsTouched(),this.cdr.markForCheck();return}let t=this.originalFormValue.profile_picture_url??null;if(this.selectedFile)try{if(t=await this.supabaseService.uploadProfilePicture(this.selectedFile),!t){this.errorMessage="Failed to upload profile picture. Please try again.",console.error("Supabase uploadProfilePicture returned null filePath");return}}catch(r){this.errorMessage="Error uploading profile picture: "+(r.message||r.toString()),console.error("Error during profile picture upload:",r);return}let e=this.profileForm.getRawValue(),n={firstname:e.firstname,lastname:e.lastname,email:e.email,phone:e.phone,profile_picture_url:t,updated_at:new Date().toISOString(),preferences:{},metadata:{}};try{await this.supabaseService.updateProfile(n),t&&(this.supabaseService.clearCachedProfilePictureBlobUrl(),this.currentImageUrl=await this.supabaseService.getCachedProfilePictureBlobUrl(t),this.previewUrl=this.currentImageUrl),this.formChanged=!1,this.selectedFile=null,this.originalFormValue=this.profileForm.getRawValue(),this.errorMessage=""}catch(r){this.errorMessage="Failed to save changes: "+(r.message||r.toString()),console.error("Error during profile update:",r)}finally{this.cdr.markForCheck()}}static \u0275fac=function(e){return new(e||i)(C(qe),C(Me),C(de))};static \u0275cmp=K({type:i,selectors:[["app-user-account-settings"]],decls:58,vars:6,consts:[[1,"container","mb-5"],["aria-label","breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","/home"],["aria-current","page",1,"breadcrumb-item","active"],[1,"mb-2"],[1,"text-muted","mb-4"],[1,"row","g-3","mb-4"],[1,""],[1,"card","border-0","shadow-sm","p-3","h-100"],[1,"d-flex","align-items-center","mb-2"],["alt","Profile","class","rounded-circle me-2","style","width: 40px; height: 40px; object-fit: cover;",3,"src",4,"ngIf"],[1,"mb-0"],[1,"text-muted"],[1,"row","g-4",3,"ngSubmit","formGroup"],[1,"fw-bold"],[1,"col-md-6"],[1,"form-label"],["formControlName","firstname","placeholder","First name",1,"form-control"],["formControlName","lastname","placeholder","Last name",1,"form-control"],["formControlName","email","placeholder","Email","type","email",1,"form-control"],["formControlName","phone","placeholder","+1 (123) 456-7890",1,"form-control"],[1,"col-12"],[1,"fw-bold","mt-3"],[1,"card","p-3","shadow-sm","border-light","bg-light-subtle"],[1,"form-label","d-block"],["alt","Preview","class","img-thumbnail","style","width: 120px;",3,"src",4,"ngIf"],["class","text-muted",4,"ngIf"],["type","file",1,"form-control","mt-2",3,"change"],[1,"mt-2","d-flex","gap-2"],["type","button",1,"btn","btn-outline-secondary","btn-sm",3,"click"],["class","col-12",4,"ngIf"],[1,"col-12","text-end"],["type","submit","class","btn btn-tr",3,"disabled",4,"ngIf"],["alt","Profile",1,"rounded-circle","me-2",2,"width","40px","height","40px","object-fit","cover",3,"src"],["alt","Preview",1,"img-thumbnail",2,"width","120px",3,"src"],[1,"alert","alert-danger"],["type","submit",1,"btn","btn-tr",3,"disabled"]],template:function(e,n){e&1&&(a(0,"div",0)(1,"nav",1)(2,"ol",2)(3,"li",3)(4,"a",4),l(5,"Dashboard"),s()(),a(6,"li",5),l(7,"Account Settings"),s()()(),a(8,"h2",6),l(9,"Account Settings"),s(),a(10,"p",7),l(11,"Manage your profile, subscription, and preferences"),s(),a(12,"div",8)(13,"div",9)(14,"div",10)(15,"div",11),b(16,pd,1,1,"img",12),a(17,"h5",13),l(18,"Profile Information"),s()(),a(19,"small",14),l(20,"Update your personal details and public profile"),s()()()(),a(21,"form",15),g("ngSubmit",function(){return n.saveChanges()}),a(22,"h5",16),l(23,"Personal Information"),s(),a(24,"div",17)(25,"label",18),l(26,"First Name"),s(),T(27,"input",19),s(),a(28,"div",17)(29,"label",18),l(30,"Last Name"),s(),T(31,"input",20),s(),a(32,"div",17)(33,"label",18),l(34,"Email Address"),s(),T(35,"input",21),s(),a(36,"div",17)(37,"label",18),l(38,"Phone"),s(),T(39,"input",22),s(),a(40,"div",23)(41,"h6",24),l(42,"Profile Picture"),s(),a(43,"div",25)(44,"div",6)(45,"label",26),l(46,"Preview New Photo"),s(),b(47,hd,1,1,"img",27)(48,fd,2,0,"div",28),s(),a(49,"input",29),g("change",function(o){return n.onFileChange(o)}),s(),a(50,"small",14),l(51,"JPG, PNG or GIF. Max 1MB."),s(),a(52,"div",30)(53,"button",31),g("click",function(){return n.removeProfilePicture()}),l(54,"Remove"),s()()()(),b(55,gd,3,1,"div",32),a(56,"div",33),b(57,_d,2,1,"button",34),s()()()),e&2&&(d(16),f("ngIf",n.currentImageUrl),d(5),f("formGroup",n.profileForm),d(26),f("ngIf",n.previewUrl),d(),f("ngIf",!n.previewUrl),d(7),f("ngIf",n.errorMessage),d(2),f("ngIf",n.formChanged))},dependencies:[Te,ze,ie,le,Ue,De,Fe,X,te,_e],encapsulation:2})};var vd=["conversationContainer"],yd=["userInput"],bd=(i,t)=>({"bot-message":i,"user-message":t});function wd(i,t){if(i&1){let e=j();a(0,"div",15),g("click",function(){let r=_(e).$implicit,o=h();return v(o.selectDate(r.date))}),a(1,"div",16),l(2),s(),a(3,"div",17),l(4),s()()}if(i&2){let e=t.$implicit,n=h();D("active",n.isDateSelected(e.date))("today",n.isToday(e.date)),d(2),y(e.dayName),d(2),y(e.dayNumber)}}function Cd(i,t){i&1&&(a(0,"div",18)(1,"div",19)(2,"span",20),l(3,"Loading..."),s()()())}function xd(i,t){if(i&1&&(a(0,"div",28),l(1),s()),i&2){let e=t.$implicit;f("ngClass",Dn(2,bd,e.sender==="bot",e.sender==="user")),d(),V(" ",e.text," ")}}function Sd(i,t){if(i&1){let e=j();a(0,"div")(1,"div",21),T(2,"div",22),s(),a(3,"div",23,0),b(5,xd,2,5,"div",24),s(),a(6,"div",25)(7,"textarea",26,1),R("ngModelChange",function(r){_(e);let o=h();return N(o.currentInput,r)||(o.currentInput=r),v(r)}),g("keydown",function(r){_(e);let o=h();return v(o.onKeyDown(r))}),s(),a(9,"button",27),g("click",function(){_(e);let r=h();return v(r.submitAnswer())}),l(10," Continue "),s()()()}if(i&2){let e=h();d(2),on("width",e.progressPercentage()),d(3),f("ngForOf",e.conversation()),d(2),O("ngModel",e.currentInput),f("disabled",e.isLoading()),d(2),f("disabled",e.isLoading()||!e.currentInput.trim())}}function Ed(i,t){if(i&1&&(a(0,"section",35)(1,"div",45)(2,"div",46)(3,"h5",38)(4,"mat-icon",47),l(5,"fact_check"),s(),l(6," Emotional State "),s(),a(7,"ul",48)(8,"li",49)(9,"strong"),l(10,"Patience:"),s(),l(11),s(),a(12,"li",49)(13,"strong"),l(14,"Confidence:"),s(),l(15),s(),a(16,"li")(17,"strong"),l(18,"Doubt:"),s(),l(19),s()()()()()),i&2){let e=h().ngIf;d(11),V(" ",e.emotionalState.Patience,""),d(4),V(" ",e.emotionalState.Confidence,""),d(4),V(" ",e.emotionalState.Doubt,"")}}function Td(i,t){if(i&1&&(a(0,"li"),l(1),s()),i&2){let e=t.$implicit;d(),V(" \u2022 ",e.category," ")}}function Md(i,t){if(i&1&&(a(0,"li"),l(1),s()),i&2){let e=t.$implicit;d(),V(" \u2022 ",e.category," ")}}function Id(i,t){if(i&1&&(a(0,"section",35)(1,"div",45)(2,"div",46)(3,"h5",38)(4,"mat-icon",50),l(5,"tips_and_updates"),s(),l(6," Behavior Patterns "),s(),a(7,"div",51)(8,"div",52)(9,"ul",53),b(10,Td,2,1,"li",54),s()(),a(11,"div",52)(12,"ul",53),b(13,Md,2,1,"li",54),s()()()()()()),i&2){let e=h().ngIf,n=h(2);d(10),f("ngForOf",e.behaviorPattern.slice(0,n.Math.ceil(e.behaviorPattern.length/2))),d(3),f("ngForOf",e.behaviorPattern.slice(n.Math.ceil(e.behaviorPattern.length/2)))}}function Ad(i,t){if(i&1&&(a(0,"section",35)(1,"div",55)(2,"div",46)(3,"h5",56)(4,"mat-icon",57),l(5,"warning_amber"),s(),l(6," Immediate Action "),s(),a(7,"p",58),l(8),s()()()()),i&2){let e=h().ngIf;d(8),y(e.actionableitem)}}function kd(i,t){if(i&1&&(a(0,"div",61)(1,"div",62)(2,"span"),l(3),s(),a(4,"span",33),l(5),s()(),a(6,"div",63),T(7,"div",64),s()()),i&2){let e=t.$implicit;d(3),y(e.emotion),d(2),y(e.percentage),d(2),on("width",e.percentage)("background-color",e.color||"#748ffc")}}function Pd(i,t){if(i&1&&(a(0,"section",35)(1,"div",45)(2,"div",46)(3,"h5",38)(4,"mat-icon",59),l(5,"bar_chart"),s(),l(6," Emotional State Summary "),s(),b(7,kd,8,6,"div",60),s()()()),i&2){let e=h().ngIf;d(7),f("ngForOf",e.emotion)}}function Dd(i,t){if(i&1&&(a(0,"li"),l(1),s()),i&2){let e=t.$implicit;d(),y(e)}}function Fd(i,t){if(i&1&&(a(0,"li"),l(1),s()),i&2){let e=t.$implicit;d(),y(e)}}function Od(i,t){if(i&1&&(a(0,"section",65)(1,"div",45)(2,"div",46)(3,"h5",66)(4,"mat-icon",39),l(5,"psychology"),s(),l(6," AI Recommendations "),s(),a(7,"div",51)(8,"div",67)(9,"ul",68),b(10,Dd,2,1,"li",54),s()(),a(11,"div",67)(12,"ul",68),b(13,Fd,2,1,"li",54),s()()()()()()),i&2){let e=h().ngIf,n=h(2);d(10),f("ngForOf",e.recommendation.slice(0,n.Math.ceil(e.recommendation.length/2))),d(3),f("ngForOf",e.recommendation.slice(n.Math.ceil(e.recommendation.length/2)))}}function Nd(i,t){if(i&1){let e=j();a(0,"button",69),g("click",function(){_(e);let r=h(3);return v(r.startNewCheckIn())}),l(1,"New Check-In"),s()}}function Rd(i,t){if(i&1&&(Ge(0),a(1,"header",31)(2,"div",32)(3,"div",32)(4,"mat-icon"),l(5,"task_alt"),s()()(),a(6,"h2",33),l(7,"Thank you for sharing!"),s(),a(8,"p",6),l(9,"Here are your personalized insights based on today\u2019s check-in"),s()(),a(10,"div",34)(11,"section",35)(12,"div",36)(13,"div",37)(14,"h5",38)(15,"mat-icon",39),l(16,"track_changes"),s(),l(17," Trading Readiness "),s(),a(18,"div",40),l(19),s()()()(),b(20,Ed,20,3,"section",41)(21,Id,14,2,"section",41)(22,Ad,9,1,"section",41)(23,Pd,8,1,"section",41)(24,Od,14,2,"section",42),s(),a(25,"footer",43),b(26,Nd,2,0,"button",44),s(),He()),i&2){let e=t.ngIf,n=h(2);d(19),V(" ",e.readiness," "),d(),f("ngIf",e.emotionalState),d(),f("ngIf",e.behaviorPattern==null?null:e.behaviorPattern.length),d(),f("ngIf",e.actionableitem),d(),f("ngIf",e.emotion==null?null:e.emotion.length),d(),f("ngIf",e.recommendation==null?null:e.recommendation.length),d(2),f("ngIf",n.canRepeatCheckIn)}}function Vd(i,t){i&1&&(a(0,"div",70)(1,"h3"),l(2,"No Check-in Data"),s(),a(3,"p",6),l(4,"There is no analysis available for the selected date."),s()())}function Ld(i,t){if(i&1&&(a(0,"div",29),b(1,Rd,27,7,"ng-container",30)(2,Vd,5,0,"ng-template",null,2,Qe),s()),i&2){let e=$e(3),n=h();d(),f("ngIf",n.analysisResult())("ngIfElse",e)}}function Bd(i,t){if(i&1&&(a(0,"div",70)(1,"h3"),l(2,"Check-in Not Available Yet"),s(),a(3,"p"),l(4),s()()),i&2){let e=h();d(4),V("Please come back on this date to complete your check-in. ",e.futureMessage(),"")}}var wi=class i{constructor(t,e,n){this.supabaseEmotionService=t;this.supabaseFunctionService=e;this.supabaseService=n}conversationContainer;userInputRef;viewMode=A("loading");weekDates=A([]);selectedDate=A(new Date);futureMessage=A("");isLoading=A(!1);Math=Math;questions=A([]);currentQuestionIndex=A(0);conversation=A([]);userAnswers=[];currentInput="";analysisResult=A(null);canRepeatCheckIn=!1;progressPercentage=oe(()=>{let t=this.questions().length;return t===0?"0%":`${this.currentQuestionIndex()/t*100}%`});ngOnInit(){this.generateWeekDays(),this.selectDate(new Date)}ngAfterViewInit(){this.userInputRef.nativeElement.addEventListener("input",this.autoResize.bind(this))}autoResize(){let t=this.userInputRef.nativeElement;t.style.height="auto",t.style.height=`${t.scrollHeight}px`}scrollToBottom(){setTimeout(()=>{try{this.conversationContainer?.nativeElement&&(this.conversationContainer.nativeElement.scrollTop=this.conversationContainer.nativeElement.scrollHeight)}catch(t){console.error("Could not scroll to bottom:",t)}},0)}generateWeekDays(){let t=new Date,e=new Date(t.setDate(t.getDate()-t.getDay())),n=[];for(let r=0;r<7;r++){let o=new Date(e);o.setDate(o.getDate()+r),n.push({date:o,dayName:o.toLocaleDateString("en-US",{weekday:"short"}),dayNumber:o.getDate().toString()})}this.weekDates.set(n)}async selectDate(t){this.selectedDate.set(t),this.viewMode.set("loading"),this.analysisResult.set(null),this.canRepeatCheckIn=!1;let e=new Date;e.setHours(0,0,0,0);let n=new Date(t);n.setHours(0,0,0,0),n>e?this.handleFutureDate(n):n.getTime()===e.getTime()?await this.handleToday():await this.handlePastDate(n)}isToday(t){return new Date(t).toDateString()===new Date().toDateString()}isDateSelected(t){return new Date(t).toDateString()===new Date(this.selectedDate()).toDateString()}handleFutureDate(t){let e=new Date,n=t.getTime()-e.getTime(),r=Math.floor(n/(1e3*60*60*24)),o=Math.floor(n%(1e3*60*60*24)/(1e3*60*60));this.futureMessage.set(`Check-in will open in ${r} days and ${o} hours.`),this.viewMode.set("future")}async handleToday(){try{this.isLoading.set(!0);let t=await this.supabaseEmotionService.canLoadCheckInQuestions(),e=await this.supabaseEmotionService.getEmotionCheckInResultForDate(new Date);e?(this.analysisResult.set(e),this.viewMode.set("analysis"),this.canRepeatCheckIn=t):t?await this.startCheckIn():(this.analysisResult.set(null),this.viewMode.set("analysis"),this.canRepeatCheckIn=!1)}catch{this.viewMode.set("analysis")}finally{this.isLoading.set(!1)}}async handlePastDate(t){this.isLoading.set(!0);let e=await this.supabaseEmotionService.getEmotionCheckInResultForDate(t);this.analysisResult.set(e),this.viewMode.set("analysis"),this.isLoading.set(!1)}async startCheckIn(){this.isLoading.set(!0),this.conversation.set([]),this.userAnswers=[],this.currentQuestionIndex.set(0);try{let t=await this.supabaseEmotionService.loadQuestions();this.questions.set(t||[]),t?.length>0?(this.conversation.update(e=>[...e,{sender:"bot",text:t[0].question_data.question}]),this.viewMode.set("checkin"),this.scrollToBottom(),setTimeout(()=>{this.userInputRef?.nativeElement.focus()},0)):this.viewMode.set("analysis")}catch(t){console.error("Error loading questions:",t),this.viewMode.set("analysis")}finally{this.isLoading.set(!1)}}onKeyDown(t){t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),this.submitAnswer())}async submitAnswer(){if(!this.currentInput.trim()||this.isLoading())return;this.isLoading.set(!0);let t=this.questions()[this.currentQuestionIndex()],e=this.currentInput.trim();this.conversation.update(n=>[...n,{sender:"user",text:e}]),this.scrollToBottom(),this.userAnswers.push({question_id:t.question_id,answer:e}),this.currentInput="",setTimeout(()=>{this.userInputRef.nativeElement.style.height="40px",this.userInputRef.nativeElement.focus()},0),setTimeout(async()=>{let n=this.currentQuestionIndex()+1;if(n<this.questions().length){this.currentQuestionIndex.set(n);let r=this.questions()[n];this.conversation.update(o=>[...o,{sender:"bot",text:r.question_data.question}]),this.scrollToBottom(),this.isLoading.set(!1)}else await this.finalizeCheckIn()},300)}processAnalysisResponse(t){let e={};for(let n of t){let r=Object.keys(n)[0];if(!r)continue;let o=n[r];switch(r){case"emotion":e.emotion=o;break;case"behaviorPattern":e.behaviorPattern=o.map(c=>({category:c.category,icon:c.icon,color:c.Color||c.color}));break;case"recommendation":e.recommendation=o;break;case"readiness":e.readiness=o;break;case"actionableitem":e.actionableitem=o;break;case"emotionalState":e.emotionalState=o;break}}return{emotion:e.emotion||[],behaviorPattern:e.behaviorPattern||[],recommendation:e.recommendation||[],readiness:e.readiness||"N/A",actionableitem:e.actionableitem||"No specific action item.",emotionalState:e.emotionalState}}async finalizeCheckIn(){this.viewMode.set("loading");try{let t=this.userAnswers.map(u=>`Q: ${this.questions().find(m=>m.question_id===u.question_id)?.question_data.question} A:${u.answer}`).join(" "),{data:e,error:n}=await this.supabaseFunctionService.callEdgeFunction("emotion-analyst-gemini",{prompt:t});if(n)throw n;if(!e||!Array.isArray(e))throw new Error("Invalid analysis data format received from function.");let r=this.processAnalysisResponse(e),o={user_id:this.supabaseService.user()?.id,answers:this.userAnswers,analysis:r},{error:c}=await this.supabaseEmotionService.submitUserCheckIn(o);if(c)throw c;this.analysisResult.set(r),this.viewMode.set("analysis"),this.canRepeatCheckIn=!0}catch(t){console.error("Error finalizing check-in:",t),this.viewMode.set("analysis")}finally{this.isLoading.set(!1)}}startNewCheckIn(){this.selectDate(new Date)}static \u0275fac=function(e){return new(e||i)(C(Zt),C(xo),C(G))};static \u0275cmp=K({type:i,selectors:[["app-user-emotion-analysis"]],viewQuery:function(e,n){if(e&1&&(Lt(vd,5),Lt(yd,5)),e&2){let r;Bt(r=jt())&&(n.conversationContainer=r.first),Bt(r=jt())&&(n.userInputRef=r.first)}},decls:14,vars:6,consts:[["conversationContainer",""],["userInput",""],["noAnalysis",""],[1,"container-fluid","analysis-container"],[1,"mb-4"],[1,"h4","fw-bold"],[1,"text-muted"],[1,"date-bar"],["class","date-item",3,"active","today","click",4,"ngFor","ngForOf"],[1,"main-card"],[3,"ngSwitch"],["class","text-center p-5",4,"ngSwitchCase"],[4,"ngSwitchCase"],["class","analysis-view",4,"ngSwitchCase"],["class","message-view",4,"ngSwitchCase"],[1,"date-item",3,"click"],[1,"day-name"],[1,"day-number"],[1,"text-center","p-5"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"progress-bar-container","mb-3"],[1,"progress-bar"],[1,"conversation-container"],["class","message",3,"ngClass",4,"ngFor","ngForOf"],[1,"input-area","mt-3"],["rows","1","placeholder","Type your response here...",1,"form-control","chat-input",3,"ngModelChange","keydown","ngModel","disabled"],[1,"btn","btn-tr",3,"click","disabled"],[1,"message",3,"ngClass"],[1,"analysis-view"],[4,"ngIf","ngIfElse"],[1,"text-center","mb-5"],[1,"icon-wrapper","mb-3"],[1,"fw-bold"],[1,"row","g-4"],[1,"col-md-6","col-lg-4"],[1,"card","h-100","shadow-sm","border-0","bg-light"],[1,"card-body","d-flex","flex-column","justify-content-between"],[1,"card-title","d-flex","align-items-center","mb-3"],[1,"me-2","text-primary"],[1,"display-5","fw-bold","text-primary","text-center"],["class","col-md-6 col-lg-4",4,"ngIf"],["class","col-12",4,"ngIf"],[1,"text-center","mt-5"],["class","btn btn-primary",3,"click",4,"ngIf"],[1,"card","h-100","shadow-sm","border-0"],[1,"card-body"],[1,"me-2","text-success"],[1,"list-unstyled","mb-0"],[1,"mb-2"],[1,"me-2","text-info"],[1,"row"],[1,"col-6"],[1,"list-unstyled"],[4,"ngFor","ngForOf"],[1,"card","h-100","shadow-sm","border-warning","border-start","border-4"],[1,"card-title","d-flex","align-items-center","text-warning","mb-3"],[1,"me-2"],[1,"mb-0"],[1,"me-2","text-secondary"],["class","mb-3",4,"ngFor","ngForOf"],[1,"mb-3"],[1,"d-flex","justify-content-between","mb-1"],[1,"progress",2,"height","8px"],["role","progressbar",1,"progress-bar"],[1,"col-12"],[1,"card-title","d-flex","align-items-center","mb-4"],[1,"col-md-6"],[1,"recommendation-list"],[1,"btn","btn-primary",3,"click"],[1,"message-view"]],template:function(e,n){e&1&&(a(0,"div",3)(1,"div",4)(2,"h1",5),l(3,"Daily Emotional Check-in"),s(),a(4,"p",6),l(5," Share how you\u2019re feeling today. This helps us provide personalized insights for your trading journey. "),s()(),a(6,"div",7),b(7,wd,5,6,"div",8),s(),a(8,"div",9)(9,"div",10),b(10,Cd,4,0,"div",11)(11,Sd,11,6,"div",12)(12,Ld,4,2,"div",13)(13,Bd,5,1,"div",14),s()()()),e&2&&(d(7),f("ngForOf",n.weekDates()),d(2),f("ngSwitch",n.viewMode()),d(),f("ngSwitchCase","loading"),d(),f("ngSwitchCase","checkin"),d(),f("ngSwitchCase","analysis"),d(),f("ngSwitchCase","future"))},dependencies:[X,qt,Ve,te,uo,mo,pt,ie,le,et,ni],styles:[".analysis-container[_ngcontent-%COMP%]{max-width:1200px;padding:0 1rem;font-family:Inter,sans-serif}.date-bar[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(7,1fr);gap:.5rem;background-color:#f8f9fa;border-radius:12px;padding:.5rem;margin-bottom:2rem}.date-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:.5rem;border-radius:8px;cursor:pointer;border:2px solid transparent;transition:all .3s ease}.date-item[_ngcontent-%COMP%]:hover{background-color:#e9ecef}.date-item.active[_ngcontent-%COMP%]{background-color:#0d6efd;color:#fff;font-weight:700}.day-name[_ngcontent-%COMP%]{font-size:.8rem;font-weight:500}.day-number[_ngcontent-%COMP%]{font-size:1.25rem}.main-card[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:1.5rem;box-shadow:0 8px 32px #0000000f;width:100%}.analysis-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:2rem}.analysis-header[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]{width:70px;height:70px;border-radius:50%;background-color:#e6f7ff;display:flex;align-items:center;justify-content:center;margin:0 auto 1rem;color:#1890ff;line-height:1}.analysis-header[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:36px;line-height:1}.analysis-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-weight:600;color:#343a40}.analysis-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:1.5rem}@media (min-width: 768px){.analysis-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}@media (min-width: 1200px){.analysis-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(3,1fr)}}.analysis-card[_ngcontent-%COMP%]{background-color:#f8f9fa;border:1px solid #e9ecef;padding:1.25rem;border-radius:12px;transition:all .3s ease}.analysis-card[_ngcontent-%COMP%]:hover{transform:translateY(-3px);box-shadow:0 6px 20px #00000014}.analysis-card.readiness[_ngcontent-%COMP%]{background:linear-gradient(135deg,#e7f5ff,#d0ebff);border:none;display:flex;justify-content:space-between;align-items:center}.readiness[_ngcontent-%COMP%]   .readiness-value[_ngcontent-%COMP%]{font-size:2.2rem;font-weight:700;color:#0d6efd}.warning-card[_ngcontent-%COMP%]{background:#fff3cd;border-color:#ffeeba}.emotion-summary[_ngcontent-%COMP%]   .emotion-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;margin-bottom:.75rem}.emotion-label[_ngcontent-%COMP%]{width:100px;font-weight:500}.emotion-bar-container[_ngcontent-%COMP%]{flex-grow:1;height:8px;background-color:#e9ecef;border-radius:4px}.emotion-bar[_ngcontent-%COMP%]{height:100%;border-radius:4px;background:linear-gradient(90deg,#748ffc,#4dabf7);transition:width .4s ease}.recommendation-list[_ngcontent-%COMP%]{list-style-type:none;padding-left:0;margin:0}.recommendation-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:.5rem 0;border-bottom:1px solid #e9ecef}.recommendation-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child{border-bottom:none}.analysis-buttons[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:1rem;margin-top:2rem}.conversation-container[_ngcontent-%COMP%]{height:400px;overflow-y:auto;padding:1rem;margin-bottom:1rem;display:flex;flex-direction:column;gap:1rem;scroll-behavior:smooth}.message[_ngcontent-%COMP%]{padding:.75rem 1.25rem;border-radius:1.25rem;max-width:75%;line-height:1.5}.bot-message[_ngcontent-%COMP%]{background-color:#f1f3f5;color:#343a40;border-bottom-left-radius:.25rem;align-self:flex-start}.user-message[_ngcontent-%COMP%]{background-color:#e7f5ff;color:#1971c2;border-bottom-right-radius:.25rem;align-self:flex-end}.input-area[_ngcontent-%COMP%]{display:flex;gap:.5rem;border-top:1px solid #e9ecef;padding-top:1rem}.input-area[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex-grow:1;border-radius:20px;border:1px solid #ced4da;padding:.5rem 1rem}.input-area[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#0d6efd;box-shadow:0 0 0 2px #0d6efd40}textarea.form-control[_ngcontent-%COMP%]{resize:none;overflow:hidden}.chat-input[_ngcontent-%COMP%]{flex-grow:1;border-radius:20px;border:1px solid #ced4da;padding:.5rem 1rem;resize:none;overflow:hidden;line-height:1.5}.chat-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#0d6efd;box-shadow:0 0 0 2px #0d6efd40}.progress-bar-container[_ngcontent-%COMP%]{height:8px;background-color:#e9ecef;border-radius:4px;margin-bottom:1rem}.progress-bar[_ngcontent-%COMP%]{height:100%;background-color:#0d6efd;border-radius:4px;transition:width .4s ease}.message-view[_ngcontent-%COMP%]{text-align:center;padding:3rem 1rem}.message-view[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#495057}.message-view[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#6c757d}"],changeDetection:0})};function jd(i,t){if(i&1&&(a(0,"div",19),l(1),s()),i&2){let e=h();d(),V(" ",e.message," ")}}function Ud(i,t){if(i&1&&(a(0,"div",20),l(1),s()),i&2){let e=h();d(),V(" ",e.errorMessage," ")}}function zd(i,t){i&1&&(a(0,"div",21),l(1," A valid email is required. "),s())}var Ci=class i{constructor(t,e,n,r){this.fb=t;this.router=e;this.cdr=n;this.supabaseAuthService=r;this.forgotPasswordForm=this.fb.group({email:["",[H.required,H.email]]})}forgotPasswordForm;message=null;errorMessage=null;async onSubmit(){if(this.forgotPasswordForm.invalid){this.forgotPasswordForm.markAllAsTouched();return}let{email:t}=this.forgotPasswordForm.getRawValue();this.errorMessage=null,this.message=null;try{let{success:e,error:n}=await this.supabaseAuthService.requestPasswordReset(t);e?this.message="If an account with that email exists, you will receive a password reset link!":this.errorMessage=n?.message||"Failed to send reset link. Please try again.",this.cdr.markForCheck(),this.router.navigate([""])}catch(e){this.errorMessage=e.message||"An unexpected error occurred.",this.cdr.markForCheck()}}static \u0275fac=function(e){return new(e||i)(C(qe),C(ne),C(de),C(ht))};static \u0275cmp=K({type:i,selectors:[["app-forgot-password"]],decls:26,vars:5,consts:[[1,"auth-container"],[1,"auth-card"],[1,"text-center","mb-4"],[1,"logo-circle","mx-auto"],["src","/tr_logo.svg","alt","Logo",1,"img-fluid"],[1,"brand-name","mt-3"],[1,"brand-tagline"],["class","alert alert-info mb-3",4,"ngIf"],["class","alert alert-danger mb-3",4,"ngIf"],[1,"auth-form",3,"ngSubmit","formGroup"],[1,"mb-3"],["for","email",1,"form-label"],["type","email","id","email","formControlName","email","placeholder","Enter your email",1,"form-control"],["class","text-danger small mt-1",4,"ngIf"],[1,"d-grid","gap-2","mt-4"],["type","submit",1,"btn","btn-tr","btn-primary","btn-md",3,"disabled"],[1,"text-center","mt-4"],[1,"mb-0"],["routerLink","",1,"login-link"],[1,"alert","alert-info","mb-3"],[1,"alert","alert-danger","mb-3"],[1,"text-danger","small","mt-1"]],template:function(e,n){if(e&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),T(4,"img",4),s()(),a(5,"div",2)(6,"h2",5),l(7,"Forgot Password"),s(),a(8,"p",6),l(9,"Enter your email to receive a password reset link."),s()(),b(10,jd,2,1,"div",7)(11,Ud,2,1,"div",8),a(12,"form",9),g("ngSubmit",function(){return n.onSubmit()}),a(13,"div",10)(14,"label",11),l(15,"Email"),s(),T(16,"input",12),b(17,zd,2,0,"div",13),s(),a(18,"div",14)(19,"button",15),l(20,"Send Reset Link"),s()(),a(21,"div",16)(22,"p",17),l(23,"Remember your password? "),a(24,"a",18),l(25,"Login"),s()()()()()()),e&2){let r;d(10),f("ngIf",n.message),d(),f("ngIf",n.errorMessage),d(),f("formGroup",n.forgotPasswordForm),d(5),f("ngIf",((r=n.forgotPasswordForm.get("email"))==null?null:r.invalid)&&((r=n.forgotPasswordForm.get("email"))==null?null:r.touched)),d(2),f("disabled",n.forgotPasswordForm.invalid)}},dependencies:[X,te,Te,ze,ie,le,Ue,De,Fe,_e],styles:['.auth-container[_ngcontent-%COMP%]{min-height:100dvh;display:flex;align-items:center;justify-content:center}.auth-card[_ngcontent-%COMP%]{background-color:transparent;border-radius:12px;width:100%;max-width:450px;padding:30px}.logo-circle[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:50%;background-color:transparent;position:relative;display:flex;align-items:center;justify-content:center;margin:0 auto}.dots-circle[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:50%;position:relative;background-image:radial-gradient(circle,#5046e5 3px,transparent 3px);background-size:15px 15px;transform:rotate(45deg)}.brand-name[_ngcontent-%COMP%]{font-weight:700;font-size:24px;margin-bottom:5px;letter-spacing:.5px}.brand-tagline[_ngcontent-%COMP%]{color:#666;font-size:14px;margin:0}.tabs-container[_ngcontent-%COMP%]{display:inline-flex;align-items:center;border-bottom:1px solid #eee;padding-bottom:5px}.tab[_ngcontent-%COMP%]{padding:8px 15px;cursor:pointer;color:#888;font-weight:500;font-size:16px;transition:color .2s}.tab.active[_ngcontent-%COMP%]{color:#5046e5;border-bottom:2px solid #5046e5}.tab-separator[_ngcontent-%COMP%]{color:#ccc}.auth-form[_ngcontent-%COMP%]{margin-top:10px}.form-control[_ngcontent-%COMP%]{height:auto;padding:12px 15px;border-radius:8px;border:1px solid #ddd;transition:border-color .2s,box-shadow .2s}.form-control[_ngcontent-%COMP%]:focus{border-color:#5046e5;box-shadow:0 0 0 .2rem #5046e526}.form-label[_ngcontent-%COMP%]{font-weight:500;color:#555;margin-bottom:8px}.forgot-link[_ngcontent-%COMP%]{font-size:14px;color:#5046e5;text-decoration:none}.forgot-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.signup-link[_ngcontent-%COMP%], .login-link[_ngcontent-%COMP%]{color:#5046e5;font-weight:500;text-decoration:none}.signup-link[_ngcontent-%COMP%]:hover, .login-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.btn-primary[_ngcontent-%COMP%]{background-color:#5046e5;border-color:#5046e5;padding:12px;font-weight:500}.btn-primary[_ngcontent-%COMP%]:hover, .btn-primary[_ngcontent-%COMP%]:focus{background-color:#4238d0;border-color:#4238d0}.btn-primary[_ngcontent-%COMP%]:disabled{background-color:#a8a4e0;border-color:#a8a4e0}.separator[_ngcontent-%COMP%]{display:flex;align-items:center;text-align:center;color:#888;font-size:14px}.separator[_ngcontent-%COMP%]:before, .separator[_ngcontent-%COMP%]:after{content:"";flex:1;border-bottom:1px solid #ddd}.separator[_ngcontent-%COMP%]:before{margin-right:1em}.separator[_ngcontent-%COMP%]:after{margin-left:1em}.google-btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;background-color:#fff;border:1px solid #ddd;color:#333;padding:12px;font-weight:500}.google-btn[_ngcontent-%COMP%]:hover{background-color:#f8f8f8;color:#333}@media (max-width: 576px){.auth-card[_ngcontent-%COMP%]{padding:20px 15px}.brand-name[_ngcontent-%COMP%]{font-size:20px}.form-control[_ngcontent-%COMP%], .btn[_ngcontent-%COMP%]{padding:10px}}']})};function qd(i,t){if(i&1&&(a(0,"div",10),l(1),s()),i&2){let e=h();d(),V(" ",e.errorMessage," ")}}function Wd(i,t){if(i&1&&(a(0,"div",11),l(1),s()),i&2){let e=h();d(),V(" ",e.successMessage," ")}}function Gd(i,t){i&1&&(a(0,"div",25),l(1," Password must be at least 6 characters. "),s())}function Hd(i,t){i&1&&(a(0,"small",26),l(1," Passwords do not match "),s())}function $d(i,t){if(i&1){let e=j();a(0,"form",12),g("ngSubmit",function(){_(e);let r=h();return v(r.onSubmit())}),a(1,"div",13)(2,"label",14),l(3,"New Password"),s(),T(4,"input",15),b(5,Gd,2,0,"div",16),s(),a(6,"div",13)(7,"label",17),l(8,"Confirm New Password"),s(),T(9,"input",18),b(10,Hd,2,0,"small",19),s(),a(11,"div",20)(12,"button",21),l(13,"Update Password"),s()(),a(14,"div",22)(15,"p",23),l(16,"Go back to "),a(17,"a",24),l(18,"Login"),s()()()()}if(i&2){let e,n,r=h();f("formGroup",r.updatePasswordForm),d(5),f("ngIf",((e=r.updatePasswordForm.get("newPassword"))==null?null:e.invalid)&&((e=r.updatePasswordForm.get("newPassword"))==null?null:e.touched)),d(5),f("ngIf",r.updatePasswordForm.hasError("mismatch")&&((n=r.updatePasswordForm.get("confirmNewPassword"))==null?null:n.touched)),d(2),f("disabled",r.updatePasswordForm.invalid)}}var xi=class i{constructor(t,e,n,r,o){this.fb=t;this.router=e;this.route=n;this.cdr=r;this.supabase=o;this.updatePasswordForm=this.fb.group({newPassword:["",[H.required,H.minLength(6)]],confirmNewPassword:["",H.required]},{validators:this.passwordMatchValidator})}updatePasswordForm;errorMessage=null;successMessage=null;async ngOnInit(){try{let{data:t,error:e}=await this.supabase.GetClient().auth.getSession();if(e||!t.session){this.errorMessage="Invalid or expired reset link. Please request a new one.",this.cdr.markForCheck();return}this.router.navigate([],{queryParams:{returnUrl:this.route.snapshot.queryParamMap.get("returnUrl")},replaceUrl:!0})}catch{this.errorMessage="Something went wrong while verifying your reset link.",this.cdr.markForCheck()}}passwordMatchValidator(t){let e=t.get("newPassword")?.value,n=t.get("confirmNewPassword")?.value;return e===n?null:{mismatch:!0}}async onSubmit(){if(this.updatePasswordForm.invalid){this.updatePasswordForm.markAllAsTouched();return}let{newPassword:t}=this.updatePasswordForm.getRawValue();this.errorMessage=null,this.successMessage=null;try{let{error:e}=await this.supabase.GetClient().auth.updateUser({password:t});e?this.errorMessage=e.message:(this.successMessage="Your password has been updated successfully! Redirecting to login...",await this.supabase.GetClient().auth.signOut(),localStorage.clear(),sessionStorage.clear(),setTimeout(()=>this.router.navigate(["/auth"]),2500)),this.cdr.markForCheck()}catch(e){this.errorMessage=e.message||"An unexpected error occurred.",this.cdr.markForCheck()}}static \u0275fac=function(e){return new(e||i)(C(qe),C(ne),C(st),C(de),C(G))};static \u0275cmp=K({type:i,selectors:[["app-update-password"]],decls:13,vars:3,consts:[[1,"auth-container"],[1,"auth-card"],[1,"text-center","mb-4"],[1,"logo-circle","mx-auto"],["src","/tr_logo.svg","alt","Logo",1,"img-fluid"],[1,"brand-name","mt-3"],[1,"brand-tagline"],["class","alert alert-danger mb-3",4,"ngIf"],["class","alert alert-success mb-3",4,"ngIf"],["class","auth-form",3,"formGroup","ngSubmit",4,"ngIf"],[1,"alert","alert-danger","mb-3"],[1,"alert","alert-success","mb-3"],[1,"auth-form",3,"ngSubmit","formGroup"],[1,"mb-3"],["for","newPassword",1,"form-label"],["type","password","id","newPassword","formControlName","newPassword","placeholder","Enter new password",1,"form-control"],["class","text-danger small mt-1",4,"ngIf"],["for","confirmNewPassword",1,"form-label"],["type","password","id","confirmNewPassword","formControlName","confirmNewPassword","placeholder","Confirm new password",1,"form-control"],["class","text-danger",4,"ngIf"],[1,"d-grid","gap-2","mt-4"],["type","submit",1,"btn","btn-tr","btn-primary","btn-md",3,"disabled"],[1,"text-center","mt-4"],[1,"mb-0"],["routerLink","/auth",1,"login-link"],[1,"text-danger","small","mt-1"],[1,"text-danger"]],template:function(e,n){e&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),T(4,"img",4),s()(),a(5,"div",2)(6,"h2",5),l(7,"Set New Password"),s(),a(8,"p",6),l(9,"Please enter your new password."),s()(),b(10,qd,2,1,"div",7)(11,Wd,2,1,"div",8)(12,$d,19,4,"form",9),s()()),e&2&&(d(10),f("ngIf",n.errorMessage),d(),f("ngIf",n.successMessage),d(),f("ngIf",!n.errorMessage))},dependencies:[X,te,Te,ze,ie,le,Ue,De,Fe],styles:['.auth-container[_ngcontent-%COMP%]{min-height:100dvh;display:flex;align-items:center;justify-content:center}.auth-card[_ngcontent-%COMP%]{background-color:transparent;border-radius:12px;width:100%;max-width:450px;padding:30px}.logo-circle[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:50%;background-color:transparent;position:relative;display:flex;align-items:center;justify-content:center;margin:0 auto}.dots-circle[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:50%;position:relative;background-image:radial-gradient(circle,#5046e5 3px,transparent 3px);background-size:15px 15px;transform:rotate(45deg)}.brand-name[_ngcontent-%COMP%]{font-weight:700;font-size:24px;margin-bottom:5px;letter-spacing:.5px}.brand-tagline[_ngcontent-%COMP%]{color:#666;font-size:14px;margin:0}.tabs-container[_ngcontent-%COMP%]{display:inline-flex;align-items:center;border-bottom:1px solid #eee;padding-bottom:5px}.tab[_ngcontent-%COMP%]{padding:8px 15px;cursor:pointer;color:#888;font-weight:500;font-size:16px;transition:color .2s}.tab.active[_ngcontent-%COMP%]{color:#5046e5;border-bottom:2px solid #5046e5}.tab-separator[_ngcontent-%COMP%]{color:#ccc}.auth-form[_ngcontent-%COMP%]{margin-top:10px}.form-control[_ngcontent-%COMP%]{height:auto;padding:12px 15px;border-radius:8px;border:1px solid #ddd;transition:border-color .2s,box-shadow .2s}.form-control[_ngcontent-%COMP%]:focus{border-color:#5046e5;box-shadow:0 0 0 .2rem #5046e526}.form-label[_ngcontent-%COMP%]{font-weight:500;color:#555;margin-bottom:8px}.forgot-link[_ngcontent-%COMP%]{font-size:14px;color:#5046e5;text-decoration:none}.forgot-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.signup-link[_ngcontent-%COMP%], .login-link[_ngcontent-%COMP%]{color:#5046e5;font-weight:500;text-decoration:none}.signup-link[_ngcontent-%COMP%]:hover, .login-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.btn-primary[_ngcontent-%COMP%]{background-color:#5046e5;border-color:#5046e5;padding:12px;font-weight:500}.btn-primary[_ngcontent-%COMP%]:hover, .btn-primary[_ngcontent-%COMP%]:focus{background-color:#4238d0;border-color:#4238d0}.btn-primary[_ngcontent-%COMP%]:disabled{background-color:#a8a4e0;border-color:#a8a4e0}.separator[_ngcontent-%COMP%]{display:flex;align-items:center;text-align:center;color:#888;font-size:14px}.separator[_ngcontent-%COMP%]:before, .separator[_ngcontent-%COMP%]:after{content:"";flex:1;border-bottom:1px solid #ddd}.separator[_ngcontent-%COMP%]:before{margin-right:1em}.separator[_ngcontent-%COMP%]:after{margin-left:1em}.google-btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;background-color:#fff;border:1px solid #ddd;color:#333;padding:12px;font-weight:500}.google-btn[_ngcontent-%COMP%]:hover{background-color:#f8f8f8;color:#333}@media (max-width: 576px){.auth-card[_ngcontent-%COMP%]{padding:20px 15px}.brand-name[_ngcontent-%COMP%]{font-size:20px}.form-control[_ngcontent-%COMP%], .btn[_ngcontent-%COMP%]{padding:10px}}']})};function Kd(i,t){if(i&1&&(a(0,"option",14),l(1),s()),i&2){let e=t.$implicit;f("ngValue",e.id),d(),y(e.name)}}function Jd(i,t){if(i&1&&(a(0,"div",38)(1,"div",39),l(2),s(),a(3,"div",40),l(4),yt(5,"number"),s()()),i&2){let e=t.ngIf;d(2),y(e.name),d(2),V("Balance \u2022 ",sn(5,2,e.balance,"1.0-2"),"")}}function Yd(i,t){if(i&1){let e=j();a(0,"div",41)(1,"label",42),l(2,"Manual Balance (fallback)"),s(),a(3,"input",43),g("ngModelChange",function(r){_(e);let o=h();return o.manualBalance.set(r),v(o.resyncRiskFromPercentOrDollar())}),s(),a(4,"div",44),l(5,"Used only when selected account has no balance."),s()()}if(i&2){let e=h();d(3),f("ngModel",e.manualBalance())}}function Zd(i,t){if(i&1&&(a(0,"div",45),l(1),s()),i&2){let e=h();d(),y(e.aiMessage())}}function Xd(i,t){if(i&1&&(a(0,"div",46),l(1),s()),i&2){let e=h();d(),y(e.aiWarn())}}function eu(i,t){if(i&1&&(a(0,"div",47),l(1),s()),i&2){let e=h();d(),y(e.aiErr())}}function tu(i,t){i&1&&(a(0,"div",65),l(1,"Required for auto risk from SL."),s())}function nu(i,t){i&1&&(a(0,"div",44),l(1,"1.00 = standard lot"),s())}function iu(i,t){i&1&&(a(0,"div",65),l(1,"Required for auto risk from SL."),s())}function ru(i,t){if(i&1){let e=j();a(0,"div",10)(1,"div",48)(2,"div",49)(3,"label",42),l(4,"Instrument Type"),s(),a(5,"select",13),g("ngModelChange",function(r){_(e);let o=h();return o.instrumentType.set(r),v(o.recalcRiskFromSL())}),a(6,"option",50),l(7,"Forex"),s(),a(8,"option",51),l(9,"Metals"),s(),a(10,"option",52),l(11,"Indices"),s(),a(12,"option",53),l(13,"Stocks"),s(),a(14,"option",54),l(15,"Crypto"),s(),a(16,"option",55),l(17,"Other"),s()()(),a(18,"div",49)(19,"label",42),l(20,"Symbol"),s(),a(21,"input",56),R("ngModelChange",function(r){_(e);let o=h();return N(o.form.symbol,r)||(o.form.symbol=r),v(r)}),g("input",function(){_(e);let r=h();return v(r.recalcRiskFromSL())}),s()(),a(22,"div",49)(23,"label",42),l(24,"Direction"),s(),a(25,"select",13),R("ngModelChange",function(r){_(e);let o=h();return N(o.form.direction,r)||(o.form.direction=r),v(r)}),a(26,"option",57),l(27,"Long"),s(),a(28,"option",58),l(29,"Short"),s()()(),a(30,"div",49)(31,"label",42),l(32,"Entry Price"),s(),a(33,"input",59),R("ngModelChange",function(r){_(e);let o=h();return N(o.form.planned_entry_price,r)||(o.form.planned_entry_price=r),v(r)}),g("input",function(){_(e);let r=h();return v(r.recalcRiskFromSL())}),s(),b(34,tu,2,0,"div",60),s(),a(35,"div",49)(36,"label",42),l(37),s(),a(38,"input",61),R("ngModelChange",function(r){_(e);let o=h();return N(o.form.planned_lot_size,r)||(o.form.planned_lot_size=r),v(r)}),g("input",function(){_(e);let r=h();return v(r.recalcRiskFromSL())}),s(),b(39,nu,2,0,"div",62)(40,iu,2,0,"div",60),s(),a(41,"div",49)(42,"label",42),l(43,"Strategy Name"),s(),a(44,"input",63),R("ngModelChange",function(r){_(e);let o=h();return N(o.form.strategy_name,r)||(o.form.strategy_name=r),v(r)}),s()(),a(45,"div",41)(46,"label",42),l(47,"Tags (comma separated)"),s(),a(48,"input",64),R("ngModelChange",function(r){_(e);let o=h();return N(o.tagsStr,r)||(o.tagsStr=r),v(r)}),s()()()()}if(i&2){let e=h();d(5),f("ngModel",e.instrumentType()),d(16),O("ngModel",e.form.symbol),d(4),O("ngModel",e.form.direction),d(8),O("ngModel",e.form.planned_entry_price),d(),f("ngIf",!e.form.planned_entry_price),d(3),y(e.isForex()?"Lot Size (lots)":"Quantity / Contracts"),d(),O("ngModel",e.form.planned_lot_size),d(),f("ngIf",e.isForex()),d(),f("ngIf",!e.form.planned_lot_size),d(4),O("ngModel",e.form.strategy_name),d(4),O("ngModel",e.tagsStr)}}function ou(i,t){i&1&&(a(0,"div",65),l(1,"Required for auto risk from SL."),s())}function su(i,t){if(i&1){let e=j();a(0,"div",49)(1,"label",42),l(2,"$ per pip (per 1.00 lot)"),s(),a(3,"input",75),g("ngModelChange",function(r){_(e);let o=h(3);return o.pipValuePerStdLot.set(r),v(o.recalcRiskFromSL())}),s(),a(4,"div",44),l(5,"Default 10 for most FX; JPY pairs pip size 0.01."),s()()}if(i&2){let e=h(3);d(3),f("ngModel",e.pipValuePerStdLot())}}function au(i,t){if(i&1&&(Ge(0),b(1,su,6,1,"div",74),He()),i&2){let e=h(2);d(),f("ngIf",e.autoRiskFromSL())}}function lu(i,t){if(i&1){let e=j();a(0,"div",49)(1,"label",42),l(2,"Point Size"),s(),a(3,"input",76),g("ngModelChange",function(r){_(e);let o=h(3);return o.pointSize.set(r),v(o.recalcRiskFromSL())}),s(),a(4,"div",44),l(5,"e.g., 0.01; adjust per instrument."),s()()}if(i&2){let e=h(3);d(3),f("ngModel",e.pointSize())}}function cu(i,t){if(i&1){let e=j();a(0,"div",49)(1,"label",42),l(2,"$ per point (per 1 unit)"),s(),a(3,"input",77),g("ngModelChange",function(r){_(e);let o=h(3);return o.valuePerPointPerUnit.set(r),v(o.recalcRiskFromSL())}),s()()}if(i&2){let e=h(3);d(3),f("ngModel",e.valuePerPointPerUnit())}}function du(i,t){if(i&1){let e=j();a(0,"div",49)(1,"label",42),l(2,"Contract Multiplier"),s(),a(3,"input",75),g("ngModelChange",function(r){_(e);let o=h(3);return o.contractMultiplier.set(r),v(o.recalcRiskFromSL())}),s(),a(4,"div",44),l(5,"1 for shares. Use broker spec for CFDs/indices."),s()()}if(i&2){let e=h(3);d(3),f("ngModel",e.contractMultiplier())}}function uu(i,t){if(i&1&&b(0,lu,6,1,"div",74)(1,cu,4,1,"div",74)(2,du,6,1,"div",74),i&2){let e=h(2);f("ngIf",e.autoRiskFromSL()),d(),f("ngIf",e.autoRiskFromSL()),d(),f("ngIf",e.autoRiskFromSL())}}function mu(i,t){if(i&1){let e=j();a(0,"div",10)(1,"div",48)(2,"div",66)(3,"label",42),l(4,"Stop Loss Price"),s(),a(5,"input",67),R("ngModelChange",function(r){_(e);let o=h();return N(o.form.planned_stop_loss,r)||(o.form.planned_stop_loss=r),v(r)}),g("input",function(){_(e);let r=h();return v(r.recalcRiskFromSL())}),s(),b(6,ou,2,0,"div",60),s(),a(7,"div",66)(8,"label",42),l(9,"Take Profit Price"),s(),a(10,"input",68),R("ngModelChange",function(r){_(e);let o=h();return N(o.form.planned_take_profit,r)||(o.form.planned_take_profit=r),v(r)}),s()(),b(11,au,2,1,"ng-container",69)(12,uu,3,3,"ng-template",null,0,Qe),a(14,"div",49)(15,"label",42),l(16,"Risk % per Trade"),s(),a(17,"input",70),R("ngModelChange",function(r){_(e);let o=h();return N(o.form.planned_risk_percentage,r)||(o.form.planned_risk_percentage=r),v(r)}),g("input",function(){_(e);let r=h();return v(r.onRiskPercentChange())}),s(),a(18,"div",44),l(19),yt(20,"number"),s()(),a(21,"div",49)(22,"label",42),l(23,"Risk $ per Trade"),s(),a(24,"input",70),R("ngModelChange",function(r){_(e);let o=h();return N(o.form.planned_risk_amount,r)||(o.form.planned_risk_amount=r),v(r)}),g("input",function(){_(e);let r=h();return v(r.onRiskDollarChange())}),s(),a(25,"div",44),l(26),s()(),a(27,"div",49)(28,"div",71)(29,"div",72),l(30,"Reward:Risk Ratio"),s(),a(31,"div",73),l(32),s(),a(33,"div",4),l(34,"Auto-calculated"),s()()()()()}if(i&2){let e=$e(13),n=h();d(5),O("ngModel",n.form.planned_stop_loss),d(),f("ngIf",!n.form.planned_stop_loss),d(4),O("ngModel",n.form.planned_take_profit),d(),f("ngIf",n.isForex())("ngIfElse",e),d(6),O("ngModel",n.form.planned_risk_percentage),d(2),Ut("\u2248 ",n.riskDollarPreview()," (from ",sn(20,11,n.baseBalance(),"1.0-2")," balance)"),d(5),O("ngModel",n.form.planned_risk_amount),d(2),V("\u2248 ",n.riskPercentPreview()," of balance"),d(6),y(n.rrRatio())}}function pu(i,t){if(i&1){let e=j();a(0,"div",10)(1,"label",42),l(2,"Entry Criteria (Why are you taking this trade?) *"),s(),a(3,"textarea",78),R("ngModelChange",function(r){_(e);let o=h();return N(o.form.entry_criteria,r)||(o.form.entry_criteria=r),v(r)}),s(),a(4,"div",79),l(5),s()()}if(i&2){let e=h();d(3),O("ngModel",e.form.entry_criteria),d(),D("text-danger",e.wordCount()<50),d(),V(" Current: ",e.wordCount()," words (minimum 50 required) ")}}function hu(i,t){if(i&1){let e=j();a(0,"div",10)(1,"div",48)(2,"div",49)(3,"label",42),l(4,"Current Emotional State"),s(),a(5,"select",13),R("ngModelChange",function(r){_(e);let o=h();return N(o.form.emotional_before_state,r)||(o.form.emotional_before_state=r),v(r)}),a(6,"option",14),l(7,"Select emotional state"),s(),a(8,"option"),l(9,"calm"),s(),a(10,"option"),l(11,"confident"),s(),a(12,"option"),l(13,"anxious"),s(),a(14,"option"),l(15,"fearful"),s(),a(16,"option"),l(17,"euphoric"),s()()(),a(18,"div",49)(19,"label",42),l(20,"Potential Bias"),s(),a(21,"select",13),R("ngModelChange",function(r){_(e);let o=h();return N(o.form.emotional_before_potential_bias,r)||(o.form.emotional_before_potential_bias=r),v(r)}),a(22,"option"),l(23,"None - Clear Mindset"),s(),a(24,"option"),l(25,"FOMO"),s(),a(26,"option"),l(27,"Revenge"),s(),a(28,"option"),l(29,"Confirmation"),s(),a(30,"option"),l(31,"Overconfidence"),s()()(),a(32,"div",49)(33,"label",80),l(34,"Trade Confidence (1-5)"),s(),a(35,"input",81),R("ngModelChange",function(r){_(e);let o=h();return N(o.form.confidence_before_level,r)||(o.form.confidence_before_level=r),v(r)}),s(),a(36,"div",82)(37,"span"),l(38,"Low"),s(),a(39,"span"),l(40,"Medium"),s(),a(41,"span"),l(42,"High"),s()(),a(43,"div"),l(44),s()(),a(45,"div",41)(46,"label",42),l(47,"Additional Notes"),s(),a(48,"textarea",83),R("ngModelChange",function(r){_(e);let o=h();return N(o.form.additional_notes,r)||(o.form.additional_notes=r),v(r)}),s()()()()}if(i&2){let e,n=h();d(5),O("ngModel",n.form.emotional_before_state),d(),f("ngValue",null),d(15),O("ngModel",n.form.emotional_before_potential_bias),d(14),O("ngModel",n.form.confidence_before_level),d(9),V("Confidence Level: ",(e=n.form.confidence_before_level)!==null&&e!==void 0?e:3,""),d(4),O("ngModel",n.form.additional_notes)}}function fu(i,t){if(i&1&&(a(0,"div",84),l(1),s()),i&2){let e=h();d(),y(e.uc.error())}}function gu(i,t){if(i&1&&(a(0,"div",85),l(1),s()),i&2){let e=h();d(),V(" ",e.isEditing()?"Updated!":"Saved!"," You can move to \u201CPlanned Trades\u201D. ")}}var Si=class i{constructor(t,e,n){this.uc=t;this.route=e;this.router=n}ngOnInit(){this.uc.loadAccounts(),this.loadEditIfAny(),bt(()=>{let t=this.accounts();!this.accountId()&&t.length===1&&this.accountId.set(t[0].id)})}multiOpen=A(!1);basicOpen=A(!0);riskOpen=A(!0);analysisOpen=A(!1);emotionOpen=A(!1);setAll(t){this.basicOpen.set(t),this.riskOpen.set(t),this.analysisOpen.set(t),this.emotionOpen.set(t)}toggle(t){if(this.multiOpen()){let e=this.getState(t);e.set(!e())}else{let e=this.getState(t)();this.setAll(!1),this.getState(t).set(!e)}}getState(t){return t==="basic"?this.basicOpen:t==="risk"?this.riskOpen:t==="analysis"?this.analysisOpen:this.emotionOpen}dzDrag=!1;onDzDrag(t){t.preventDefault(),this.dzDrag=!0}onDzDrop(t){t.preventDefault(),this.dzDrag=!1;let e=t.dataTransfer?.files?.[0];e&&this.handleChart(e)}accounts=oe(()=>this.uc.accounts().map(t=>({id:t.account_id,name:t.account_name,balance:Number(t.balance??0)})));accountId=A(null);selectedAccount=oe(()=>this.accounts().find(t=>t.id===this.accountId())??null);manualBalance=A(0);baseBalance=oe(()=>{let t=Number(this.selectedAccount()?.balance??0);return t>0?t:Number(this.manualBalance()||0)});instrumentType=A("forex");isForex=()=>this.instrumentType()==="forex";autoRiskFromSL=A(!0);pipValuePerStdLot=A(10);pointSize=A(.01);valuePerPointPerUnit=A(1);contractMultiplier=A(1);editingTradeId=A(null);isEditing=oe(()=>this.editingTradeId()!==null);form={symbol:"",direction:"LONG",planned_entry_price:null,planned_stop_loss:null,planned_take_profit:null,planned_lot_size:null,planned_risk_percentage:null,planned_risk_amount:null,strategy_name:"",entry_criteria:"",emotional_before_state:null,emotional_before_potential_bias:"None - Clear Mindset",confidence_before_level:3,additional_notes:null};tagsStr="";success=A(!1);aiMessage=A(null);aiWarn=A(null);aiErr=A(null);wordCount(){let t=(this.form.entry_criteria??"").toString().trim();return t?t.split(/\s+/).length:0}syncOnBalanceChange=bt(()=>{let t=this.baseBalance(),e=Number(this.form.planned_risk_percentage??0),n=Number(this.form.planned_risk_amount??0);t&&(e>0?this.form.planned_risk_amount=+(e/100*t).toFixed(2):n>0&&(this.form.planned_risk_percentage=+(n/t*100).toFixed(2)))});riskPercentPreview=oe(()=>{let t=this.baseBalance(),e=Number(this.form.planned_risk_amount??0),n=t?e/t*100:Number(this.form.planned_risk_percentage??0);return`${(isFinite(n)?n:0).toFixed(2)}%`});riskDollarPreview=oe(()=>{let t=this.baseBalance(),n=Number(this.form.planned_risk_percentage??0)/100*t,r=Number(this.form.planned_risk_amount??0)||n;return`$${(isFinite(r)?r:0).toFixed(2)}`});rrRatio=oe(()=>{let t=Number(this.form.planned_entry_price??0),e=Number(this.form.planned_stop_loss??0),n=Number(this.form.planned_take_profit??0);if(!t||!e||!n)return"\u2014";let r=Math.abs(t-e),o=Math.abs(n-t);return r?`1:${(o/r).toFixed(2)}`:"\u2014"});pipSizeFor(t){let e=(t||"").toUpperCase().trim();return e&&/JPY$/.test(e)?.01:1e-4}applyRiskAmount(t){let e=this.baseBalance(),n=+Number(t||0).toFixed(2);this.form.planned_risk_amount=n,this.form.planned_risk_percentage=e?+(n/e*100).toFixed(2):this.form.planned_risk_percentage}recalcRiskFromSL_FX(){let t=Number(this.form.planned_entry_price??0),e=Number(this.form.planned_stop_loss??0),n=Number(this.form.planned_lot_size??0);if(!t||!e||!n)return;let r=this.pipSizeFor(this.form.symbol),c=Math.abs(t-e)/r*this.pipValuePerStdLot()*n;this.applyRiskAmount(c)}recalcRiskFromSL_NonFX(){let t=Number(this.form.planned_entry_price??0),e=Number(this.form.planned_stop_loss??0),n=Number(this.form.planned_lot_size??0);if(!t||!e||!n)return;let r=Number(this.pointSize()||0),o=Number(this.valuePerPointPerUnit()||0),c=Number(this.contractMultiplier()||1);if(!r||!o)return;let p=Math.abs(t-e)/r*o*n*c;this.applyRiskAmount(p)}recalcRiskFromSL(){this.autoRiskFromSL()&&(this.isForex()?this.recalcRiskFromSL_FX():this.recalcRiskFromSL_NonFX())}recomputeOnInputs=bt(()=>{let t=this.autoRiskFromSL(),e=this.instrumentType(),n=this.form.symbol,r=this.form.planned_entry_price,o=this.form.planned_stop_loss,c=this.form.planned_lot_size,u=this.pipValuePerStdLot(),p=this.pointSize(),m=this.valuePerPointPerUnit(),w=this.contractMultiplier();this.recalcRiskFromSL()});onRiskPercentChange(){let t=this.baseBalance(),e=Number(this.form.planned_risk_percentage??0);this.form.planned_risk_amount=t&&e>0?+(e/100*t).toFixed(2):null}onRiskDollarChange(){let t=this.baseBalance(),e=Number(this.form.planned_risk_amount??0);this.form.planned_risk_percentage=t&&e>0?+(e/t*100).toFixed(2):null}resyncRiskFromPercentOrDollar(){this.form.planned_risk_percentage?this.onRiskPercentChange():this.form.planned_risk_amount&&this.onRiskDollarChange()}canSubmit(){return!0}async onChartFile(t){let e=t.target.files?.[0];e&&await this.handleChart(e)}async handleChart(t){this.aiErr.set(null),this.aiWarn.set(null),this.aiMessage.set("Analyzing chart\u2026");let e=await this.uc.analyzeChart(t);if(!e){this.aiMessage.set(null),this.aiErr.set(this.uc.error()||"Could not analyze the image.");return}if(!e.is_relevant){this.aiMessage.set(null),this.aiWarn.set("Image does not look like a trading/chart screenshot. Nothing applied.");return}this.applyAiPrefill(e),this.aiMessage.set(`Fields prefilled (confidence ${Math.round((e.confidence??0)*100)}%). Review before saving.`)}applyAiPrefill(t){let e=n=>Number.isFinite(Number(n))?Number(n):null;t.symbol!=null&&(this.form.symbol=t.symbol||""),t.direction!=null&&(this.form.direction=t.direction||"LONG"),this.form.planned_entry_price=e(t.planned_entry_price)??this.form.planned_entry_price??null,this.form.planned_stop_loss=e(t.planned_stop_loss)??this.form.planned_stop_loss??null,this.form.planned_take_profit=e(t.planned_take_profit)??this.form.planned_take_profit??null,this.form.planned_lot_size=e(t.planned_lot_size)??this.form.planned_lot_size??null,this.form.planned_risk_percentage=e(t.planned_risk_percentage)??this.form.planned_risk_percentage??null,this.form.planned_risk_amount=e(t.planned_risk_amount)??this.form.planned_risk_amount??null,t.strategy_name!=null&&(this.form.strategy_name=t.strategy_name||""),t.entry_criteria&&(this.form.entry_criteria=t.entry_criteria),Array.isArray(t.tags)&&(this.tagsStr=t.tags.map(n=>String(n).trim().toLowerCase()).filter(Boolean).join(", ")),this.recalcRiskFromSL()}async save(){this.success.set(!1);let t=Z(W({},this.form),{account_id:this.accountId(),tags:this.tagsStr.split(",").map(n=>n.trim()).filter(Boolean)}),e=this.editingTradeId();e?await this.uc.updatePlanned(e,t):await this.uc.createPlanned(t),this.uc.error()||(this.success.set(!0),this.router.navigate(["/tradejournal"],{queryParams:{tab:"PLANNED"}}))}cancelEdit(){this.router.navigate([],{queryParams:{}}),this.editingTradeId.set(null),this.success.set(!1)}async loadEditIfAny(){let t=this.route.snapshot.queryParamMap.get("edit")||null;if(!t)return;this.editingTradeId.set(t);let e=this.uc.trades.find(n=>n.trade_id===t);!e&&this.uc.getTradeById&&(e=await this.uc.getTradeById(t)),e&&(this.accounts().length||await this.uc.loadAccounts(),this.prefillFromTrade(e))}prefillFromTrade(t){this.accountId.set(t.account_id??null),this.form={symbol:t.symbol??"",direction:t.direction??"LONG",planned_entry_price:t.planned_entry_price??null,planned_stop_loss:t.planned_stop_loss??null,planned_take_profit:t.planned_take_profit??null,planned_lot_size:t.planned_lot_size??null,planned_risk_percentage:t.planned_risk_percentage??null,planned_risk_amount:t.planned_risk_amount??null,strategy_name:t.strategy_name??"",entry_criteria:t.entry_criteria??"",emotional_before_state:t.emotional_before_state??null,emotional_before_potential_bias:t.emotional_before_potential_bias??"None - Clear Mindset",confidence_before_level:t.confidence_before_level??3,additional_notes:t.additional_notes??null},this.tagsStr=Array.isArray(t.tags)?t.tags.join(", "):"",this.recalcRiskFromSL()}static \u0275fac=function(e){return new(e||i)(C(Nn),C(st),C(ne))};static \u0275cmp=K({type:i,selectors:[["app-pretradeform"]],decls:84,vars:28,consts:[["nonForexBlock",""],[1,"container","my-4","page-shell"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"mb-0"],[1,"muted"],[1,"d-flex","align-items-center","gap-2"],["routerLink","/tradeaccounts",1,"btn","btn-light","border","ms-2"],[1,"me-2"],[1,"section-card","mb-3"],[1,"section-head"],[1,"p-3"],[1,"row","g-3","align-items-center"],[1,"col-md-8"],[1,"form-select",3,"ngModelChange","ngModel"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"col-md-4","d-flex"],["class","acct-pill w-100",4,"ngIf"],["class","col-12",4,"ngIf"],[1,"muted","mb-2"],[1,"dropzone",3,"dragover","dragleave","drop"],[1,"dz-icon"],[1,"fw-semibold"],[1,"btn","btn-outline-primary","mt-2"],["type","file","accept","image/png,image/jpeg",1,"d-none",3,"change"],["class","alert alert-info mt-2 py-2 px-3",4,"ngIf"],["class","alert alert-warning mt-2 py-2 px-3",4,"ngIf"],["class","alert alert-danger mt-2 py-2 px-3",4,"ngIf"],["role","button",1,"section-head",3,"click"],[1,"badge-req","ms-2"],[1,"chev","ms-2"],["class","p-3",4,"ngIf"],[1,"text-danger"],[1,"badge-opt","ms-2"],[1,"mt-3"],[1,"btn","btn-primary","w-100",3,"click","disabled"],["class","alert alert-danger mt-3",4,"ngIf"],["class","alert alert-success mt-3",4,"ngIf"],[1,"acct-pill","w-100"],[1,"fw-semibold","small"],[1,"small"],[1,"col-12"],[1,"form-label"],["type","number","step","0.01","placeholder","Enter your account balance to enable Risk % \u2192 $",1,"form-control",3,"ngModelChange","ngModel"],[1,"hint"],[1,"alert","alert-info","mt-2","py-2","px-3"],[1,"alert","alert-warning","mt-2","py-2","px-3"],[1,"alert","alert-danger","mt-2","py-2","px-3"],[1,"row","g-3"],[1,"col-md-4"],["value","forex"],["value","metal"],["value","index"],["value","stock"],["value","crypto"],["value","other"],["placeholder","e.g., AUDNZD / XAUUSD / SPX",1,"form-control",3,"ngModelChange","input","ngModel"],["value","LONG"],["value","SHORT"],["type","number","step","0.000001","placeholder","1.0875",1,"form-control",3,"ngModelChange","input","ngModel"],["class","warn",4,"ngIf"],["type","number","step","0.0001","placeholder","0.01",1,"form-control",3,"ngModelChange","input","ngModel"],["class","hint",4,"ngIf"],["placeholder","e.g., FVG Retracement",1,"form-control",3,"ngModelChange","ngModel"],["placeholder","e.g., fvg, retracement, support",1,"form-control",3,"ngModelChange","ngModel"],[1,"warn"],[1,"col-md-6"],["type","number","step","0.000001","placeholder","1.0850",1,"form-control",3,"ngModelChange","input","ngModel"],["type","number","step","0.000001","placeholder","1.0925",1,"form-control",3,"ngModelChange","ngModel"],[4,"ngIf","ngIfElse"],["type","number","step","0.01",1,"form-control",3,"ngModelChange","input","ngModel"],[1,"metric","good"],[1,"label"],[1,"value"],["class","col-md-4",4,"ngIf"],["type","number","step","0.01",1,"form-control",3,"ngModelChange","ngModel"],["type","number","step","0.000001",1,"form-control",3,"ngModelChange","ngModel"],["type","number","step","0.0001",1,"form-control",3,"ngModelChange","ngModel"],["rows","6","placeholder","Explain your technicals, fundamentals, market conditions, setup confirmation, etc.",1,"form-control",3,"ngModelChange","ngModel"],[1,"mt-1","small"],[1,"form-label","d-block"],["type","range","min","1","max","5",1,"form-range",3,"ngModelChange","ngModel"],[1,"d-flex","justify-content-between","small","muted"],["rows","3","placeholder","Document any important notes for this trade",1,"form-control",3,"ngModelChange","ngModel"],[1,"alert","alert-danger","mt-3"],[1,"alert","alert-success","mt-3"]],template:function(e,n){e&1&&(a(0,"div",1)(1,"div",2)(2,"div")(3,"h4",3),l(4),s(),a(5,"small",4),l(6),s()(),a(7,"div",5)(8,"a",6)(9,"span",7),l(10,"\u2699\uFE0F"),s(),l(11,"Manage Accounts"),s()()(),a(12,"div",8)(13,"div",9),l(14,"Trading Account"),s(),a(15,"div",10)(16,"div",11)(17,"div",12)(18,"select",13),g("ngModelChange",function(o){return n.accountId.set(o)}),a(19,"option",14),l(20,"Select an account"),s(),b(21,Kd,2,2,"option",15),s()(),a(22,"div",16),b(23,Jd,6,5,"div",17),s(),b(24,Yd,6,1,"div",18),s()()(),a(25,"div",8)(26,"div",9)(27,"span"),l(28,"\u{1F4C8}"),s(),l(29," Chart Image Analysis"),s(),a(30,"div",10)(31,"div",19),l(32,"Upload your analyzed chart image and let AI automatically fill your trade fields"),s(),a(33,"div",20),g("dragover",function(o){return n.onDzDrag(o)})("dragleave",function(){return n.dzDrag=!1})("drop",function(o){return n.onDzDrop(o)}),a(34,"div",21),l(35,"\u2B06\uFE0E"),s(),a(36,"div",22),l(37,"Upload Chart Image"),s(),a(38,"small",4),l(39,"PNG/JPG up to 10MB"),s(),a(40,"label",23),l(41,"Choose File "),a(42,"input",24),g("change",function(o){return n.onChartFile(o)}),s()()(),b(43,Zd,2,1,"div",25)(44,Xd,2,1,"div",26)(45,eu,2,1,"div",27),s()(),a(46,"div",8)(47,"div",28),g("click",function(){return n.toggle("basic")}),l(48," Basic Trade Information "),a(49,"span",29),l(50,"Required"),s(),a(51,"span",30),l(52,"\u25BE"),s()(),b(53,ru,49,11,"div",31),s(),a(54,"div",8)(55,"div",28),g("click",function(){return n.toggle("risk")}),a(56,"span",32),l(57,"Risk Management"),s(),a(58,"span",29),l(59,"Critical"),s(),a(60,"span",30),l(61,"\u25BE"),s()(),b(62,mu,35,14,"div",31),s(),a(63,"div",8)(64,"div",28),g("click",function(){return n.toggle("analysis")}),l(65," Trade Analysis "),a(66,"span",29),l(67,"Required \u2013 Min 100 words"),s(),a(68,"span",30),l(69,"\u25BE"),s()(),b(70,pu,6,4,"div",31),s(),a(71,"div",8)(72,"div",28),g("click",function(){return n.toggle("emotion")}),l(73," Emotional Check-In "),a(74,"span",33),l(75,"Optional but Recommended"),s(),a(76,"span",30),l(77,"\u25BE"),s()(),b(78,hu,49,6,"div",31),s(),a(79,"div",34)(80,"button",35),g("click",function(){return n.save()}),l(81),s()(),b(82,fu,2,1,"div",36)(83,gu,2,1,"div",37),s()),e&2&&(d(4),y(n.isEditing()?"Edit Trade Plan \u2022 "+(n.form.symbol||"-"):"Pre-Trade Plan"),d(2),y(n.isEditing()?"Editing existing planned trade":"Complete your trading plan step by step"),d(12),f("ngModel",n.accountId()),d(),f("ngValue",null),d(2),f("ngForOf",n.accounts()),d(2),f("ngIf",n.selectedAccount()),d(),f("ngIf",n.baseBalance()===0),d(9),D("drag",n.dzDrag),d(10),f("ngIf",n.aiMessage()),d(),f("ngIf",n.aiWarn()),d(),f("ngIf",n.aiErr()),d(6),D("rot",n.basicOpen()),d(2),f("ngIf",n.basicOpen()),d(7),D("rot",n.riskOpen()),d(2),f("ngIf",n.riskOpen()),d(6),D("rot",n.analysisOpen()),d(2),f("ngIf",n.analysisOpen()),d(6),D("rot",n.emotionOpen()),d(2),f("ngIf",n.emotionOpen()),d(2),f("disabled",!n.canSubmit()),d(),V(" ",n.isEditing()?"Update Trade Plan":"Submit Trade Plan"," "),d(),f("ngIf",n.uc.error()),d(),f("ngIf",n.success()))},dependencies:[X,Ve,te,Fn,pt,Jt,Yt,ie,kt,Er,mt,le,et,Te,_e],styles:[".page-shell[_ngcontent-%COMP%]{max-width:980px}.section-card[_ngcontent-%COMP%]{border:1px solid #e9eef5;border-radius:14px;overflow:hidden}.section-head[_ngcontent-%COMP%]{background:#f7f9fc;border-bottom:1px solid #eef2f7;padding:.85rem 1rem;font-weight:600;display:flex;align-items:center;gap:.5rem;cursor:pointer}.badge-req[_ngcontent-%COMP%]{color:#b30000;background:#ffecec;font-weight:600}.badge-opt[_ngcontent-%COMP%]{color:#7a5b00;background:#fff6d6;font-weight:600}.chev[_ngcontent-%COMP%]{margin-left:auto;opacity:.6;transition:transform .15s ease}.chev.rot[_ngcontent-%COMP%]{transform:rotate(180deg)}.acct-pill[_ngcontent-%COMP%]{background:#f1f5ff;border:1px solid #dfebff;color:#2c5cff;border-radius:10px;padding:.5rem .75rem}.dropzone[_ngcontent-%COMP%]{border:2px dashed #b8cdfa;border-radius:12px;background:#fbfdff;min-height:200px;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;gap:.5rem}.dropzone.drag[_ngcontent-%COMP%]{background:#f0f6ff}.dz-icon[_ngcontent-%COMP%]{font-size:34px;width:34px;height:34px;border-radius:50%;background:#eaf1ff;display:grid;place-items:center}.metric[_ngcontent-%COMP%]{border:1px solid #eef2f7;border-radius:12px;padding:.75rem;background:#fff;height:100%}.metric[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:.78rem;color:#6b7280}.metric[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-weight:700}.metric.good[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:#0a8a00}.metric.warn[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:#b30000}.muted[_ngcontent-%COMP%]{color:#8a94a6}.hint[_ngcontent-%COMP%]{font-size:.8rem;color:#6b7280;margin-top:.25rem}.warn[_ngcontent-%COMP%]{font-size:.85rem;color:#b30000;margin-top:.25rem}"]})};var _u=["miniChart"],vu=()=>[];function yu(i,t){if(i&1){let e=j();a(0,"tr")(1,"td",37),l(2),s(),a(3,"td",8),l(4),s(),a(5,"td"),l(6),s(),a(7,"td"),l(8),s(),a(9,"td"),l(10),s(),a(11,"td"),l(12),s(),a(13,"td")(14,"span",38),l(15,"planned"),s()(),a(16,"td",26)(17,"div",39)(18,"button",40),g("click",function(){let r=_(e).$implicit,o=h(2);return v(o.edit(r))}),l(19,"Edit"),s(),a(20,"button",41),g("click",function(){let r=_(e).$implicit,o=h(2);return v(o.openExecute(r))}),l(21,"Trade Executed"),s(),a(22,"button",42),g("click",function(){let r=_(e).$implicit,o=h(2);return v(o.remove(r))}),l(23,"Delete"),s()()()()}if(i&2){let e=t.$implicit,n=h(2);d(2),y(e.symbol),d(),D("dir-long",e.direction==="LONG")("dir-short",e.direction==="SHORT"),d(),y(e.direction),d(2),y(n.asMoney(e.planned_entry_price)),d(2),y(e.strategy_name||"\u2014"),d(2),y(e.emotional_before_state||"\u2014"),d(2),y(n.dateOnly(e.planned_at||e.created_at))}}function bu(i,t){if(i&1&&(a(0,"tbody"),b(1,yu,24,10,"tr",36),s()),i&2){let e=h();d(),f("ngForOf",e.viewRows())("ngForTrackBy",e.trackById)}}function wu(i,t){if(i&1){let e=j();a(0,"tr")(1,"td",37),l(2),s(),a(3,"td",8),l(4),s(),a(5,"td"),l(6),s(),a(7,"td"),l(8),s(),a(9,"td"),l(10),s(),a(11,"td"),l(12),s(),a(13,"td")(14,"span",38),l(15,"executing"),s()(),a(16,"td",26)(17,"div",39)(18,"button",40),g("click",function(){let r=_(e).$implicit,o=h(2);return v(o.editExecuting(r))}),l(19,"Edit"),s(),a(20,"button",43),g("click",function(){let r=_(e).$implicit,o=h(2);return v(o.openComplete(r))}),l(21,"Complete"),s()()()()}if(i&2){let e,n=t.$implicit,r=h(2);d(2),y(n.symbol),d(),D("dir-long",n.direction==="LONG")("dir-short",n.direction==="SHORT"),d(),y(n.direction),d(2),y(r.asMoney((e=n.actual_entry_price)!==null&&e!==void 0?e:n.planned_entry_price)),d(2),y(n.strategy_name||"\u2014"),d(2),y(n.emotional_before_state||"\u2014"),d(2),y(r.dateOnly(n.actual_entry_date))}}function Cu(i,t){if(i&1&&(a(0,"tbody"),b(1,wu,22,10,"tr",36),s()),i&2){let e=h();d(),f("ngForOf",e.viewRows())("ngForTrackBy",e.trackById)}}function xu(i,t){if(i&1){let e=j();a(0,"tr")(1,"td",37),l(2),s(),a(3,"td",8),l(4),s(),a(5,"td"),l(6),s(),a(7,"td"),l(8),s(),a(9,"td"),l(10),s(),a(11,"td"),l(12),s(),a(13,"td")(14,"span",44),l(15,"completed"),s()(),a(16,"td",26)(17,"button",40),g("click",function(){let r=_(e).$implicit,o=h(2);return v(o.openView(r))}),l(18,"View"),s()()()}if(i&2){let e=t.$implicit,n=h(2);d(2),y(e.symbol),d(),D("dir-long",e.direction==="LONG")("dir-short",e.direction==="SHORT"),d(),y(e.direction),d(2),y(n.asMoney(e.exit_price)),d(2),y(e.strategy_name||"\u2014"),d(2),y(e.emotional_after_state||e.emotional_before_state||"\u2014"),d(2),y(n.dateOnly(e.exit_date))}}function Su(i,t){if(i&1&&(a(0,"tbody"),b(1,xu,19,10,"tr",36),s()),i&2){let e=h();d(),f("ngForOf",e.viewRows())("ngForTrackBy",e.trackById)}}function Eu(i,t){i&1&&(a(0,"div",45),l(1,"No trades yet."),s())}function Tu(i,t){if(i&1&&(a(0,"div",46),l(1),s()),i&2){let e=h();d(),y(e.uc.error())}}function Mu(i,t){i&1&&T(0,"div",47)}function Iu(i,t){if(i&1){let e=j();a(0,"div",48)(1,"div",49)(2,"div",50)(3,"div")(4,"h5",51),l(5),s(),a(6,"div",52),l(7," Enter the actual execution details for "),a(8,"strong"),l(9),s(),l(10),s()(),a(11,"button",53),g("click",function(){_(e);let r=h();return v(r.closeExec())}),s()(),a(12,"div",54)(13,"div",55)(14,"label",56),l(15,"Entry Price"),s(),a(16,"input",57),R("ngModelChange",function(r){_(e);let o=h();return N(o.execForm.actual_entry_price,r)||(o.execForm.actual_entry_price=r),v(r)}),s()(),a(17,"div",55)(18,"label",56),l(19,"Stop Loss"),s(),a(20,"input",58),R("ngModelChange",function(r){_(e);let o=h();return N(o.execForm.actual_stop_loss,r)||(o.execForm.actual_stop_loss=r),v(r)}),s()(),a(21,"div",55)(22,"label",56),l(23,"Take Profit"),s(),a(24,"input",59),R("ngModelChange",function(r){_(e);let o=h();return N(o.execForm.actual_take_profit,r)||(o.execForm.actual_take_profit=r),v(r)}),s()(),a(25,"div",3)(26,"label",56),l(27,"Lot Size"),s(),a(28,"input",60),R("ngModelChange",function(r){_(e);let o=h();return N(o.execForm.actual_lot_size,r)||(o.execForm.actual_lot_size=r),v(r)}),s()()(),a(29,"div",61)(30,"button",62),g("click",function(){_(e);let r=h();return v(r.closeExec())}),l(31,"Cancel"),s(),a(32,"button",63),g("click",function(){_(e);let r=h();return v(r.confirmExec())}),l(33),s()()()()}if(i&2){let e=h();d(5),V(" ",e.execMode()==="mark"?"Trade Execution Details":"Update Execution Details"," "),d(4),y(e.execTarget==null?null:e.execTarget.symbol),d(),V(" (",e.execTarget==null?null:e.execTarget.direction,") "),d(6),O("ngModel",e.execForm.actual_entry_price),d(4),O("ngModel",e.execForm.actual_stop_loss),d(4),O("ngModel",e.execForm.actual_take_profit),d(4),O("ngModel",e.execForm.actual_lot_size),d(5),V(" ",e.execMode()==="mark"?"Confirm Execution":"Update Execution"," ")}}function Au(i,t){if(i&1){let e=j();a(0,"div",48)(1,"div",49)(2,"div",64)(3,"div",65)(4,"a",66),g("click",function(){_(e);let r=h();return v(r.closeComplete())}),l(5,"Back to Trades"),s(),a(6,"h5",67),l(7,"Complete Trade: "),a(8,"strong"),l(9),s()()(),a(10,"button",53),g("click",function(){_(e);let r=h();return v(r.closeComplete())}),s()(),a(11,"div",54)(12,"div",68)(13,"div",69)(14,"div",70)(15,"div",71),l(16,"Executed Trade Details"),s(),a(17,"div",72),l(18,"Original execution details"),s(),a(19,"div",73)(20,"div",74)(21,"span",75),l(22,"Symbol:"),s(),a(23,"span",8),l(24),s()(),a(25,"div",74)(26,"span",75),l(27,"Direction:"),s(),a(28,"span",8),l(29),s()(),a(30,"div",74)(31,"span",75),l(32,"Entry Price:"),s(),a(33,"span",8),l(34),s()(),a(35,"div",74)(36,"span",75),l(37,"Stop Loss:"),s(),a(38,"span",8),l(39),s()(),a(40,"div",74)(41,"span",75),l(42,"Take Profit:"),s(),a(43,"span",8),l(44),s()(),a(45,"div",74)(46,"span",75),l(47,"Lot Size:"),s(),a(48,"span",8),l(49),s()(),a(50,"div",74)(51,"span",75),l(52,"Strategy:"),s(),a(53,"span",8),l(54),s()()()()(),a(55,"div",76)(56,"div",70)(57,"div",71),l(58,"Trade Results"),s(),a(59,"div",72),l(60,"Automatically calculated metrics"),s(),a(61,"div",77)(62,"div",78)(63,"div",79)(64,"div",80),l(65,"P&L"),s(),a(66,"div",81),l(67),s()()(),a(68,"div",78)(69,"div",82)(70,"div",80),l(71,"Margin %"),s(),a(72,"div",81),l(73),s()()(),a(74,"div",78)(75,"div",83)(76,"div",80),l(77,"R:R Ratio"),s(),a(78,"div",81),l(79),s()()()()()()(),a(80,"div",84)(81,"div",71),l(82,"Trade Completion Details"),s(),a(83,"div",72),l(84,"Enter the details of how your trade was closed"),s(),a(85,"div",85)(86,"div",86)(87,"label",56),l(88,"Exit Price"),s(),a(89,"div",87)(90,"input",88),R("ngModelChange",function(r){_(e);let o=h();return N(o.completeForm.exit_price,r)||(o.completeForm.exit_price=r),v(r)}),s()()(),a(91,"div",86)(92,"label",56),l(93,"Exit Date"),s(),a(94,"input",89),R("ngModelChange",function(r){_(e);let o=h();return N(o.completeForm.exit_date,r)||(o.completeForm.exit_date=r),v(r)}),s()(),a(95,"div",86)(96,"label",56),l(97,"Broker Fees"),s(),a(98,"div",87)(99,"input",90),R("ngModelChange",function(r){_(e);let o=h();return N(o.completeForm.broker_fees,r)||(o.completeForm.broker_fees=r),v(r)}),s()(),a(100,"div",91),l(101,"Include all commissions and fees"),s()(),a(102,"div",92)(103,"label",93),l(104,"Trade Outcome"),s(),a(105,"div",94)(106,"button",95),g("click",function(){_(e);let r=h();return v(r.completeForm.trade_outcome="Win")}),l(107,"Win"),s(),a(108,"button",95),g("click",function(){_(e);let r=h();return v(r.completeForm.trade_outcome="Loss")}),l(109,"Loss"),s(),a(110,"button",95),g("click",function(){_(e);let r=h();return v(r.completeForm.trade_outcome="Breakeven")}),l(111,"Breakeven"),s()()()()()(),a(112,"div",61)(113,"button",62),g("click",function(){_(e);let r=h();return v(r.closeComplete())}),l(114,"Cancel"),s(),a(115,"button",96),g("click",function(){_(e);let r=h();return v(r.confirmComplete())}),l(116,"Mark Completed"),s()()()()}if(i&2){let e,n,r,o,c=h();d(9),y(c.completeTarget==null?null:c.completeTarget.symbol),d(15),y(c.completeTarget==null?null:c.completeTarget.symbol),d(4),D("dir-long",(c.completeTarget==null?null:c.completeTarget.direction)==="LONG")("dir-short",(c.completeTarget==null?null:c.completeTarget.direction)==="SHORT"),d(),V(" ",c.completeTarget==null?null:c.completeTarget.direction," "),d(5),y(c.asMoney((e=c.completeTarget==null?null:c.completeTarget.actual_entry_price)!==null&&e!==void 0?e:c.completeTarget==null?null:c.completeTarget.planned_entry_price)),d(5),y(c.asMoney((n=c.completeTarget==null?null:c.completeTarget.actual_stop_loss)!==null&&n!==void 0?n:c.completeTarget==null?null:c.completeTarget.planned_stop_loss)),d(5),y(c.asMoney((r=c.completeTarget==null?null:c.completeTarget.actual_take_profit)!==null&&r!==void 0?r:c.completeTarget==null?null:c.completeTarget.planned_take_profit)),d(5),y((o=(o=c.completeTarget==null?null:c.completeTarget.actual_lot_size)!==null&&o!==void 0?o:c.completeTarget==null?null:c.completeTarget.planned_lot_size)!==null&&o!==void 0?o:"\u2014"),d(5),y((c.completeTarget==null?null:c.completeTarget.strategy_name)||"\u2014"),d(13),y(c.asMoney(c.pnlPreview())),d(6),y(c.marginPreview()),d(6),y(c.rrPreview()),d(11),O("ngModel",c.completeForm.exit_price),d(4),O("ngModel",c.completeForm.exit_date),d(5),O("ngModel",c.completeForm.broker_fees),d(7),D("active",c.completeForm.trade_outcome==="Win"),d(2),D("active",c.completeForm.trade_outcome==="Loss"),d(2),D("active",c.completeForm.trade_outcome==="Breakeven")}}function ku(i,t){i&1&&(a(0,"div",106),l(1,"Please choose a valid range of 1\u201314 days."),s())}function Pu(i,t){if(i&1){let e=j();a(0,"div",48)(1,"div",49)(2,"div",97)(3,"h5",51),l(4,"Export Trades"),s(),a(5,"button",53),g("click",function(){_(e);let r=h();return v(r.closeExport())}),s()(),a(6,"div",54)(7,"div",68)(8,"div",98)(9,"label",99),l(10,"From"),s(),a(11,"input",100),R("ngModelChange",function(r){_(e);let o=h();return N(o.fromDate,r)||(o.fromDate=r),v(r)}),s()(),a(12,"div",98)(13,"label",99),l(14,"To"),s(),a(15,"input",100),R("ngModelChange",function(r){_(e);let o=h();return N(o.toDate,r)||(o.toDate=r),v(r)}),s()(),a(16,"div",92)(17,"div",101),l(18,"Range must be \u2264 14 days. Preset to last 3 days (inclusive)."),s(),b(19,ku,2,0,"div",102),s()()(),a(20,"div",61)(21,"button",103),g("click",function(){_(e);let r=h();return v(r.closeExport())}),l(22,"Cancel"),s(),a(23,"div",30)(24,"button",104),g("click",function(){_(e);let r=h();return v(r.exportRangeCsv())}),l(25,"Export CSV"),s(),a(26,"button",105),g("click",function(){_(e);let r=h();return v(r.exportRangePdf())}),l(27,"Export PDF"),s()()()()()}if(i&2){let e=h();d(11),O("ngModel",e.fromDate),d(4),O("ngModel",e.toDate),d(4),f("ngIf",!e.canExportRange()),d(5),f("disabled",!e.canExportRange()),d(2),f("disabled",!e.canExportRange())}}function Du(i,t){if(i&1&&(a(0,"span",126),l(1," SL: "),a(2,"strong"),l(3),s()()),i&2){let e,n=h(3);d(3),y(n.asMoney((e=n.viewTarget.actual_stop_loss)!==null&&e!==void 0?e:n.viewTarget.planned_stop_loss))}}function Fu(i,t){if(i&1&&(a(0,"span",126),l(1," TP: "),a(2,"strong"),l(3),s()()),i&2){let e,n=h(3);d(3),y(n.asMoney((e=n.viewTarget.actual_take_profit)!==null&&e!==void 0?e:n.viewTarget.planned_take_profit))}}function Ou(i,t){if(i&1&&(a(0,"div",121)(1,"div",122),T(2,"div",123,0),a(4,"div",124),l(5," Entry: "),a(6,"strong"),l(7),s(),b(8,Du,4,1,"span",125)(9,Fu,4,1,"span",125),a(10,"span",126),l(11,"Exit: "),a(12,"strong"),l(13),s()()()()()),i&2){let e,n=h(2);d(7),y(n.asMoney((e=n.viewTarget.actual_entry_price)!==null&&e!==void 0?e:n.viewTarget.planned_entry_price)),d(),f("ngIf",n.viewTarget.actual_stop_loss||n.viewTarget.planned_stop_loss),d(),f("ngIf",n.viewTarget.actual_take_profit||n.viewTarget.planned_take_profit),d(4),y(n.asMoney(n.viewTarget.exit_price))}}function Nu(i,t){if(i&1){let e=j();a(0,"div",48)(1,"div",107)(2,"div",97)(3,"div")(4,"h5",51),l(5,"Trade Details"),s(),a(6,"div",52),l(7,"Read-only view of all recorded fields"),s()(),a(8,"button",53),g("click",function(){_(e);let r=h();return v(r.closeView())}),s()(),a(9,"div",54)(10,"div",108)(11,"div",8),l(12,"Trade Replay"),s(),a(13,"div",101),l(14),s()(),b(15,Ou,14,4,"div",109),a(16,"div",110)(17,"div",71),l(18,"Overview"),s(),a(19,"div",111)(20,"div",112)(21,"span",113),l(22,"Symbol"),s(),a(23,"span",114),l(24),s()(),a(25,"div",112)(26,"span",113),l(27,"Direction"),s(),a(28,"span",114),l(29),s()(),a(30,"div",112)(31,"span",113),l(32,"Strategy"),s(),a(33,"span",114),l(34),s()(),a(35,"div",112)(36,"span",113),l(37,"Tags"),s(),a(38,"span",114),l(39),s()(),a(40,"div",112)(41,"span",113),l(42,"State"),s(),a(43,"span",115),l(44),s()()()(),a(45,"div",68)(46,"div",116)(47,"div",70)(48,"div",71),l(49,"Planned"),s(),a(50,"div",111)(51,"div",112)(52,"span",113),l(53,"Planned Entry"),s(),a(54,"span",114),l(55),s()(),a(56,"div",112)(57,"span",113),l(58,"Planned SL"),s(),a(59,"span",114),l(60),s()(),a(61,"div",112)(62,"span",113),l(63,"Planned TP"),s(),a(64,"span",114),l(65),s()(),a(66,"div",112)(67,"span",113),l(68,"Planned Lots"),s(),a(69,"span",114),l(70),s()(),a(71,"div",112)(72,"span",113),l(73,"Planned Risk $"),s(),a(74,"span",114),l(75),s()(),a(76,"div",112)(77,"span",113),l(78,"Planned Risk %"),s(),a(79,"span",114),l(80),s()(),a(81,"div",112)(82,"span",113),l(83,"Planned At"),s(),a(84,"span",114),l(85),s()()()()(),a(86,"div",116)(87,"div",70)(88,"div",71),l(89,"Executed"),s(),a(90,"div",111)(91,"div",112)(92,"span",113),l(93,"Entry Price"),s(),a(94,"span",114),l(95),s()(),a(96,"div",112)(97,"span",113),l(98,"Stop Loss"),s(),a(99,"span",114),l(100),s()(),a(101,"div",112)(102,"span",113),l(103,"Take Profit"),s(),a(104,"span",114),l(105),s()(),a(106,"div",112)(107,"span",113),l(108,"Lot Size"),s(),a(109,"span",114),l(110),s()(),a(111,"div",112)(112,"span",113),l(113,"Exec Date"),s(),a(114,"span",114),l(115),s()()()()(),a(116,"div",116)(117,"div",70)(118,"div",71),l(119,"Completed"),s(),a(120,"div",111)(121,"div",112)(122,"span",113),l(123,"Exit Price"),s(),a(124,"span",114),l(125),s()(),a(126,"div",112)(127,"span",113),l(128,"Exit Date"),s(),a(129,"span",114),l(130),s()(),a(131,"div",112)(132,"span",113),l(133,"Broker Fees"),s(),a(134,"span",114),l(135),s()(),a(136,"div",112)(137,"span",113),l(138,"Realized P&L"),s(),a(139,"span",114),l(140),s()(),a(141,"div",112)(142,"span",113),l(143,"Outcome"),s(),a(144,"span",114),l(145),s()()()()(),a(146,"div",116)(147,"div",70)(148,"div",71),l(149,"Emotion (Before / After)"),s(),a(150,"div",111)(151,"div",112)(152,"span",113),l(153,"Before State"),s(),a(154,"span",114),l(155),s()(),a(156,"div",112)(157,"span",113),l(158,"Before Confidence"),s(),a(159,"span",114),l(160),s()(),a(161,"div",112)(162,"span",113),l(163,"Before Bias"),s(),a(164,"span",114),l(165),s()(),a(166,"div",112)(167,"span",113),l(168,"After State"),s(),a(169,"span",114),l(170),s()(),a(171,"div",112)(172,"span",113),l(173,"After Confidence"),s(),a(174,"span",114),l(175),s()(),a(176,"div",112)(177,"span",113),l(178,"After Bias"),s(),a(179,"span",114),l(180),s()()()()(),a(181,"div",92)(182,"div",117)(183,"div",71),l(184,"Notes & Analysis"),s(),a(185,"div",111)(186,"div",112)(187,"span",113),l(188,"Entry Criteria"),s(),a(189,"span",114),l(190),s()(),a(191,"div",112)(192,"span",113),l(193,"Trade Notes"),s(),a(194,"span",114),l(195),s()(),a(196,"div",112)(197,"span",113),l(198,"Lesson Learned"),s(),a(199,"span",114),l(200),s()(),a(201,"div",112)(202,"span",113),l(203,"Points to Improve"),s(),a(204,"span",114),l(205),s()(),a(206,"div",112)(207,"span",113),l(208,"Additional Notes"),s(),a(209,"span",114),l(210),s()(),a(211,"div",112)(212,"span",113),l(213,"Chart Analysis"),s(),a(214,"span",114),l(215),s()()()()()()(),a(216,"div",118)(217,"div",30)(218,"button",119),g("click",function(){_(e);let r=h();return v(r.exportCsvSingle())}),l(219,"Export CSV"),s(),a(220,"button",120),g("click",function(){_(e);let r=h();return v(r.exportPdfViaPrint())}),l(221,"Export PDF"),s(),a(222,"button",62),g("click",function(){_(e);let r=h();return v(r.closeView())}),l(223,"Close"),s()()()()()}if(i&2){let e,n,r,o,c,u,p,m=h();d(14),Ut("",m.viewTarget==null?null:m.viewTarget.symbol," \u2022 ",m.replayWindowLabel(),""),d(),f("ngIf",m.viewTarget&&!m.chartError()),d(9),y(m.viewTarget==null?null:m.viewTarget.symbol),d(4),D("dir-long",(m.viewTarget==null?null:m.viewTarget.direction)==="LONG")("dir-short",(m.viewTarget==null?null:m.viewTarget.direction)==="SHORT"),d(),y(m.viewTarget==null?null:m.viewTarget.direction),d(5),y((m.viewTarget==null?null:m.viewTarget.strategy_name)||"\u2014"),d(5),y(((m.viewTarget==null?null:m.viewTarget.tags)||so(41,vu)).join(", ")||"\u2014"),d(5),y(m.viewTarget==null||m.viewTarget.trade_state==null?null:m.viewTarget.trade_state.toLowerCase()),d(11),y(m.asMoney(m.viewTarget==null?null:m.viewTarget.planned_entry_price)),d(5),y(m.asMoney(m.viewTarget==null?null:m.viewTarget.planned_stop_loss)),d(5),y(m.asMoney(m.viewTarget==null?null:m.viewTarget.planned_take_profit)),d(5),y((e=m.viewTarget==null?null:m.viewTarget.planned_lot_size)!==null&&e!==void 0?e:"\u2014"),d(5),y(m.asMoney(m.viewTarget==null?null:m.viewTarget.planned_risk_amount)),d(5),y(m.asPercent(m.viewTarget==null?null:m.viewTarget.planned_risk_percentage)),d(5),y(m.dateOnly(m.viewTarget==null?null:m.viewTarget.planned_at)),d(10),y(m.asMoney((n=m.viewTarget==null?null:m.viewTarget.actual_entry_price)!==null&&n!==void 0?n:m.viewTarget==null?null:m.viewTarget.planned_entry_price)),d(5),y(m.asMoney((r=m.viewTarget==null?null:m.viewTarget.actual_stop_loss)!==null&&r!==void 0?r:m.viewTarget==null?null:m.viewTarget.planned_stop_loss)),d(5),y(m.asMoney((o=m.viewTarget==null?null:m.viewTarget.actual_take_profit)!==null&&o!==void 0?o:m.viewTarget==null?null:m.viewTarget.planned_take_profit)),d(5),y((c=(c=m.viewTarget==null?null:m.viewTarget.actual_lot_size)!==null&&c!==void 0?c:m.viewTarget==null?null:m.viewTarget.planned_lot_size)!==null&&c!==void 0?c:"\u2014"),d(5),y(m.dateOnly(m.viewTarget==null?null:m.viewTarget.actual_entry_date)),d(10),y(m.asMoney(m.viewTarget==null?null:m.viewTarget.exit_price)),d(5),y(m.dateOnly(m.viewTarget==null?null:m.viewTarget.exit_date)),d(5),y(m.asMoney(m.viewTarget==null?null:m.viewTarget.broker_fees)),d(5),y(m.asMoney(m.viewTarget==null?null:m.viewTarget.realized_pnl)),d(5),y((m.viewTarget==null?null:m.viewTarget.trade_outcome)||"\u2014"),d(10),y((m.viewTarget==null?null:m.viewTarget.emotional_before_state)||"\u2014"),d(5),y((u=m.viewTarget==null?null:m.viewTarget.confidence_before_level)!==null&&u!==void 0?u:"\u2014"),d(5),y((m.viewTarget==null?null:m.viewTarget.emotional_before_potential_bias)||"\u2014"),d(5),y((m.viewTarget==null?null:m.viewTarget.emotional_after_state)||"\u2014"),d(5),y((p=m.viewTarget==null?null:m.viewTarget.confidence_after_level)!==null&&p!==void 0?p:"\u2014"),d(5),y((m.viewTarget==null?null:m.viewTarget.emotional_after_potential_bias)||"\u2014"),d(10),y((m.viewTarget==null?null:m.viewTarget.entry_criteria)||"\u2014"),d(5),y((m.viewTarget==null?null:m.viewTarget.trade_notes)||"\u2014"),d(5),y((m.viewTarget==null?null:m.viewTarget.lesson_learned)||"\u2014"),d(5),y((m.viewTarget==null?null:m.viewTarget.points_to_improve)||"\u2014"),d(5),y((m.viewTarget==null?null:m.viewTarget.additional_notes)||"\u2014"),d(5),y(m.asJsonOneLine(m.viewTarget==null?null:m.viewTarget.chart_analysis))}}var Ei=class i{constructor(t,e,n){this.uc=t;this.router=e;this.httpClient=n;this.refresh(),this.rows=this.uc.tradesSig}rows;tab=A("PLANNED");pageIndex=A(0);hasNext=A(!1);hasPrev=A(!1);exportModalOpen=A(!1);fromDate=null;toDate=null;viewRows=oe(()=>this.rows());trackById=(t,e)=>e.trade_id;async refresh(){await this.uc.loadTabPage(this.tab(),!0),this.pageIndex.set(0),this.uc.reflectPageToStore(this.tab(),0),this.syncPagerFlags()}switchTab(t){this.tab.set(t),this.refresh()}syncPagerFlags(){let t=this.pageIndex();this.hasPrev.set(t>0),this.hasNext.set(this.uc.hasNextPage(this.tab(),t))}async nextPage(){let t=this.pageIndex();if(await this.uc.ensurePageLoaded(this.tab(),t+1)){let n=t+1;this.pageIndex.set(n),this.uc.reflectPageToStore(this.tab(),n),this.syncPagerFlags()}}async prevPage(){let t=this.pageIndex();if(t<=0)return;let e=t-1;this.pageIndex.set(e),this.uc.reflectPageToStore(this.tab(),e),this.syncPagerFlags()}execModalOpen=A(!1);execTarget=null;execForm={actual_entry_price:null,actual_stop_loss:null,actual_take_profit:null,actual_lot_size:null};execMode=A("mark");openExecute(t){this.completeModalOpen.set(!1),this.viewModalOpen.set(!1),this.execTarget=t,this.execForm={actual_entry_price:t.planned_entry_price??null,actual_stop_loss:t.planned_stop_loss??null,actual_take_profit:t.planned_take_profit??null,actual_lot_size:t.planned_lot_size??null},this.execMode.set("mark"),this.execModalOpen.set(!0)}editExecuting(t){this.completeModalOpen.set(!1),this.viewModalOpen.set(!1),this.execTarget=t,this.execForm={actual_entry_price:t.actual_entry_price??t.planned_entry_price??null,actual_stop_loss:t.actual_stop_loss??t.planned_stop_loss??null,actual_take_profit:t.actual_take_profit??t.planned_take_profit??null,actual_lot_size:t.actual_lot_size??t.planned_lot_size??null},this.execMode.set("update"),this.execModalOpen.set(!0)}async confirmExec(){if(!this.execTarget)return;let t={actual_entry_price:Number(this.execForm.actual_entry_price??0),actual_stop_loss:Number(this.execForm.actual_stop_loss??0),actual_take_profit:Number(this.execForm.actual_take_profit??0),actual_lot_size:Number(this.execForm.actual_lot_size??0)};this.execMode()==="mark"?await this.uc.markExecuted(this.execTarget.trade_id,t):await this.uc.updateExecuting(this.execTarget.trade_id,t),this.execModalOpen.set(!1),this.execTarget=null,this.switchTab("EXECUTING")}closeExec(){this.execModalOpen.set(!1),this.execTarget=null}completeModalOpen=A(!1);completeTarget=null;completeForm={};openComplete(t){this.execModalOpen.set(!1),this.viewModalOpen.set(!1),this.completeTarget=t,this.completeForm={exit_price:null,exit_date:new Date().toISOString().slice(0,10),broker_fees:0,trade_outcome:"Win",emotional_after_state:"neutral",confidence_after_level:5,trade_notes:""},this.completeModalOpen.set(!0)}isoDate(t){return new Date(t.getFullYear(),t.getMonth(),t.getDate()).toISOString().slice(0,10)}presetExportDates(){let t=new Date,e=new Date(t);e.setDate(t.getDate()-2),this.fromDate=this.isoDate(e),this.toDate=this.isoDate(t)}openExport(){this.presetExportDates(),this.exportModalOpen.set(!0)}closeExport(){this.exportModalOpen.set(!1)}closeComplete(){this.completeModalOpen.set(!1),this.completeTarget=null}pnlPreview(){let t=this.completeTarget?.actual_entry_price??this.completeTarget?.planned_entry_price,e=this.completeForm.exit_price,n=Number(t),r=Number(e);if(!Number.isFinite(n)||!Number.isFinite(r))return 0;let o=Number(this.completeTarget?.actual_lot_size??this.completeTarget?.planned_lot_size??1)||1,c=Number(this.completeForm.broker_fees)||0,p=String(this.completeTarget?.direction||"LONG").toUpperCase()==="SHORT"?(n-r)*o:(r-n)*o;return Number((p-c).toFixed(2))}marginPreview(){let t=+(this.completeTarget?.actual_entry_price??this.completeTarget?.planned_entry_price??0),e=+(this.completeForm.exit_price??0);return!t||!e?"0.00%":((e-t)/t*100).toFixed(2)+"%"}rrPreview(){let t=+(this.completeTarget?.actual_entry_price??this.completeTarget?.planned_entry_price??0),e=+(this.completeTarget?.actual_stop_loss??this.completeTarget?.planned_stop_loss??0),n=+(this.completeTarget?.actual_take_profit??this.completeTarget?.planned_take_profit??0);if(!t||!e||!n)return"0.00";let r=Math.abs(t-e),o=Math.abs(n-t);return r?(o/r).toFixed(2):"0.00"}async confirmComplete(){this.completeTarget&&(await this.uc.completeAndApply(this.completeTarget.trade_id,{exit_price:Number(this.completeForm.exit_price),broker_fees:Number(this.completeForm.broker_fees||0),outcome:String(this.completeForm.trade_outcome||"Win"),emotion_after:String(this.completeForm.emotional_after_state||"neutral"),conf_after:Number(this.completeForm.confidence_after_level||5),notes:this.completeForm.trade_notes??"",lessons:this.completeForm.lesson_learned??"",improve:this.completeForm.points_to_improve??""}),this.completeModalOpen.set(!1),this.completeTarget=null,this.switchTab("COMPLETED"))}viewModalOpen=A(!1);viewTarget=null;miniChartRef;lwcLoaded=!1;chart=null;series=null;ro=null;canShowChart=A(!1);replayWindowLabel=A("");chartError=A("");openView(t){this.execModalOpen.set(!1),this.completeModalOpen.set(!1),this.viewTarget=t,this.viewModalOpen.set(!0),this.canShowChart.set(!1),this.chartError.set(""),requestAnimationFrame(()=>this.renderCompletedMiniChart().catch(()=>this.canShowChart.set(!1)))}teardownChart(){if(this.ro&&this.miniChartRef?.nativeElement&&(this.ro.unobserve(this.miniChartRef.nativeElement),this.ro=null),this.chart)try{this.chart.remove()}catch{}this.chart=null,this.series=null,this.canShowChart.set(!1),this.chartError.set("")}closeView(){this.viewModalOpen.set(!1),this.viewTarget=null,this.teardownChart()}edit(t){this.router.navigate(["/pretrade"],{queryParams:{edit:t.trade_id}})}asMoney(t){return t==null||isNaN(+t)?"\u2014":`$${Number(t).toFixed(2)}`}asPercent(t){return t==null||isNaN(+t)?"\u2014":`${Number(t).toFixed(2)}%`}dateOnly(t){return t?new Date(t).toLocaleDateString():"\u2014"}dateTime(t){if(!t)return"\u2014";let e=new Date(t);return e.toLocaleDateString()+" "+e.toLocaleTimeString()}asJsonOneLine(t){if(!t)return"\u2014";try{return JSON.stringify(t)}catch{return"\u2014"}}async remove(t){await this.uc.remove(t.trade_id)}downloadFile(t,e,n){let r=n instanceof Blob?n:new Blob([n],{type:e}),o=URL.createObjectURL(r),c=document.createElement("a");c.href=o,c.download=t,document.body.appendChild(c),c.click(),c.remove(),URL.revokeObjectURL(o)}buildViewPairs(){let t=this.viewTarget,e=n=>n==null||typeof n=="number"&&!Number.isFinite(n)?"\u2014":String(n);return[["Symbol",e(t?.symbol)],["Direction",e(t?.direction)],["Strategy",e(t?.strategy_name)],["Tags",(t?.tags||[]).join(", ")||"\u2014"],["Trade State",t?.trade_state??"\u2014"],["Account ID",e(t?.account_id)],["Planned Entry",this.asMoney(t?.planned_entry_price)],["Planned SL",this.asMoney(t?.planned_stop_loss)],["Planned TP",this.asMoney(t?.planned_take_profit)],["Planned Lots",e(t?.planned_lot_size)],["Planned Risk $",this.asMoney(t?.planned_risk_amount)],["Planned Risk %",this.asPercent(t?.planned_risk_percentage)],["Planned At",this.dateTime(t?.planned_at)],["Actual Entry",this.asMoney(t?.actual_entry_price)],["Actual SL",this.asMoney(t?.actual_stop_loss)],["Actual TP",this.asMoney(t?.actual_take_profit)],["Actual Lots",e(t?.actual_lot_size)],["Actual Entry Date",this.dateTime(t?.actual_entry_date)],["Exit Price",this.asMoney(t?.exit_price)],["Exit Date",this.dateTime(t?.exit_date)],["Broker Fees",this.asMoney(t?.broker_fees)],["Realized P&L",this.asMoney(t?.realized_pnl)],["Outcome",e(t?.trade_outcome)],["Before Emotion",e(t?.emotional_before_state)],["Before Confidence",e(t?.confidence_before_level)],["Before Bias",e(t?.emotional_before_potential_bias)],["After Emotion",e(t?.emotional_after_state)],["After Confidence",e(t?.confidence_after_level)],["After Bias",e(t?.emotional_after_potential_bias)],["Entry Criteria",e(t?.entry_criteria)],["Trade Notes",e(t?.trade_notes)],["Lesson Learned",e(t?.lesson_learned)],["Points to Improve",e(t?.points_to_improve)],["Additional Notes",e(t?.additional_notes)],["Chart Analysis (JSON)",t?.chart_analysis?JSON.stringify(t.chart_analysis):"\u2014"],["Trade ID",e(t?.trade_id)],["Created At",this.dateTime(t?.created_at)],["Updated At",this.dateTime(t?.updated_at)]]}toCsv(t){let e=r=>`"${String(r??"").replace(/"/g,'""')}"`;return[["Field","Value"],...t.map(([r,o])=>[r,o])].map(r=>r.map(e).join(",")).join(`
`)}exportCsvSingle(){if(!this.viewTarget)return;let t=this.toCsv(this.buildViewPairs()),e=(this.viewTarget.symbol||"trade").replace(/[^\w-]+/g,"_"),n=new Date().toISOString().slice(0,10);this.downloadFile(`${e}_details_${n}.csv`,"text/csv;charset=utf-8",t)}exportPdfViaPrint(){let t=document.getElementById("viewModalCard");if(!t)return;let e=`
<!doctype html><html><head><meta charset="utf-8"/>
<title>Trade Details</title>
<style>
  body{font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; margin:24px;background:#fff}
  h1,h2,h3,h4,h5{margin:.25rem 0}
  .soft-card{border:1px solid #e9ecef;border-radius:1rem;box-shadow:none}
  .kv-grid{display:grid;grid-template-columns:1fr 1fr;gap:.5rem .75rem}
  .kv-item{display:flex;justify-content:space-between;gap:.75rem;padding:.5rem .75rem;border:1px solid #eef2f7;border-radius:.5rem}
  .kv-k{color:#6c757d}
  .kv-v{font-weight:600}
  .metric{border-radius:.75rem;border:1px solid #eef2f7;padding:1rem;text-align:center}
  .metric .k{font-size:.85rem;color:#6c757d}
  .metric .v{font-weight:700;font-size:1.1rem}
  @media print { body{margin:0} }
</style></head><body>
  ${t.outerHTML}
  <script>window.addEventListener('afterprint',()=>setTimeout(()=>window.close(),50));setTimeout(()=>window.print(),150);<\/script>
</body></html>`,n=window.open("","_blank","noopener,noreferrer,width=980");n&&(n.document.open(),n.document.write(e),n.document.close())}canExportRange(){if(!this.fromDate||!this.toDate)return!1;let t=new Date(this.fromDate),e=new Date(this.toDate);if(isNaN(+t)||isNaN(+e)||e<t)return!1;let n=Math.floor((+e-+t)/864e5)+1;return n>0&&n<=14}val(t){return t==null?"":String(t)}csvFromRows(t){let e=o=>`"${String(o??"").replace(/"/g,'""')}"`,r=[["trade_id","symbol","direction","strategy_name","tags","trade_state","planned_entry_price","planned_stop_loss","planned_take_profit","planned_lot_size","planned_risk_amount","planned_risk_percentage","planned_at","actual_entry_price","actual_stop_loss","actual_take_profit","actual_lot_size","actual_entry_date","exit_price","exit_date","broker_fees","realized_pnl","trade_outcome","emotional_before_state","confidence_before_level","emotional_before_potential_bias","emotional_after_state","confidence_after_level","emotional_after_potential_bias","entry_criteria","trade_notes","lesson_learned","points_to_improve","additional_notes","created_at","updated_at","account_id"]];for(let o of t)r.push([this.val(o.trade_id),this.val(o.symbol),this.val(o.direction),this.val(o.strategy_name),(o.tags??[]).join("|"),this.val(o.trade_state),this.val(o.planned_entry_price),this.val(o.planned_stop_loss),this.val(o.planned_take_profit),this.val(o.planned_lot_size),this.val(o.planned_risk_amount),this.val(o.planned_risk_percentage),this.val(o.planned_at),this.val(o.actual_entry_price),this.val(o.actual_stop_loss),this.val(o.actual_take_profit),this.val(o.actual_lot_size),this.val(o.actual_entry_date),this.val(o.exit_price),this.val(o.exit_date),this.val(o.broker_fees),this.val(o.realized_pnl),this.val(o.trade_outcome),this.val(o.emotional_before_state),this.val(o.confidence_before_level),this.val(o.emotional_before_potential_bias),this.val(o.emotional_after_state),this.val(o.confidence_after_level),this.val(o.emotional_after_potential_bias),this.val(o.entry_criteria),this.val(o.trade_notes),this.val(o.lesson_learned),this.val(o.points_to_improve),this.val(o.additional_notes),this.val(o.created_at),this.val(o.updated_at),this.val(o.account_id)]);return r.map(o=>o.map(e).join(",")).join(`
`)}async exportRangeCsv(){if(!this.canExportRange())return;let t=await this.uc.fetchRangeForExport(this.tab(),this.fromDate,this.toDate),e=this.csvFromRows(t),n=this.tab().toLowerCase();this.downloadFile(`trades_${n}_${this.fromDate}_${this.toDate}.csv`,"text/csv;charset=utf-8",e)}async exportRangePdf(){if(!this.canExportRange())return;let t=await this.uc.fetchRangeForExport(this.tab(),this.fromDate,this.toDate),e=`
      <table border="1" cellspacing="0" cellpadding="6" style="border-collapse:collapse;width:100%;font-size:12px">
        <thead><tr>
          <th>Symbol</th><th>Dir</th><th>State</th>
          <th>Planned Entry</th><th>Actual Entry</th><th>Exit</th>
          <th>Outcome</th><th>Realized P&L</th>
          <th>Created</th><th>Exit Date</th>
        </tr></thead>
        <tbody>
          ${t.map(u=>`
            <tr>
              <td>${u.symbol??""}</td>
              <td>${u.direction??""}</td>
              <td>${u.trade_state??""}</td>
              <td>${this.asMoney(u.planned_entry_price)}</td>
              <td>${this.asMoney(u.actual_entry_price)}</td>
              <td>${this.asMoney(u.exit_price)}</td>
              <td>${u.trade_outcome??""}</td>
              <td>${this.asMoney(u.realized_pnl)}</td>
              <td>${this.dateTime(u.created_at)}</td>
              <td>${this.dateTime(u.exit_date)}</td>
            </tr>
          `).join("")}
        </tbody>
      </table>
    `,n=`
    <!doctype html><html><head><meta charset="utf-8"/>
    <title>Trades ${this.fromDate} - ${this.toDate}</title>
    <style>
      body{font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; margin:24px}
      h3{margin:0 0 12px}
      .muted{color:#666}
      @media print { body{margin:0} }
    </style>
    </head><body>
      <h3>Trades (${this.tab()}) \u2014 ${this.fromDate} to ${this.toDate}</h3>
      <div class="muted">Exported ${t.length} trades</div>
      ${e}
      <script>
        window.onload = () => { setTimeout(() => { window.print(); }, 50); };
        window.onafterprint = () => { setTimeout(() => { window.close(); }, 50); };
      <\/script>
    </body></html>`.trim(),r=new Blob([n],{type:"text/html"}),o=URL.createObjectURL(r);if(!window.open(o,"_blank","noopener,noreferrer,width=1024")){URL.revokeObjectURL(o),alert("Popup blocked. Please allow popups for this site to export.");return}setTimeout(()=>URL.revokeObjectURL(o),3e4)}async ensureLightweightChartsLoaded(){this.lwcLoaded||await new Promise((t,e)=>{let n="tv-lightweight-charts";if(document.getElementById(n)){this.lwcLoaded=!0,t();return}let r=document.createElement("script");r.id=n,r.src="https://unpkg.com/lightweight-charts@4.1.1/dist/lightweight-charts.standalone.production.js",r.async=!0,r.onload=()=>{this.lwcLoaded=!0,t()},r.onerror=()=>e(new Error("Failed to load Lightweight Charts")),document.head.appendChild(r)})}normalizeToYahooSymbol(t){if(!t)return null;let e=t.trim().toUpperCase().replace(/\s+/g,"");return/^[A-Z]{3}\/?[A-Z]{3}$/.test(e)?`${e.replace("/","")}=X`:/^[A-Z]{2,6}USDT$/.test(e)?`${e.replace("USDT","")}-USD`:/^[A-Z]{2,6}-USD$/.test(e)?e:e==="XBTUSD"?"BTC-USD":e==="SPX"||e==="^SPX"?"^GSPC":e==="NDX"||e==="^NDX"?"^NDX":e}buildWindowForTrade(t){let n=t.actual_entry_date?new Date(t.actual_entry_date).getTime():t.planned_at?new Date(t.planned_at).getTime():Date.now(),r=t.exit_date?new Date(t.exit_date).getTime():n+4*60*60*1e3,o=n-864e5,c=r+864e5,u=p=>new Date(p).toLocaleString();return this.replayWindowLabel.set(`${u(o)} \u2192 ${u(c)}`),{from:o,to:c,entryMs:n,exitMs:r}}pickYahooInterval(t,e){let n=e-t,r=24*60*60*1e3;return n<=r?"5m":n<=3*r?"15m":n<=14*r?"60m":"1d"}async fetchMarketCandles(t,e,n){let r=this.normalizeToYahooSymbol(t);if(!r)throw new Error("Unknown symbol");let o=Date.now(),c=Math.min(n,o),u=Math.min(e,c-60*1e3),p=this.pickYahooInterval(u,c),m=Math.floor(u/1e3),w=Math.floor(c/1e3),x={symbol:r,period1:m,period2:w,interval:p},F=`${Co.url}/v1/api/data/candles`;try{let I=await Ur(this.httpClient.post(F,x));if(!Array.isArray(I)||I.length===0)throw new Error("No candle data returned from backend");return I.map(S=>({time:Number(S.time),open:Number(S.open),high:Number(S.high),low:Number(S.low),close:Number(S.close)}))}catch(I){throw console.error("Candle fetch failed:",I),new Error("Backend candle fetch failed")}}async renderCompletedMiniChart(){if(this.teardownChart(),this.canShowChart.set(!1),this.chartError.set(""),!this.viewTarget||!this.miniChartRef?.nativeElement)return;let t=+(this.viewTarget.actual_entry_price??this.viewTarget.planned_entry_price??0),e=+(this.viewTarget.exit_price??0);if(!this.viewTarget.symbol||!Number.isFinite(t)||t<=0){this.chartError.set("Missing entry/exit price"),this.canShowChart.set(!1);return}try{await this.ensureLightweightChartsLoaded();let n=window.LightweightCharts;if(!n?.createChart)throw new Error("Chart library unavailable");let{from:r,to:o,entryMs:c,exitMs:u}=this.buildWindowForTrade(this.viewTarget),p=[];try{p=await this.fetchMarketCandles(this.viewTarget.symbol,r,o)}catch{this.chartError.set("Chart unavailable (data/CORS)"),this.canShowChart.set(!1);return}if(!p.length){this.chartError.set("No chart data available"),this.canShowChart.set(!1);return}let m=this.miniChartRef.nativeElement;this.chart=n.createChart(m,{width:m.clientWidth||600,height:m.clientHeight||300,layout:{background:{color:"#fff"},textColor:"#333"},rightPriceScale:{borderVisible:!1},timeScale:{borderVisible:!1},grid:{horzLines:{color:"rgba(128,128,128,0.1)"},vertLines:{color:"rgba(128,128,128,0.1)"}}}),this.series&&this.chart.removeSeries(this.series),this.series=this.chart.addCandlestickSeries(),this.series.setData(p),this.chart.timeScale().fitContent(),this.series.createPriceLine({price:t,color:"#0d6efd",lineWidth:2,title:"Entry"}),e&&this.series.createPriceLine({price:e,color:"#28a745",lineWidth:2,title:"Exit"});let w=+(this.viewTarget.actual_stop_loss??this.viewTarget.planned_stop_loss??0),x=+(this.viewTarget.actual_take_profit??this.viewTarget.planned_take_profit??0);w&&this.series.createPriceLine({price:w,color:"#dc3545",lineWidth:2,lineStyle:2,title:"SL"}),x&&this.series.createPriceLine({price:x,color:"#17a2b8",lineWidth:2,lineStyle:2,title:"TP"});let F=p.find(S=>S.time>=Math.floor(c/1e3))?.time??p[0].time,I=p.find(S=>S.time>=Math.floor(u/1e3))?.time??p[p.length-1].time;this.series.setMarkers([{time:F,position:"belowBar",color:"#0d6efd",shape:"arrowUp",text:`Entry ${this.asMoney(t)}`},{time:I,position:"aboveBar",color:"#28a745",shape:"arrowDown",text:`Exit ${this.asMoney(e)}`}]),this.ro=new ResizeObserver(()=>this.chart?.applyOptions({width:m.clientWidth,height:m.clientHeight})),this.ro.observe(m),this.canShowChart.set(!0)}catch(n){console.error("Mini chart error:",n),this.chartError.set(n?.message||"Chart unavailable"),this.canShowChart.set(!1)}}static \u0275fac=function(e){return new(e||i)(C(Nn),C(ne),C(On))};static \u0275cmp=K({type:i,selectors:[["app-tradejournal"]],viewQuery:function(e,n){if(e&1&&Lt(_u,5),e&2){let r;Bt(r=jt())&&(n.miniChartRef=r.first)}},decls:75,vars:19,consts:[["miniChart",""],[1,"container","my-4"],[1,"page-head"],[1,"mb-1"],[1,"subtle"],[1,"card","soft-card","my-3"],[1,"card-body","d-flex","flex-wrap","align-items-center","gap-3"],[1,"me-auto"],[1,"fw-semibold"],["routerLink","/pretrade",1,"btn","btn-outline-primary","btn-rounded","d-flex","align-items-center","gap-2"],[1,"bi","bi-gear"],["routerLink","/tradesimport",1,"btn","btn-outline-primary","btn-rounded","d-flex","align-items-center","gap-2"],[1,"bi","bi-download"],[1,"d-flex","justify-content-between","align-items-center","my-3"],[1,"segmented"],[1,"seg-btn",3,"click"],[1,"soft-card","bg-white"],[1,"card-head","d-flex","flex-column","flex-md-row","align-items-start","align-items-md-center","justify-content-between"],[1,"mb-3","mb-md-0"],[1,"subtle","small"],[1,"d-flex","flex-column","flex-sm-row","gap-2"],["routerLink","/pretrade",1,"btn","btn-primary","btn-rounded","px-3"],[1,"btn","btn-outline-primary","btn-rounded",3,"click"],[1,"table-responsive"],[1,"table","clean","align-middle","mb-0"],[1,"ps-4"],[1,"pe-4","text-end"],[4,"ngIf"],[1,"d-flex","justify-content-between","align-items-center","p-3"],[1,"small","subtle"],[1,"d-flex","gap-2"],[1,"btn","btn-light","btn-sm","btn-rounded","px-3",3,"click","disabled"],["class","p-4 text-center subtle",4,"ngIf"],["class","alert alert-danger mt-3",4,"ngIf"],["class","modal-backdrop-custom",4,"ngIf"],["class","modal-shell",4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"ps-4","fw-semibold"],[1,"badge-pill","badge-soft-warning","text-capitalize"],[1,"d-inline-flex","gap-2"],["type","button",1,"btn","btn-light","btn-sm","btn-rounded","px-3",3,"click"],["type","button",1,"btn","btn-outline-warning","btn-sm","btn-rounded","px-3",3,"click"],["type","button",1,"btn","btn-danger","btn-sm","btn-rounded","px-3",3,"click"],["type","button",1,"btn","btn-success","btn-sm","btn-rounded","px-3",3,"click"],[1,"badge-pill","badge-soft-success","text-capitalize"],[1,"p-4","text-center","subtle"],[1,"alert","alert-danger","mt-3"],[1,"modal-backdrop-custom"],[1,"modal-shell"],[1,"modal-card"],[1,"modal-header","d-flex","align-items-start","justify-content-between"],[1,"m-0","fw-semibold"],[1,"muted","small"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mb-3"],[1,"form-label"],["type","number","step","0.000001","placeholder","Entry price",1,"form-control","form-lg",3,"ngModelChange","ngModel"],["type","number","step","0.000001","placeholder","Stop loss price",1,"form-control","form-lg",3,"ngModelChange","ngModel"],["type","number","step","0.000001","placeholder","Take profit price",1,"form-control","form-lg",3,"ngModelChange","ngModel"],["type","number","step","0.0001","placeholder","0.10",1,"form-control","form-lg",3,"ngModelChange","ngModel"],[1,"modal-footer","d-flex","justify-content-between"],["type","button",1,"btn","btn-light","btn-rounded","px-3",3,"click"],["type","button",1,"btn","btn-primary","btn-rounded","px-3",3,"click"],[1,"modal-header"],[1,"d-flex","align-items-center","gap-2"],[1,"btn","btn-sm","btn-light",3,"click"],[1,"m-0"],[1,"row","g-3"],[1,"col-lg-7"],[1,"soft-card","p-3","h-100"],[1,"fw-semibold","mb-1"],[1,"muted","small","mb-3"],[1,"row","gy-2"],[1,"col-6"],[1,"muted"],[1,"col-lg-5"],[1,"row","g-2"],[1,"col-12","col-sm-4"],[1,"metric","g"],[1,"k"],[1,"v"],[1,"metric","o"],[1,"metric","b"],[1,"soft-card","p-3","mt-3"],[1,"row","g-3","align-items-end"],[1,"col-md-4"],[1,"position-relative","input-dollar"],["type","number","step","0.000001","placeholder","Exit Price",1,"form-control","form-lg",3,"ngModelChange","ngModel"],["type","date",1,"form-control","form-lg",3,"ngModelChange","ngModel"],["type","number","step","0.01","placeholder","0",1,"form-control","form-lg",3,"ngModelChange","ngModel"],[1,"field-help","mt-1"],[1,"col-12"],[1,"form-label","d-block","mb-2"],[1,"pill-toggle"],["type","button",1,"px-3",3,"click"],["type","button",1,"btn","btn-success","btn-rounded","px-3",3,"click"],[1,"modal-header","d-flex","align-items-center","justify-content-between"],[1,"col-md-6"],[1,"form-label","mb-1"],["type","date",1,"form-control",3,"ngModelChange","ngModel"],[1,"small","muted"],["class","text-danger small mt-2",4,"ngIf"],[1,"btn","btn-light","btn-rounded","px-3",3,"click"],[1,"btn","btn-outline-secondary","btn-rounded",3,"click","disabled"],[1,"btn","btn-outline-primary","btn-rounded",3,"click","disabled"],[1,"text-danger","small","mt-2"],["id","viewModalCard",1,"modal-card"],[1,"soft-card","d-flex","align-items-center","justify-content-between","px-3","py-2","mb-3"],["class","soft-card p-0 mb-3",4,"ngIf"],[1,"soft-card","p-3","mb-3"],[1,"kv-grid"],[1,"kv-item"],[1,"kv-k"],[1,"kv-v"],[1,"kv-v","text-capitalize"],[1,"col-lg-6"],[1,"soft-card","p-3"],[1,"modal-footer","d-flex","flex-wrap","gap-2","justify-content-between"],["type","button",1,"btn","btn-outline-secondary","btn-rounded","px-3",3,"click"],["type","button",1,"btn","btn-outline-primary","btn-rounded","px-3",3,"click"],[1,"soft-card","p-0","mb-3"],[1,"p-3"],[1,"mini-chart"],[1,"small","mt-2","subtle"],["class","ms-3",4,"ngIf"],[1,"ms-3"]],template:function(e,n){e&1&&(a(0,"div",1)(1,"div",2)(2,"h2",3),l(3,"Trading Dashboard"),s(),a(4,"div",4),l(5,"Manage your trades from planning to completion"),s()(),a(6,"div",5)(7,"div",6)(8,"div",7)(9,"div",8),l(10,"Trade Entry Mode"),s()(),a(11,"a",9),T(12,"span",10),l(13,"Entry "),s(),a(14,"a",11),T(15,"span",12),l(16," Import "),s()()(),a(17,"div",13)(18,"div",14)(19,"button",15),g("click",function(){return n.switchTab("PLANNED")}),l(20,"Planned Trades"),s(),a(21,"button",15),g("click",function(){return n.switchTab("EXECUTING")}),l(22,"Executed Trades"),s(),a(23,"button",15),g("click",function(){return n.switchTab("COMPLETED")}),l(24,"Completed Trades"),s()()(),a(25,"div",16)(26,"div",17)(27,"div",18)(28,"div",8),l(29,"Your Trade Plans"),s(),a(30,"div",19),l(31,"Review and manage your planned trades"),s()(),a(32,"div",20)(33,"a",21),l(34,"New Trade Plan"),s(),a(35,"button",22),g("click",function(){return n.openExport()}),l(36,"Export"),s()()(),a(37,"div",23)(38,"table",24)(39,"thead")(40,"tr")(41,"th",25),l(42,"Symbol"),s(),a(43,"th"),l(44,"Direction"),s(),a(45,"th"),l(46,"Entry/Exit"),s(),a(47,"th"),l(48,"Strategy"),s(),a(49,"th"),l(50,"Emotional State"),s(),a(51,"th"),l(52,"Date"),s(),a(53,"th"),l(54,"Status"),s(),a(55,"th",26),l(56,"Actions"),s()()(),b(57,bu,2,2,"tbody",27)(58,Cu,2,2,"tbody",27)(59,Su,2,2,"tbody",27),s()(),a(60,"div",28)(61,"div",29),l(62),s(),a(63,"div",30)(64,"button",31),g("click",function(){return n.prevPage()}),l(65,"Prev"),s(),a(66,"button",31),g("click",function(){return n.nextPage()}),l(67,"Next"),s()()(),b(68,Eu,2,0,"div",32),s(),b(69,Tu,2,1,"div",33),s(),b(70,Mu,1,0,"div",34)(71,Iu,34,8,"div",35)(72,Au,117,24,"div",35)(73,Pu,28,5,"div",35)(74,Nu,224,42,"div",35)),e&2&&(d(19),D("active",n.tab()==="PLANNED"),d(2),D("active",n.tab()==="EXECUTING"),d(2),D("active",n.tab()==="COMPLETED"),d(34),f("ngIf",n.tab()==="PLANNED"),d(),f("ngIf",n.tab()==="EXECUTING"),d(),f("ngIf",n.tab()==="COMPLETED"),d(3),V("Page ",n.pageIndex()+1,""),d(2),f("disabled",!n.hasPrev()),d(2),f("disabled",!n.hasNext()),d(2),f("ngIf",n.viewRows().length===0),d(),f("ngIf",n.uc.error()),d(),f("ngIf",n.execModalOpen()||n.completeModalOpen()||n.viewModalOpen()||n.exportModalOpen()),d(),f("ngIf",n.execModalOpen()),d(),f("ngIf",n.completeModalOpen()),d(),f("ngIf",n.exportModalOpen()),d(),f("ngIf",n.viewModalOpen()))},dependencies:[X,Ve,te,pt,ie,kt,le,et,_e],styles:['.page-head[_ngcontent-%COMP%]{padding:1.25rem 0 .25rem}.subtle[_ngcontent-%COMP%], .muted[_ngcontent-%COMP%]{color:#6c757d}.soft-card[_ngcontent-%COMP%]{border-radius:1rem;border:1px solid #e9ecef;box-shadow:0 1px 2px #10182805}.card-head[_ngcontent-%COMP%]{padding:1rem 1.25rem;border-bottom:1px solid #eef2f7}.segmented[_ngcontent-%COMP%]{display:inline-flex;gap:.25rem;padding:.25rem;border-radius:9999px;background:#f1f3f5}.segmented[_ngcontent-%COMP%]   .seg-btn[_ngcontent-%COMP%]{border:0;border-radius:9999px;background:transparent;padding:.5rem 1.25rem;font-weight:600;color:#495057}.segmented[_ngcontent-%COMP%]   .seg-btn.active[_ngcontent-%COMP%]{background:#fff;box-shadow:0 1px 2px #0000000f;color:#0d6efd}.table.clean[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not(caption) > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{border-bottom-width:0}.table.clean[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%] + tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-top:1px solid #eef2f7}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{color:#6c757d;font-weight:600}.badge-pill[_ngcontent-%COMP%]{border-radius:9999px;padding:.35rem .75rem;font-weight:600}.badge-soft-warning[_ngcontent-%COMP%]{background:#fff8e1;color:#946200}.badge-soft-success[_ngcontent-%COMP%]{background:#eafff2;color:#117c36}.btn-rounded[_ngcontent-%COMP%]{border-radius:.75rem}.btn-danger[_ngcontent-%COMP%]{background:#ffe8e6;color:#c2271c;border:0}.btn-danger[_ngcontent-%COMP%]:hover{background:#ffd8d5;color:#a61f16}.modal-backdrop-custom[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000073;opacity:1;transition:opacity .15s;z-index:1050}.modal-shell[_ngcontent-%COMP%]{position:fixed;inset:0;display:flex;align-items:flex-start;justify-content:center;padding:3rem 1rem;overflow:auto;z-index:1060}.modal-card[_ngcontent-%COMP%]{width:min(980px,calc(100vw - 2rem));background:#fff;border-radius:1rem;box-shadow:0 10px 30px #1018282e;animation:_ngcontent-%COMP%_pop .12s ease-out}@keyframes _ngcontent-%COMP%_pop{0%{transform:scale(.98);opacity:.6}to{transform:scale(1);opacity:1}}.modal-header[_ngcontent-%COMP%]{padding:1rem 1.25rem;border-bottom:1px solid #eef2f7}.modal-body[_ngcontent-%COMP%], .modal-footer[_ngcontent-%COMP%]{padding:1rem 1.25rem}.form-control.form-lg[_ngcontent-%COMP%]{border-radius:.75rem;padding:.75rem 1rem;font-size:1rem}.metric[_ngcontent-%COMP%]{border-radius:.75rem;border:1px solid #eef2f7;padding:1rem;text-align:center}.metric[_ngcontent-%COMP%]   .k[_ngcontent-%COMP%]{font-size:.85rem;color:#6c757d}.metric[_ngcontent-%COMP%]   .v[_ngcontent-%COMP%]{font-weight:700;font-size:1.1rem}.metric.g[_ngcontent-%COMP%]{color:#117c36}.metric.b[_ngcontent-%COMP%]{color:#0d6efd}.metric.o[_ngcontent-%COMP%]{color:#0a7}.pill-toggle[_ngcontent-%COMP%]{display:inline-flex;border-radius:.75rem;background:#f1f3f5;overflow:hidden}.pill-toggle[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:0;background:transparent;padding:.5rem 1rem;font-weight:600}.pill-toggle[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:#dbeafe;color:#0d6efd}.label-strong[_ngcontent-%COMP%]{font-weight:600}.dir-long[_ngcontent-%COMP%]{color:#198754}.dir-short[_ngcontent-%COMP%]{color:#dc3545}.field-help[_ngcontent-%COMP%]{color:#6c757d;font-size:.85rem}.input-dollar[_ngcontent-%COMP%]:before{content:"$";position:absolute;left:.75rem;top:50%;transform:translateY(-50%);color:#6c757d}.input-dollar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding-left:1.6rem}.kv-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:.5rem .75rem}.kv-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;gap:.75rem;padding:.5rem .75rem;border:1px solid #eef2f7;border-radius:.5rem}.kv-k[_ngcontent-%COMP%]{color:#6c757d}.kv-v[_ngcontent-%COMP%]{font-weight:600}@media (max-width: 768px){.kv-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.mini-chart[_ngcontent-%COMP%]{height:320px;width:100%}@media (max-width: 576px){.mini-chart[_ngcontent-%COMP%]{height:260px}}']})};var Ti=class i{constructor(t,e){this.supabase=t;this.router=e}async canActivate(){let{data:t}=await this.supabase.GetClient().auth.getSession();return t.session?!0:this.router.createUrlTree(["/auth/forgot-password"],{queryParams:{reason:"invalid_or_expired"}})}static \u0275fac=function(e){return new(e||i)(q(G),q(ne))};static \u0275prov=z({token:i,factory:i.\u0275fac,providedIn:"root"})};var ea=[{path:"",component:_i,canActivate:[fn]},{path:"home",component:ii,canActivate:[Pe]},{path:"emotions",component:wi,canActivate:[Pe]},{path:"pretrade",component:Si,canActivate:[Pe]},{path:"tradejournal",component:Ei,canActivate:[Pe]},{path:"tradeaccounts",component:yi,canActivate:[Pe]},{path:"useraccount",component:bi,canActivate:[Pe]},{path:"admin/emotionquestion",component:fi,canActivate:[Pe]},{path:"auth/forgot-password",component:Ci,canActivate:[fn]},{path:"auth/update-password",component:xi,canActivate:[Ti]},{path:"tradesimport",canActivate:[Pe],loadComponent:()=>import("./chunk-TFWA22UB.js").then(i=>i.TradeJournalImportComponent)},{path:"**",redirectTo:""}];var ta=(i,t)=>{let e=$(G).GetClient();return i.url.includes("/v1/api/")?En(e.auth.getSession()).pipe(Jr(({data:n})=>{let r=n.session?.access_token,o=r?i.clone({setHeaders:{Authorization:`Bearer ${r}`,Accept:"application/json"}}):i;return t(o)})):t(i)};var na={providers:[co(),wo(ea),ho(go(),fo([ta])),Xo(),{provide:ro,useFactory:i=>()=>i.loadSession(),deps:[G],multi:!0}]};function Ru(i,t){i&1&&(a(0,"div",5),T(1,"div",6),s())}function Vu(i,t){i&1&&(Ge(0),T(1,"router-outlet"),He())}function Lu(i,t){i&1&&(a(0,"span"),l(1,"Dashboard"),s())}function Bu(i,t){i&1&&(a(0,"span"),l(1,"Morning Check-In"),s())}function ju(i,t){i&1&&(a(0,"span"),l(1,"Pre Trade"),s())}function Uu(i,t){i&1&&(a(0,"span"),l(1,"Trades"),s())}function zu(i,t){i&1&&(a(0,"span"),l(1,"Trade Accounts"),s())}function qu(i,t){i&1&&T(0,"div",39)}function Wu(i,t){if(i&1&&(Ge(0),T(1,"div",37),b(2,qu,1,0,"div",38),He()),i&2){let e=h(4);d(2),f("ngIf",!e.sidebarCollapsed())}}function Gu(i,t){if(i&1&&(a(0,"div"),T(1,"img",40),s()),i&2){let e=h(5);d(),D("me-2",!e.sidebarCollapsed()),f("src",e.profile_image_blob_url,tn)}}function Hu(i,t){i&1&&(a(0,"div"),T(1,"i",41),s())}function $u(i,t){if(i&1&&(a(0,"div"),l(1," \xA0\xA0 "),a(2,"p",42),l(3),s()()),i&2){let e=h(5);d(3),V("Welcome, ",e.user_firstname,"!")}}function Qu(i,t){if(i&1&&b(0,Gu,2,3,"div",20)(1,Hu,2,0,"div",20)(2,$u,4,1,"div",20),i&2){let e=h(4);f("ngIf",e.profile_image_blob_url),d(),f("ngIf",!e.profile_image_blob_url),d(),f("ngIf",!e.sidebarCollapsed())}}function Ku(i,t){i&1&&(a(0,"span"),l(1,"Logout\xA0\xA0\xA0"),s())}function Ju(i,t){if(i&1){let e=j();a(0,"div",43),g("click",function(){_(e);let r=h(4);return v(r.closeSidebar())}),s()}}function Yu(i,t){if(i&1){let e=j();a(0,"div",10)(1,"nav",11)(2,"div",12)(3,"div",13)(4,"button",14),g("click",function(){_(e);let r=h(3);return r.navigateToUrl("/home"),v(r.onNavLinkClick())}),T(5,"img",15),s(),a(6,"button",16),g("click",function(){_(e);let r=h(3);return v(r.closeSidebar())}),s()(),a(7,"div",17)(8,"a",18),g("click",function(){_(e);let r=h(3);return r.navigateToUrl("/home"),v(r.onNavLinkClick())}),T(9,"i",19),b(10,Lu,2,0,"span",20),s(),a(11,"a",18),g("click",function(){_(e);let r=h(3);return r.navigateToUrl("/emotions"),v(r.onNavLinkClick())}),T(12,"i",21),b(13,Bu,2,0,"span",20),s(),a(14,"a",18),g("click",function(){_(e);let r=h(3);return r.navigateToUrl("/pretrade"),v(r.onNavLinkClick())}),T(15,"i",22),b(16,ju,2,0,"span",20),s(),a(17,"a",18),g("click",function(){_(e);let r=h(3);return r.navigateToUrl("/tradejournal"),v(r.onNavLinkClick())}),T(18,"i",23),b(19,Uu,2,0,"span",20),s(),a(20,"a",18),g("click",function(){_(e);let r=h(3);return r.navigateToUrl("/tradeaccounts"),v(r.onNavLinkClick())}),T(21,"i",24),b(22,zu,2,0,"span",20),s()()(),a(23,"div",25)(24,"div",26),g("click",function(){_(e);let r=h(3);return v(r.onNavLinkClick())}),b(25,Wu,3,1,"ng-container",7)(26,Qu,3,3,"ng-template",null,3,Qe),s(),a(28,"button",27),g("click",function(){_(e);let r=h(3);return v(r.logOut())}),b(29,Ku,2,0,"span",20),T(30,"i",28),s()()(),b(31,Ju,1,0,"div",29),a(32,"div",30)(33,"nav",31)(34,"div",32)(35,"div",33)(36,"button",34),g("click",function(){_(e);let r=h(3);return v(r.toggleSidebar())}),T(37,"span",35),s()()()(),a(38,"div",36),T(39,"router-outlet"),s()()()}if(i&2){let e=$e(27),n=h(3);d(),D("collapsed",n.sidebarCollapsed()),d(4),on("height",n.sidebarCollapsed()?"40px":"90px"),d(3),D("active",n.isActiveRoute("/home")),f("title",n.sidebarCollapsed()?"Dashboard":""),d(),D("me-3",!n.sidebarCollapsed()),d(),f("ngIf",!n.sidebarCollapsed()),d(),D("active",n.isActiveRoute("/emotions")),f("title",n.sidebarCollapsed()?"Morning Check-In":""),d(),D("me-3",!n.sidebarCollapsed()),d(),f("ngIf",!n.sidebarCollapsed()),d(),D("active",n.isActiveRoute("/pretrade")),f("title",n.sidebarCollapsed()?"Trades":""),d(),D("me-3",!n.sidebarCollapsed()),d(),f("ngIf",!n.sidebarCollapsed()),d(),D("active",n.isActiveRoute("/tradejournal")),f("title",n.sidebarCollapsed()?"Trades":""),d(),D("me-3",!n.sidebarCollapsed()),d(),f("ngIf",!n.sidebarCollapsed()),d(),D("active",n.isActiveRoute("/tradeaccounts")),f("title",n.sidebarCollapsed()?"Trade Accounts":""),d(),D("me-3",!n.sidebarCollapsed()),d(),f("ngIf",!n.sidebarCollapsed()),d(2),D("justify-content-center",n.sidebarCollapsed()),d(),f("ngIf",n.loadingProfile)("ngIfElse",e),d(3),f("title",n.sidebarCollapsed()?"Logout":""),d(),f("ngIf",!n.sidebarCollapsed()),d(2),f("ngIf",n.isMobile()&&!n.sidebarCollapsed()),d(),D("expanded",n.sidebarCollapsed())}}function Zu(i,t){i&1&&T(0,"router-outlet")}function Xu(i,t){if(i&1&&b(0,Yu,40,43,"div",9)(1,Zu,1,0,"ng-template",null,2,Qe),i&2){let e=$e(2),n=h(2);f("ngIf",n.loginStatus())("ngIfElse",e)}}function em(i,t){if(i&1&&(b(0,Vu,2,0,"ng-container",7)(1,Xu,3,2,"ng-template",null,1,Qe),a(3,"footer",8),l(4,"\xA9 2025 Trading Rehab AI. All rights reserved."),s()),i&2){let e=$e(2),n=h();f("ngIf",n.isAuthRoute())("ngIfElse",e)}}var Mi=class i{constructor(t,e,n,r,o,c){this.supabaseService=t;this.supabaseAuthService=e;this.supabaseAccountService=n;this.router=r;this.route=o;this.platformId=c;bt(()=>{this.loginStatus()&&(this.route.queryParams.subscribe(u=>{let p=u.returnUrl;p?this.router.navigate([p]):(this.router.url==="/auth/login"||this.router.url==="/auth/signup")&&this.router.navigate(["/home"])}),this.loadUserProfile())})}loginStatus=oe(()=>this.supabaseService.loginStatus());sidebarCollapsed=A(!1);profile_image_blob_url=null;user_firstname="";loadingProfile=!0;resizeObserver;cdr=$(de);async ngOnInit(){Je(this.platformId)&&(this.resizeObserver=new ResizeObserver(()=>this.cdr.detectChanges()),this.resizeObserver.observe(document.body))}ngOnDestroy(){this.resizeObserver&&this.resizeObserver.disconnect()}async loadUserProfile(){try{this.loadingProfile=!0;let{data:t}=await this.supabaseAccountService.getProfile();t&&(this.user_firstname=t.firstname,t.profile_picture_url&&(this.profile_image_blob_url=await this.supabaseAccountService.getCachedProfilePictureBlobUrl(t.profile_picture_url)))}finally{this.loadingProfile=!1,this.cdr.markForCheck()}}isAuthRoute(){return["/auth/forgot-password","/auth/update-password","/auth/login","/auth/signup"].some(e=>this.router.url.startsWith(e))}async logOut(){await this.supabaseAuthService.logout(),this.router.navigateByUrl("/auth/login")}toggleSidebar(){this.sidebarCollapsed.update(t=>!t),this.cdr.detectChanges()}navigateToUrl(t){this.router.navigateByUrl(t)}onNavLinkClick(){this.isMobile()&&this.closeSidebar()}isActiveRoute(t){return this.router.url===t||this.router.url.startsWith(t+"/")}isMobile(){return Je(this.platformId)&&window.innerWidth<768}closeSidebar(){this.sidebarCollapsed.set(!0),this.cdr.detectChanges()}static \u0275fac=function(e){return new(e||i)(C(G),C(ht),C(Me),C(ne),C(st),C(Rt))};static \u0275cmp=K({type:i,selectors:[["app-root"]],decls:3,vars:2,consts:[["appContent",""],["appLayout",""],["publicLayout",""],["profileLoaded",""],["class","d-flex justify-content-center align-items-center vh-100",4,"ngIf","ngIfElse"],[1,"d-flex","justify-content-center","align-items-center","vh-100"],[1,"spinner-border","text-primary"],[4,"ngIf","ngIfElse"],["align","center",1,"m-5"],["class","sidebar-container",4,"ngIf","ngIfElse"],[1,"sidebar-container"],["id","sidebar",1,"d-flex","flex-column","h-100"],[1,"p-3","flex-grow-1"],[1,"mb-3","d-flex","align-items-center"],[1,"text-decoration-none","me-auto","btn","btn-link","p-0","me-3",3,"click"],["src","/tr_logo.svg",1,"img-fluid"],["type","button",1,"btn-close","d-md-none",3,"click"],[1,"nav","flex-column"],[1,"nav-link",3,"click","title"],[1,"bi","bi-columns-gap"],[4,"ngIf"],[1,"bi","bi-brightness-high"],[1,"bi","bi-journal-text"],[1,"bi","bi-bookmark-check"],[1,"bi","bi-journals"],[1,"p-3","border-top","mt-auto"],["routerLink","/useraccount",1,"d-flex","align-items-center","mb-2",2,"cursor","pointer",3,"click"],[1,"btn","btn-outline-secondary","btn-tr","w-100",3,"click","title"],[1,"bi","bi-box-arrow-right"],["class","sidebar-overlay",3,"click",4,"ngIf"],[1,"content"],[1,"navbar","navbar-expand-lg"],[1,"container-fluid"],[1,"d-flex","align-items-center"],[1,"btn","me-2",3,"click"],[1,"navbar-toggler-icon"],[1,"container-fluid","ps-3"],[1,"skeleton-avatar","me-2"],["class","skeleton-text",4,"ngIf"],[1,"skeleton-text"],["alt","Profile",1,"rounded-circle",2,"width","40px","height","40px","object-fit","cover",3,"src"],[1,"bi","bi-person-circle","text-black",2,"font-size","30px"],[1,"text-black","mb-0"],[1,"sidebar-overlay",3,"click"]],template:function(e,n){if(e&1&&b(0,Ru,2,0,"div",4)(1,em,5,2,"ng-template",null,0,Qe),e&2){let r=$e(2);f("ngIf",n.supabaseService.sessionLoading())("ngIfElse",r)}},dependencies:[X,te,bo,_e],styles:[".sidebar-container[_ngcontent-%COMP%]{display:flex;position:relative}#sidebar[_ngcontent-%COMP%]{width:250px;position:fixed;top:0;left:0;height:100dvh;z-index:999;background:#f8f9facc;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);transition:all .3s ease-in-out;box-shadow:0 0 15px #0000001a;border-right:1px solid rgba(0,0,0,.05)}#sidebar.collapsed[_ngcontent-%COMP%]{width:88px}.content[_ngcontent-%COMP%]{width:calc(100% - 250px);margin-left:250px;transition:all .3s ease-in-out;min-height:100dvh;background-color:transparent}.content.expanded[_ngcontent-%COMP%]{width:calc(100% - 88px);margin-left:88px}@media (max-width: 768px){#sidebar[_ngcontent-%COMP%]{margin-left:-250px}#sidebar[_ngcontent-%COMP%]:not(.collapsed){margin-left:0}#sidebar.collapsed[_ngcontent-%COMP%]{margin-left:-250px}.content[_ngcontent-%COMP%], .content.expanded[_ngcontent-%COMP%]{width:100%;margin-left:0}}.nav-link[_ngcontent-%COMP%]{display:flex;align-items:center;padding:12px 20px;color:#343a40;cursor:pointer;text-decoration:none;border-radius:12px;margin:4px 12px;font-weight:500;transition:background-color .2s ease,color .2s ease}.nav-link[_ngcontent-%COMP%]:hover{background-color:#e9ecef;color:#000}.nav-link.active[_ngcontent-%COMP%]{background:linear-gradient(90deg,#634aff,#9932ff);color:#fff!important;font-weight:600;box-shadow:0 4px 12px #634aff4d}.nav-link.active[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#fff!important}#sidebar.collapsed[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{justify-content:center;padding:0;margin:8px auto;width:52px;height:52px;border-radius:14px}#sidebar.collapsed[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:none}#sidebar.collapsed[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin:0!important;font-size:1.4em}#sidebar.collapsed[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%]{background:linear-gradient(90deg,#634aff,#9932ff);color:#fff;box-shadow:0 2px 8px #0003}#sidebar.collapsed[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:hover{background-color:#dee2e6}#sidebar.collapsed[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%]:hover{background:#495057}.navbar[_ngcontent-%COMP%]{padding:15px 10px}.sidebar-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:998}.btn-tr[_ngcontent-%COMP%]:hover{background-color:#f8f9fa}.skeleton-avatar[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;background:linear-gradient(90deg,#e0e0e0 25%,#f0f0f0,#e0e0e0 75%);background-size:200% 100%;animation:_ngcontent-%COMP%_shimmer 1.2s infinite}.skeleton-text[_ngcontent-%COMP%]{width:120px;height:16px;border-radius:4px;background:linear-gradient(90deg,#e0e0e0 25%,#f0f0f0,#e0e0e0 75%);background-size:200% 100%;animation:_ngcontent-%COMP%_shimmer 1.2s infinite}@keyframes _ngcontent-%COMP%_shimmer{0%{background-position:-200% 0}to{background-position:200% 0}}"]})};vo(Mi,na).catch(i=>console.error(i));
